// Englishtown_Efekta_12_Study_Plan - 2018.44.1 @ 2020-10-21 11:26:48

define("school-ui-studyplan/enum/client-storage-pair",{gl_tips:{keyName:"school_studyplan_gl_optional_tips",keyValue:["closed"]},pl_tips:{keyName:"school_studyplan_pl_optional_tips",keyValue:["closed"]},cp20_tips:{keyName:"school_studyplan_cp20_optional_tips",keyValue:["closed"]},techcheck_state:{keyName:"school_studyplan_techcheck_state",keyValue:["passed"]},legacy_techcheck_state:{keyName:"_TECHCHECK_PASSED",keyValue:[!0]},shown_popover_ids:{keyName:"school_studyplan_item_shown_popover_ids"},shown_level_first:{keyName:"campus_studyplan_level_first_enter"}}),define("school-ui-studyplan/enum/page-name",{createSelectPace:"School:StudyPlan:Create:SelectPace",createConfirm:"School:StudyPlan:Create:Confirm",lesson1:"School:StudyPlan:Unit:Lesson1",lesson2:"School:StudyPlan:Unit:Lesson2",lesson3:"School:StudyPlan:Unit:Lesson3",lesson4:"School:StudyPlan:Unit:Lesson4",gl:"School:StudyPlan:Unit:GroupClass",pl:"School:StudyPlan:Unit:PrivateClass",goal:"School:StudyPlan:Unit:Goal"}),define("school-ui-studyplan/enum/studyplan-item-state",{Completed:1,Locked:2}),define("school-ui-studyplan/enum/studyplan-item-typecode",{lesson:"lesson",goal:"goal",gl:"gl",pl20:"sppl20",pl40:"pl",cp20:"cp20"}),define("school-ui-studyplan/enum/studyplan-mode",{Create:0,Locked:1,Study:2}),define("school-ui-studyplan/enum/studyplan-state",{NotStarted:0,Started:1,Completed:2}),define("school-ui-studyplan/enum/studyplan-status",{Completed:{progressMsg:656554,subMsg:695052,tooltipMsg:"",customClass:"cp-progress-complete"},Nopace:{progressMsg:656581,subMsg:695048,tooltipMsg:"",customClass:"cp-progress-nopace"},Fast:{progressMsg:694967,subMsg:656562,tooltipMsg:"",customClass:"cp-progress-fast"},Normal:{progressMsg:694967,subMsg:656561,tooltipMsg:"",customClass:"cp-progress-normal"},Slow:{progressMsg:694967,subMsg:656563,tooltipMsg:"",customClass:"cp-progress-slow"},Crashing:{progressMsg:694967,subMsg:656582,tooltipMsg:"",customClass:"cp-progress-crashing"},Crashed:{progressMsg:695050,subMsg:695051,tooltipMsg:"",customClass:"cp-progress-crashed"}}),define("school-ui-studyplan/enum/studyplan-velocity",{Slow:1,Normal:2,Fast:3,Crashing:4,Crashed:5}),define("school-ui-studyplan/module",["module"],function(a){return a}),define("school-ui-studyplan/service/load-preview",["troopjs-ef/component/service","troopjs-browser/route/uri","troopjs-utils/merge","when/keys","when","poly","school-ui-shared/utils/typeid-parser"],function(a,b,c,d,e,f,g){function h(){var a=this;return s.call(arguments).forEach(function(b){Object.keys(b).forEach(function(c){a[c]=b[c]})}),a}function i(a){return a.slice(0,a.reduce(function(a,b,c){return b!==o?c+1:a},0))}function j(a){return a[0]}function k(a){return a&&a.id?a.id.replace(q,""):a}function l(a){var b,d=a.path,e=a.query;switch(d?d[0]:o){case"preview":b={prefix:d[0],studyplan:d[1],studyplan_item:d[2],lesson:e.lesson_id};break;case"config":b={prefix:d[0],unit:e.unit_id};break;case"study":b={prefix:d[0],studyplan:d[1],studyplan_item:d[2]};break;case"school":b={prefix:d[0],enrollment:d[1],course:d[2],level:d[3],unit:d[4],lesson:d[5],step:d[6],activity:d[7]};break;default:b={}}return c.call(b,{command:e&&e.command?e.command.split("|"):o}),b}function m(a){var d=b();switch(delete d.path,a.prefix){case"preview":d.path=b.Path(i([a.prefix,k(a.studyplan),k(a.studyplan_item)])),d.query=b.Query({lesson_id:k(a.lesson)});break;case"config":d.path=b.Path(i([a.prefix])),d.query=b.Query({unit_id:k(a.unit)});break;case"study":d.path=b.Path(i([a.prefix,k(a.studyplan),k(a.studyplan_item)]));break;case"school":d.path=b.Path(i([a.prefix,k(a.enrollment),k(a.course),k(a.level),k(a.unit),k(a.lesson),k(a.step),k(a.activity)]))}return a.command&&c.call(d.query?d.query:d.query={},b.Query({command:a.command.join("|")})),d}function n(a,b,c){function f(a,c){return b[a]&&k(b[a])==c&&[b[a]]}var i,l=this,m=[];if(a)return b=b||{},c=c||{},Object.keys(a).forEach(function(b){var c=a[b];switch(t.call(c)){case"[object Object]":if(!c)break;if(!1===c.load){a[b]=c.value;break}c=c.value;case"[object String]":case"[object Number]":switch(b){case"prefix":a[b]=c;break;case"studyplan":a[b]=e(f(b,c)||l.query("campus_student_"+b+"!"+c+".items")).spread(function(a){return a&&m.push({unit:r+a.properties.templateUnitId,unit_studyplan:a.properties.templateUnitId}),a});break;case"studyplan_item":a[b]=e(f(b,c)||l.query("campus_student_"+b+"!"+c)).then(j);break;case"unit_studyplan":a[b]=e(f(b,c)||l.query("campus_student_"+b+"!"+c+".studyPlan.items,.studyPlan.progress")).then(j);break;case"unit":a[b]=e(f(b,c)||l.query("student_"+b+"!"+c+".parent.parent")).spread(function(a){return a&&m.push({enrollment:g.parseId(a.parent.parent.studentCourseId),course:g.parseId(a.parent.parent.id),level:g.parseId(a.parent.id),unit_studyplan:a.templateUnitId}),a});break;case"level":a[b]=e(f(b,c)||l.query("student_"+b+"!"+c+".levelName,.children")).then(j);break;case"lesson":a[b]=e(f(b,c)||l.query("student_"+b+"!"+c+".lessonImage")).then(j);break;case"activity":a[b]=e(f(b,c)||l.query("student_"+b+"!"+c+".activityContent")).then(j);break;case"enrollment":a[b]=e(f(b,c)||l.query("student_course_"+b+"!"+c)).then(j);break;default:a[b]=e(f(b,c)||l.query("student_"+b+"!"+c)).then(j)}break;default:a[b]=c}}),l.publish("school/spinner",i=d.all(a)),i.then(function(a){if(Object.keys(a).forEach(function(b){c[b]=a[b]}),m.length)return n.call(l,h.apply({},m),b,c)}).yield(c)}var o,p="_route",q=/^[^!]+!/,r="template_unit;",s=Array.prototype.slice,t=Object.prototype.toString;return a.extend({displayName:"school-ui-studyplan/service/load","hub:memory/route":function(a){var b=this;b[p]&&a&&b[p].toString()===a.toString()||b.publish("load",l(a))},"hub/load":function(a){var b,c,d=this;if(a)return d._cache=d._cache||{},d[p]=d[p]||m({}),b=h.call({},d._cache),a.prefix?(c=a,b={}):(c=h.call(l(d[p]),a),Object.keys(c).forEach(function(c){c in a&&delete b[c]})),d.publish("load/requests",c).spread(function(a){return d.publish("load/launcher",h.call({},a)).then(function(){return n.call(d,a,b).then(function(a){var b={},c=d._cache,e=Object.keys(a).reduce(function(d,e){return(e in a&&!(e in c)||c[e]!==a[e])&&(b[e]=a[e],d=!0),c[e]=a[e],d},!1);return d[p]=m(c),e?d.publish("load/results",a).then(function(){return d.publish("load/updates",b).then(function(){return d.publish("route/set",d[p]).then(function(){Object.keys(b).map(function(a){d.publish("load/"+a,b[a])})})})}).yield(b):d.publish("load/results",a).yield(b)})})})}})}),define("school-ui-studyplan/service/load",["troopjs-ef/component/service","troopjs-browser/route/uri","troopjs-utils/merge","when/keys","when","poly","school-ui-studyplan/enum/studyplan-mode","school-ui-shared/utils/typeid-parser"],function(a,b,c,d,e,f,g,h){function i(){var a=this;return t.call(arguments).forEach(function(b){Object.keys(b).forEach(function(c){a[c]=b[c]})}),a}function j(a){return a.slice(0,a.reduce(function(a,b,c){return b!==p?c+1:a},0))}function k(a){return a[0]}function l(a){return a&&a.id?a.id.replace(r,""):a}function m(a){var b,d=a.path,e=a.query;switch(d?d[0]:p){case"config":b={prefix:d[0],unit:e.unit_id};break;case"study":b={prefix:d[0],studyplan:d[1],studyplan_item:d[2]};break;case"school":b={prefix:d[0],enrollment:d[1],course:d[2],level:d[3],unit:d[4],lesson:d[5],step:d[6],activity:d[7]};break;default:b={}}return c.call(b,{command:e&&e.command?e.command.split("|"):p}),b}function n(a){var d=b();switch(delete d.path,a.prefix){case"config":d.path=b.Path(j([a.prefix])),d.query=b.Query({unit_id:s+l(a.unit.templateUnitId)});break;case"study":d.path=b.Path(j([a.prefix,l(a.studyplan),l(a.studyplan_item)]));break;case"school":d.path=b.Path(j([a.prefix,l(a.enrollment),l(a.course),l(a.level),l(a.unit),l(a.lesson),l(a.step),l(a.activity)]))}return a.command&&c.call(d.query?d.query:d.query={},b.Query({command:a.command.join("|")})),d}function o(a,b,c){function f(a,c){return b[a]&&l(b[a])==c&&[b[a]]}var j,m=this,n=[];if(a)return b=b||{},c=c||{},Object.keys(a).forEach(function(b){var c=a[b];switch(u.call(c)){case"[object Object]":if(!c)break;if(!1===c.load){a[b]=c.value;break}c=c.value;case"[object String]":case"[object Number]":switch(b){case"prefix":a[b]=c;break;case"studyplan":a[b]=e(f(b,c)||m.query("campus_student_"+b+"!"+c+".items")).spread(function(a){return a&&n.push({unit:s+a.properties.templateUnitId,unit_studyplan:a.properties.templateUnitId}),a});break;case"studyplan_item":a[b]=e(f(b,c)||m.query("campus_student_"+b+"!"+c)).spread(function(a){if(a)switch(a.typeCode){case p:return p;case"lesson":return m.query("pc_student_lesson_map!"+a.properties.templateLessonId).spread(function(b){return n.push({lesson:h.parseId(b.lesson.id)}),a});default:return a}});break;case"unit_studyplan":var d="campus_student_"+b+"!"+c+".studyPlan";a[b]=e(f(b,c)||m.query(d+".items")).spread(function(a){return a.mode===g.Study?m.query(d+".progress").then(k):a});break;case"unit":a[b]=e(f(b,c)||m.query("student_"+b+"!"+c+".parent.parent")).spread(function(a){return a&&n.push({enrollment:h.parseId(a.parent.parent.studentCourseId),course:h.parseId(a.parent.parent.id),level:h.parseId(a.parent.id),unit_studyplan:a.templateUnitId}),a});break;case"level":a[b]=e(f(b,c)||m.query("student_"+b+"!"+c+".levelName,.children")).then(k);break;case"lesson":a[b]=e(f(b,c)||m.query("student_"+b+"!"+c+".lessonImage")).then(k);break;case"activity":a[b]=e(f(b,c)||m.query("student_"+b+"!"+c+".activityContent")).then(k);break;case"enrollment":a[b]=e(f(b,c)||m.query("student_course_"+b+"!"+c)).then(k);break;default:a[b]=e(f(b,c)||m.query("student_"+b+"!"+c)).then(k)}break;default:a[b]=c}}),m.publish("school/spinner",j=d.all(a)),j.then(function(a){if(Object.keys(a).forEach(function(d){c[d]=a[d],b[d]=c[d]}),n.length)return o.call(m,i.apply({},n),b,c)}).yield(c)}var p,q="_route",r=/^[^!]+!/,s="template_unit;",t=Array.prototype.slice,u=Object.prototype.toString;return a.extend({displayName:"school-ui-studyplan/service/load","hub:memory/route":function(a){var b=this;b[q]&&a&&b[q].toString()===a.toString()||b.publish("load",m(a))},"hub/load":function(a){var b,c,d=this;if(a)return d._cache=d._cache||{},d[q]=d[q]||n({}),b=i.call({},d._cache),a.prefix?(c=a,b={}):(c=i.call(m(d[q]),a),Object.keys(c).forEach(function(c){c in a&&delete b[c]})),d.publish("load/requests",c).spread(function(a){return d.publish("load/launcher",i.call({},a)).then(function(){return o.call(d,a,b).then(function(a){var b={},c=d._cache,e=Object.keys(a).reduce(function(d,e){return(e in a&&!(e in c)||c[e]!==a[e])&&(b[e]=a[e],d=!0),c[e]=a[e],d},!1);return d[q]=n(c),e?d.publish("load/results",a).then(function(){return d.publish("load/updates",b).then(function(){return d.publish("route/set",d[q]).then(function(){Object.keys(b).map(function(a){d.publish("load/"+a,b[a])})})})}).yield(b):d.publish("load/results",a).yield(b)})})})}})}),define("school-ui-studyplan/service/republish",["jquery","troopjs-ef/component/service","school-ui-shared/utils/typeid-parser","poly"],function(a,b,c,d){"use strict";return b.extend({"hub/load/requests":function(a){var b={};if(a)return Object.keys(a).forEach(function(c){var d=a[c];b[c]="activity"===c&&"summary"===d?{value:d,load:!1}:d}),[b]},"hub/load/results":function(a){a.activity&&a.activity.templateActivityId&&this.publish("start/load/activity",{id:a.activity.templateActivityId})},"hub:memory/load/activity":function(a){"summary"==a&&this.publish("load/step/summary")}})}),define("troopjs-requirejs/template!school-ui-studyplan/shared/cp-pace-config/pace-config.html",[],function(){return function(a){var b="",c=0===a.activePace.paceDays?"cp-goal-own-pace":"",d=0===a.activePace.paceDays?"no-pace":"pace-value",e=a.targetDate||"",f=a.blurbIds;return b+="\n\n","Completed"===a.status.key?(b+='\n\t<div class="cp-pace-complete">\n\t\t',"level_complete"===a.status.code&&(b+='\n\t\t\t<div class="complete-left">\n\t\t\t\t<div class="cp-certificate">\n\t\t\t\t\t<div class="cp-certificate-content">\n\t\t\t\t\t\t<span class="cp-certificate-text" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695071">You\'ve already passed this level test</span>\n\t\t\t\t\t\t<i class="ets-icon-badge-checkmark"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="cp-certificate-action">\n\t\t\t\t\t\t<a data-url="'+a.certUrl+'" class="cp-certificate-action-text" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695072">view certificate</a>\n\t\t\t\t\t\t<i class="ets-icon-cp-arrow-right"></i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="cp-retake">\n\t\t\t\t\t<a href="/school/content/leveltest.aspx?testid='+a.levelTestId+'" class="btn cp-complete-next" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695073">\n\t\t\t\t\t</a>\n\t\t\t\t\t<span class="ets-icon-cp-arrow-right"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'),b+='\n\t\t<div class="complete-right">\n\t\t\t<div>\n\t\t\t\t<img src="/_imgs/school/changecourse/pepper/ge/13.jpg"/>\n\t\t\t</div>\n\t\t\t',"unit_complete"===a.status.code?b+='\n\t\t\t\t<a class="btn cp-complete-next cp-next-unit" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+f.cpNextUnit+'">\n\t\t\t\t</a>\n\t\t\t':"course_change"===a.status.code?b+='\n\t\t\t\t<a class="btn cp-complete-next cp-course-change" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+f.cpCourseChange+'">\n\t\t\t\t</a>\n\t\t\t':"level_complete"===a.status.code?(b+="\n\t\t\t\t",a.isLastLevel?b+='\n\t\t\t\t<a class="btn cp-complete-next cp-course-change" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+f.cpCourseChange+'">\n\t\t\t\t</a>\n\t\t\t\t':b+='\n\t\t\t\t<a class="btn cp-complete-next cp-next-level" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695074">\n\t\t\t\t</a>\n\t\t\t\t',b+="\n\t\t\t"):b+='\n\t\t\t\t<a href="/school/content/leveltest.aspx?testid='+a.levelTestId+'" class="btn cp-complete-next" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695076">\n\t\t\t\t</a>\n\t\t\t',b+="\n\t\t</div>\n\t</div>\n"):b+='\n\t<div class="cp-pace-title">\n\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="694968">\n\t\t\tSTUDY PACE\n\t\t</p>\x3c!--\n\t\t--\x3e<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="694969">GOAL DATE</p>\n\t</div>\n\t<div class="cp-pace-content">\n\t\t<div class="cp-pace-readonly '+c+'">\n\t\t\t<div class="ets-sp-cfg-item cp-pace-item cp-pace-left">\n\t\t\t\t<div class = "cp-pace-left-body">\n\t\t\t\t\t<span class="pace-item-icon"></span>\n\t\t\t\t\t<span class="'+d+'">'+a.activePace.text+'</span>\n\t\t\t\t\t<span class="pace-name" data-weave="troopjs-ef/blurb/widget" data-blurb-id="694970">Hours Weekly</span>\n\t\t\t\t</div>\n\t\t\t</div>\x3c!--\n\t\t\t--\x3e<div class="ets-sp-cfg-item cp-pace-item cp-pace-right">\n\t\t\t\t<p class="goal-date">'+e+'</p>\n\t\t\t\t<p class="goal-timezone"></p>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n',b}}),define("school-ui-studyplan/utils/widget-creator",["jquery","lodash"],function(a,b){"use strict";function c(a,c,d){var e;return b.isEmpty(c)?d:(e="data"+b.size(a.data()),a.data(e,c),d+"("+e+")")}return function(d){var e=a("<div>"),f=b.mapKeys(d,b.partial(c,e));return e.attr("data-weave",b.keys(f).join(" "))}}),define("school-ui-studyplan/shared/cp-pace-config/main",["school-ui-studyplan/module","jquery","when","moment","poly","lodash","troopjs-ef/component/widget","school-ui-shared/enum/moment-language","template!./pace-config.html","school-ui-studyplan/utils/widget-creator","school-ui-shared/utils/typeid-parser","school-ui-shared/enum/course-type"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a){return{date:d(a.certificateDate).lang("en").format("MMM DD, YYYY"),course:a.courseName||"",level:a.levelName,Key:a.key,levelCertificate:a.certificateName,coursetype:2,name:a.studentName}}function n(a,b){var c=[],d=[];[a,b].forEach(function(a){a.forEach(function(a){var b=m(a);l.isGECourse(a.courseTypeCode)?c.push(b):d.push(b)})}),window.generalCertificates=c,window.spinCertificates=d}function o(a,d){var e,g,h=this,k=d||h[w];k.paceDays?e=parseInt(k.paceDays,10):(g=k.paces.every(function(a,b){return!a.selected||(e=a.paceDays,!1)}))&&(k.paces[0].selected=!0,e=k.paces[0].paceDays);var l=f.find(k.paces,function(a){return a.selected}),m=k.endDate?r(a,k.endDate).format("ll"):p.call(h,a,e);return c.all([m,h.dfdResults.promise,h.levelTestVersionPromise,h.certPromise,q.call(h,a,k.paces)]).spread(function(a,c,d,f,m){var o=f[0],p=f[1],q=b.extend(!0,[],o.items),r=b.extend(!0,[],p.items),w=1===d?c.level.legacyLevelId:c.level.templateLevelId;return n.call(h,q,r),h.html(i,{isLastLevel:s(c),status:h[y],paces:m,levelTestId:w,certUrl:u.certUrl+c.course.courseTypeCode+"_"+c.level.levelCode,blurbIds:u.blurbIds,activePace:l,targetDate:e?a:t,paceDays:e,leftDays:k.leftDays,paceSelectMode:h[x]}).then(function(){var a=j({"school-ui-studyplan/shared/cp-pace-select/main":k.paces}).attr("data-mode","edit").attr("data-paces",JSON.stringify(m).replace(/\'/g,"&#39;"));a.weave().then(function(){h[v].find(z).append(a)}),g&&h.publish("config/pace-config/mode",A)})})}function p(a,b){return this.publish("studyplan/get/serverTime").then(function(c){return r(a,c).add("days",b).format("ll")})}function q(a,b){return this.publish("studyplan/get/serverTime").then(function(c){return f.forEach(b,function(b,d){b.targetDate=r(a,c).add("days",b.paceDays).format("ll")}),b})}function r(a,b){var c=d(b);return c.lang(h[a.toLowerCase()]),c}function s(a){var b=l.isGECourse((a.course||{}).courseTypeCode),c=a.level,d=a.course.children,e=a.course.children.length,f=!1;return b?c.templateLevelId===d[e-1].templateLevelId&&(f=!0):f=!0,f}var t,u=f.merge({changeCourseUrl:"/school/changecourse",certUrl:"/school/course/CertificateBoard.aspx?key=",blurbIds:{cpNextUnit:"695095",cpCourseChange:"656560"}},a.config()||{}),v="$element",w="_config",x="_mode",y="_status",z=".cp-pace-content",A="edit";return g.extend(function(){var a=this,d=a[v].data("config");a[y]=a[v].data("status"),a[w]=d,a._config_original=b.extend(!0,{},d),a._paces=a[w].paces,a[x]=a[v].data("mode"),a.dfdResults=c.defer(),a.levelTestVersionPromise=a.query("member_site_setting!'school;student.leveltest.version'").spread(function(a){return parseInt(a&&a.value||1)}),a.certPromise=a.query(["student_certificate!*","student_archive_certificate!*"])},{"hub:memory/common_context":function(a){var b=this;a&&o.call(b,b._culture_code=a.values.culturecode.value)},"hub:memory/load/results":function(a){this.dfdResults.resolve(a)},"hub/config/pace-select":function(a){var b=this;b._paces.forEach(function(b,c){b.selected&&delete b.selected,b.paceDays==a&&(b.selected=!0)}),b.publish("config/pace-change",b._paces)},"hub/config/pace-config/mode":function(a){var b=this,c=b[v].find(".ets-cfg-paceSelect");switch(b[x]=a,b[v].attr("data-mode",a),a){case A:b.publish("config/pace-select/toggle","open"),setTimeout(function(){b[v].find(".cp-pace-content").addClass("cp-pace-edit")},200),b.publish("config/pace-change",b._paces);break;case"view":b.publish("config/pace-select/toggle","close"),b[v].find(".cp-pace-content").addClass("cp-pace-edit"),c.addClass("ets-cfg-paceSelect-view"),o.call(b,b._culture_code,b._config_original)}},"dom: .cp-next-unit/click":function(){this.publish("ef/next/unit")},"dom: .cp-next-level/click":function(){this.publish("enroll/next/level")},"dom: .cp-course-change/click":function(){window.location.href=u.changeCourseUrl},"dom: .cp-certificate-action/click":function(){var a=this,b=a.$element.find(".cp-certificate-action-text").data("url");window.open(b)}})}),define("troopjs-requirejs/template!school-ui-studyplan/shared/cp-pace-select/pace-select.html",[],function(){return function(a){for(var b="",c=0;c<a.paces.length;c++){b+="\n\t";var d=a.paces[c].selected?"pace-item-selected":"",e=0===a.paces[c].paceDays?"cp-goal-own-pace":"",f=0===a.paces[c].paceDays?"no-pace":"pace-value";b+='\n\t<div class="pace-item-edit '+d+" "+e+'" data-pacedays = "'+a.paces[c].paceDays+'">\n\t\t<div class="ets-sp-cfg-item cp-pace-item cp-pace-left">\n\t\t\t<div class="cp-pace-left-body">\n\t\t\t\t<span class="pace-item-icon"></span> \n\t\t\t\t<span class="'+f+'">'+a.paces[c].text+'</span>\n\t\t\t\t<span class="pace-name" data-weave="troopjs-ef/blurb/widget" data-blurb-id="694970"\n\t\t\t\t>Hours Weekly</span>\n\t\t\t</div>\n\t\t</div>\x3c!--\n\t\t--\x3e<div class="ets-sp-cfg-item cp-pace-item cp-pace-right">\n\t\t\t<p class="goal-date">'+a.paces[c].targetDate+'</p>\n\t\t\t<p class="goal-timezone"></p>\n\t\t</div>\n\t</div>\n'}return b}}),define("school-ui-studyplan/shared/cp-pace-select/main",["jquery","lodash","troopjs-ef/component/widget","template!./pace-select.html"],function(a,b,c,d){"use strict";function e(){var a=this,b=a[g].find(h).outerHeight();a[g].find(i).height(b),a[g].attr("data-status","open")}function f(){var a=this;a[g].find(i).height(0),a[g].attr("data-status","close")}var g="$element",h=".ets-sp-cfg-paceList",i=".ets-sp-cfg-paceList-wrapper";return c.extend(function(){var a=this;a._paces=a[g].data("paces")},{"sig/start":function(){var b=this;return a(".ets-studyplan").off("mousedown.pace").on("mousedown.pace",function(c){0==a(c.target).parents(".ets-sp-cfg-pace").length&&f.call(b)}),b.html(d,{paces:b._paces})},"sig/stop":function(){a(".ets-studyplan").off("mousedown.pace")},"hub/config/pace-select/toggle":function(a){var b=this;"open"===a?e.call(b):"close"===a&&f.call(b)},"dom:.ets-sp-cfg-pace-button/click":function(a){var b=this;b[g].hasClass("ets-cfg-paceSelect-view")||e.call(b)},"dom:ul li .ets-sp-cfg-pace-item/click":function(b){var c=this,d=a(b.currentTarget),e=parseInt(d.attr("data-days"));c.publish("config/pace-select",e),c[g].find(".ets-sp-cfg-pace-button").find("div").html(d.html()),f.call(c)},"dom:.pace-item-edit/click":function(b){var c=this,d=a(b.currentTarget);d.addClass("pace-item-selected").siblings().removeClass("pace-item-selected"),c.publish("config/pace-select",d.data("pacedays"))}})}),define("troopjs-requirejs/template!school-ui-studyplan/shared/pace-config/pace-config.html",[],function(){return function(a){var b="",c=a.paces,d=a.targetDate,e=a.paceDays,f=a.leftDays;return b+='\n<div class="ets-sp-cfg-item">\n\t<div class="ets-sp-cfg-item-title">\n\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="656056" data-text-en="My pace"></span>\n\t</div>\n\t<div class="ets-sp-cfg-item-detail">\n\t\t<div class="ets-cfg-paceSelect '+("view"===a.paceSelectMode?"ets-cfg-paceSelect-view":"")+'" data-weave="school-ui-studyplan/shared/pace-select/main" data-paces=\''+JSON.stringify(c).replace(/\'/g,"&#39;")+'\'></div>\n\t</div>\n</div>\n<div class="ets-sp-cfg-item">\n\t<div class="ets-sp-cfg-item-title">\n\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="569851" data-text-en="Target date"></span>\n\t</div>\n\t<div class="ets-sp-cfg-item-detail ets-sp-cfg-item-targetDate">\n\t\t<h2>'+(d||"&mdash;&mdash;")+'</h2>\n\t</div>\n</div>\n<div class="ets-sp-cfg-item">\n\t<div class="ets-sp-cfg-item-title">\n\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="656057" data-text-en="Remaining days"></span>\n\t</div>\n\t<div class="ets-sp-cfg-item-detail ets-sp-cfg-item-days">\n\t\t<h2>'+(void 0===f?e||"&mdash;&mdash;":f)+'</h2>\n\t\t<span class="'+(e?"":"ets-none")+'" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656058" data-text-en="Days">Days</span>\n\t</div>\n</div>'}}),define("school-ui-studyplan/shared/pace-config/main",["jquery","when","moment","poly","troopjs-ef/component/widget","school-ui-shared/enum/moment-language","template!./pace-config.html"],function(a,b,c,d,e,f,g){"use strict";function h(a,c){var d,e,f=this,h=c||f[l];return h.paceDays?d=parseInt(h.paceDays,10):(e=h.paces.every(function(a,b){return!a.selected||(d=a.paceDays,!1)}))&&(h.paces[0].selected=!0,d=h.paces[0].paceDays),b(h.endDate?j(a,h.endDate).format("ll"):i.call(f,a,d)).then(function(a){return f.html(g,{paces:h.paces,targetDate:d?a:k,paceDays:d,leftDays:h.leftDays,paceSelectMode:f[m]}).then(function(){e&&f.publish("config/pace-config/mode",n)})})}function i(a,b){return this.publish("studyplan/get/serverTime").then(function(c){return j(a,c).add("days",b).format("ll")})}function j(a,b){var d=c(b);return d.lang(f[a.toLowerCase()]),d}var k,l="_config",m="_mode",n="edit";return e.extend(function(){var b=this,c=b.$element.data("config");b[l]=c,b._config_original=a.extend(!0,{},c),b._paces=b[l].paces,b[m]=b.$element.data("mode")},{"hub:memory/common_context":function(a){var b=this;a&&h.call(b,b._culture_code=a.values.culturecode.value)},"hub/config/pace-select":function(a){var b=this,c=b.$element.find(".ets-sp-cfg-item-targetDate").find("h2"),d=b.$element.find(".ets-sp-cfg-item-days").find("h2");i.call(b,b._culture_code,a).then(function(e){a?(c.html(e),d.html(a),d.siblings("span").removeClass("ets-none")):(c.html("&mdash;&mdash;"),d.html("&mdash;&mdash;"),d.siblings("span").addClass("ets-none")),b._paces.forEach(function(b,c){b.selected&&delete b.selected,b.paceDays==a&&(b.selected=!0)}),b.publish("config/pace-change",b._paces)})},"hub/config/pace-config/mode":function(a){var b=this,c=b.$element.find(".ets-cfg-paceSelect");switch(b[m]=a,b.$element.attr("data-mode",a),a){case n:b.publish("config/pace-select/toggle","open"),setTimeout(function(){c.removeClass("ets-cfg-paceSelect-view")},200),b.publish("config/pace-change",b._paces);break;case"view":b.publish("config/pace-select/toggle","close"),c.addClass("ets-cfg-paceSelect-view"),h.call(b,b._culture_code,b._config_original)}}})}),define("troopjs-requirejs/template!school-ui-studyplan/shared/pace-select/pace-select.html",[],function(){return function(a){var b="",c=a;b+='\n<div class="ets-sp-cfg-pace">\n\n\t';for(var d=0;d<c.length;d++)!function(a){b+="\n\t",a.selected&&(b+='\n\t\t<div class="ets-sp-cfg-pace-item ets-sp-cfg-pace-button">\n\t\t\t<div>\n\t\t\t',a.paceDays?b+="\n\t\t\t\t<h2>"+a.text+'</h2><span data-weave="troopjs-ef/blurb/widget" data-blurb-id="569848" data-text-en="hours weekly"></span>\n\t\t\t':b+="\n\t\t\t\t"+a.text+"\n\t\t\t",b+='\n\t\t\t</div> <i class="glyphicon icon-caret-down"></i>\n\t\t</div>\n\t'),b+="\n"}(c[d]);b+='\n\t<div class="ets-sp-cfg-paceList-wrapper">\n\t\t<ul class="ets-sp-cfg-paceList">\n\t\t\t';for(var d=0;d<c.length;d++)!function(a){b+='\n\t<li>\n\t\t<div class="ets-sp-cfg-pace-item" data-days="'+a.paceDays+'" data-points="'+a.pacePoints+'" data-text="'+a.text+'">\n\t\t\t',a.paceDays?b+="\n\t\t\t\t<h2>"+a.text+'</h2><span data-weave="troopjs-ef/blurb/widget" data-blurb-id="569848" data-text-en="hours weekly"></span>\n\t\t\t':b+="\n\t\t\t\t"+a.text+"\n\t\t\t",b+="\n\t\t</div>\n\t</li>\n"}(c[d]);return b+="\n\t\t</ul>\n\t</div>\n</div>\n\n",b+="\n\n"}}),define("school-ui-studyplan/shared/pace-select/main",["jquery","troopjs-ef/component/widget","template!./pace-select.html"],function(a,b,c){"use strict";function d(){var a=this,b=a[f].find(g).outerHeight();a[f].find(h).height(b),a[f].attr("data-status","open")}function e(){var a=this;a[f].find(h).height(0),a[f].attr("data-status","close")}var f="$element",g=".ets-sp-cfg-paceList",h=".ets-sp-cfg-paceList-wrapper";return b.extend(function(){var a=this;a._paces=a[f].data("paces")},{"sig/start":function(){var b=this;return a(".ets-studyplan").off("mousedown.pace").on("mousedown.pace",function(c){0==a(c.target).parents(".ets-sp-cfg-pace").length&&e.call(b)}),b.html(c,b._paces)},"sig/stop":function(){a(".ets-studyplan").off("mousedown.pace")},"hub/config/pace-select/toggle":function(a){var b=this;"open"===a?d.call(b):"close"===a&&e.call(b)},"dom:.ets-sp-cfg-pace-button/click":function(a){var b=this;b[f].hasClass("ets-cfg-paceSelect-view")||d.call(b)},"dom:ul li .ets-sp-cfg-pace-item/click":function(b){var c=this,d=a(b.currentTarget),g=parseInt(d.attr("data-days"));c.publish("config/pace-select",g),c[f].find(".ets-sp-cfg-pace-button").find("div").html(d.html()),e.call(c)}})}),define("troopjs-requirejs/template!school-ui-studyplan/shared/tooltip/main.html",[],function(){return function(a){return'<div class="campus-tooltip '+a.customClass+'">\n\t<div class="tooltip-title">\n\t\t<span class="title-text"></span>\n\t\t<div class="title-icon">\n\t\t\t<span class="ets-icon-mob-tip"></span>\n\t\t\t<span class="ets-icon-cp-arrow-up '+a.expand+'"></span>\n\t\t</div>\n\t</div>\n\t<div class="tooltip-body '+a.expand+'">\n\t\t<p class="tooltip-content" data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+a.content+'"></p>\n\t\t<span class="ets-icon-cp-close"></span>\n\t</div>\n</div>'}}),define("school-ui-studyplan/shared/tooltip/main",["jquery","troopjs-ef/component/widget","template!./main.html"],function(a,b,c){"use strict";return b.extend(function(a,b,c){this.options=c},{"sig/start":function(){var a=this;return a.html(c,{content:a.options.content,customClass:a.options.customClass,expand:a.options.expand?"":"ets-none"})},"dom:.campus-tooltip/click":function(a){a.stopPropagation()},"dom: .title-icon/click":function(){var a=this;a.$element.find(".ets-icon-cp-arrow-up").toggleClass("ets-none"),a.$element.find(".tooltip-body").toggleClass("ets-none")},"dom:.ets-icon-cp-close/click":function(){var a=this;a.$element.find(".ets-icon-cp-arrow-up").addClass("ets-none"),a.$element.find(".tooltip-body").addClass("ets-none"),a.$element.trigger("tooltip/close")}})}),define("school-ui-studyplan/utils/animation-helper",["when","poly/array","poly/object","troopjs-ef/component/gadget"],function(a,b,c,d){"use strict";function e(){var b=[];Object.keys(t).forEach(function(a,c){if(t[a][o].length>0){t[a][o].reduce(function(b,c){return q[a]&&q[a][m]&&q[a][n]!=k&&(q[c]&&q[c][n]===l||q[c]===i)?b&&!0:b&&!1},!0)&&(t[a][p].length>0?f(a):b.push(a)&&(q[a][n]=k))}}),b.length>0&&setTimeout(function(){a.map(b,function(a,b){return q[a][m]()}).then(function(){b.forEach(function(a,b){q[a].state=l,f(a)})})},s)}function f(a){var b=[a];t[a][p].forEach(function(a,c){b.push(a)});var c=b.sort().join("^");if(r[c]||(r[c]=[]),r[c].push(a),Object.keys(r[c]).length===b.length){Object.keys(b).reduce(function(a,c){return a&&q[b[c]][n]===j},!0)&&(b.forEach(function(a,b){g(a)}),delete r[c])}}function g(a){setTimeout(function(){q[a][m]&&q[a][m]().then(function(){q[a].state=l,e()})},s)}function h(a,b){q[a]={cb:b,state:j}}var i,j="ready",k="wait",l="finished",m="cb",n="state",o="deps",p="sync",q={},r={},s=0,t={unitNav_seqCon:{deps:[],sync:["unitNav_seqNav"]},unitNav_seqNav:{deps:[],sync:["unitNav_seqCon"]},itemChange_seqCon:{deps:[],sync:[]},goalEnter:{deps:["itemChange_seqCon","unitNav_seqNav","unitNav_seqCon"],sync:[]}};return d.create({request:function(a,b){b&&(h(a,b),t[a]&&(t[a][o]&&0===t[a][o].length?t[a][p]&&0===t[a][p].length?g(a):f(a):e()))}})}),define("school-ui-studyplan/utils/client-storage",["school-ui-studyplan/enum/client-storage-pair","poly"],function(a,b){var c=window.localStorage,d=window.sessionStorage;return{setLocalStorage:function(b,d){a[b]&&(!a[b].keyValue||a[b].keyValue.indexOf(d)>-1)&&c&&c.setItem(a[b].keyName,JSON.stringify(d))},getLocalStorage:function(b){var d=c&&a[b]&&c.getItem(a[b].keyName);return d&&JSON.parse(d)},setSessionStorage:function(b,c){a[b]&&(!a[b].keyValue||a[b].keyValue.indexOf(c)>-1)&&d&&d.setItem(a[b].keyName,JSON.stringify(c))},getSessionStorage:function(b){var c=d&&a[b]&&d.getItem(a[b].keyName);return c&&JSON.parse(c)}}}),define("school-ui-studyplan/utils/server-time",["when","troopjs-ef/component/gadget"],function(a,b){"use strict";var c=b.create(function(){this._defer_context=a.defer()},{"hub/studyplan/get/serverTime":function(){var b=this;return a(b._defer_context.promise).then(function(a){return a.serverTime+(new Date).getTime()-b._client_start_time})},"hub:memory/context":function(a){var b=this;a&&(b._client_start_time=(new Date).getTime(),b._defer_context.resolve(a))}});return c.start(),c}),define("school-ui-studyplan/utils/state-parser",[],function(){return{parseFlag:function(a,b){var c={};if(a)for(stateName in a)a.hasOwnProperty(stateName)&&(c[stateName]=(a[stateName]&b)===a[stateName]);return c},map:function(a,b){if(a)for(stateName in a)if(a.hasOwnProperty(stateName)&&a[stateName]===b)return stateName}}}),
define("school-ui-studyplan/utils/studyplan-update-helper",["school-ui-shared/utils/update-command"],function(a){"use strict";return{createStudyplan:function(b){return a.update("campusstudyplan/campus_student_unit_studyplan/CreateStudyPlan",b)},restartStudyplan:function(b){return a.update("campusstudyplan/campus_student_unit_studyplan/RestartCurrentStudyPlan",b)}}}),define("school-ui-studyplan/utils/time-parser",["troopjs-ef/component/gadget","moment"],function(a,b){"use strict";var c=a.create({toLocalTime:function(a,c){var d;return d=void 0===c?b(a):b.utc(a).zone(0-c),{dayOfWeek:d.day(),year:d.year(),month:d.month()+1,day:d.date(),hour:d.hour(),minute:d.minute(),second:d.second(),timezone:d.format("Z")}}});return c.start(),c}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/announcement/index.html",[],function(){return function(a){return'<div class="sp-evc-announcement-container">\n    '+a+'\n</div>\n\n<style type="text/css">\n    .sp-evc-announcement-container{\n        width: 680px;\n        margin: 0 auto;\n        padding: 15px 0;\n    }\n    .sp-evc-announcement-main{\n        padding: 20px 50px;\n    }\n    .sp-evc-announcement-container p{\n        margin: 10px 0 0 0;\n    }\n    .sp-evc-announcement-container .sp-evc-announcement-toggle\n    {\n        cursor: pointer;\n        margin-left: 5px;\n        color: #4a4a4a;\n        top: -1px;\n    }\n    .sp-evc-announcement-container .sp-evc-announcement-toggle:hover\n    {\n        text-decoration: none;\n        color: #4a4a4a;\n    }\n    .sp-evc-announcement-container .sp-evc-announcement-content\n    {\n        margin-top: 10px;\n    }\n    .sp-evc-announcement-content > p:last-child\n    {\n        margin-bottom: 0;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/announcement/main",["troopjs-browser/component/widget","jquery","template!./index.html"],function(a,b,c){"use strict";return a.extend({render:function(a){var b=this,d=b.$element;a&&b.html(c,a).then(function(){var a=d.find(".sp-evc-announcement-title");a.length<=0||a.append('<small><a data-action="toggle" class="glyphicon icon-chevron-sign-down sp-evc-announcement-toggle" style="display: none;"></a></small>').append('<small><a data-action="toggle" class="glyphicon icon-chevron-sign-up sp-evc-announcement-toggle"></a></small>')})},"dom:[data-action=toggle]/click":function(a){a.preventDefault();var c=this,d=c.$element,e=(b(a.currentTarget),d.find(".sp-evc-announcement-content"));e.length<=0||(e.toggle("slow"),d.find("[data-action=toggle]").toggle())}})}),define("school-ui-studyplan/widget/gl-pl/credit/service",["troopjs-core/component/gadget","jquery","when"],function(a,b,c){"use strict";return a.extend(function(){},{get:function(a){var d=this,e=c.defer();return a||e.reject(),d.publish("query",["evcmember!current"]).spread(function(c){c&&c.features&&c.courseInfo||e.reject();var d=c.courseInfo,f=c.features,g={},h={};b.each(f,function(b,c){if(c.featureType.toUpperCase()===a.toUpperCase())return h.buyUrl=c.buyUrl,h.canAccess=c.canAccess,h.canBuyMore=c.canBuyMore,h.couponLeft=c.couponLeft,h.isUnlimitedAccess=c.isUnlimitedAccess,!1}),g.courseInfo=d,g.credit=h,e.resolve(g)}),e.promise}})}),define("school-ui-studyplan/widget/gl-pl/announcement/cp20",["./main","jquery","../credit/service"],function(a,b,c){"use strict";return a.extend({"sig/start":function(){var a=this;(new c).get("PL").then(function(b){if(b){var c=b.courseInfo,d=c.academicLevel;a.publish("query",["cms!School#EVC#studyPlanAnnouncement#PL_"+d]).spread(function(b){b.content?a.render(b.content):a.publish("studyplan/evc/cp20/announcement/disable")})}})}})}),define("school-ui-studyplan/widget/gl-pl/announcement/gl",["./main","jquery","../credit/service"],function(a,b,c){"use strict";return a.extend({"sig/start":function(){var a=this;(new c).get("GL").then(function(b){if(b){var c=b.courseInfo,d=c.academicLevel;a.publish("query",["cms!School#EVC#studyPlanAnnouncement#GL_"+d]).spread(function(b){b.content?a.render(b.content):a.publish("studyplan/evc/gl/announcement/disable")})}})}})}),define("school-ui-studyplan/widget/gl-pl/announcement/pl",["./main","jquery","../credit/service"],function(a,b,c){"use strict";return a.extend({"sig/start":function(){var a=this;(new c).get("PL").then(function(b){if(b){var c=b.courseInfo,d=c.academicLevel;a.publish("query",["cms!School#EVC#studyPlanAnnouncement#PL_"+d]).spread(function(b){b.content?a.render(b.content):a.publish("studyplan/evc/pl/announcement/disable")})}})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/book-cp20/index.html",[],function(){return function(a){var b="";return b+='\n<div class="evc-studyplan-btn-book">\n\t<h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="639505" data-text-en="Welcome to your private lesson"></h2>\n\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="639506" data-text-en="Review what youâ€™ve learned in this unit in your private lesson. This live session with a teacher takes 20 minutes and is included with your subscription."></p>\n\t<div class="evc-studyplan-btn-warp">\n\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="639507" data-text-en="Your private lesson must be booked 24 hours in advance."></p>\n\t\t<button class="btn btn-default" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639508" data-text-en="Skip your private lesson"></button>\n\t\t<a href="'+a.bookUrl+'" class="btn btn-primary" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639509" data-text-en="Book your private lesson"><i class="glyphicon icon-caret-right"></i></a>\n\t</div>\n</div>\n<p class="text-muted" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639510" data-text-en="You can skip your private lesson, but we strongly recommend you book it."></p>\n<style type="text/css">\n\t.evc-studyplan-activity-container .evc-studyplan-gap-2x {\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t\twidth: 660px;\n\t}\n\t.evc-studyplan-btn-book{\n\t\tpadding: 30px 20px;\n\t\tcolor: #555555;\n\t\tbackground-color: #f0f0f0;\n\t}\n\t.evc-studyplan-btn-book h2 {\n\t\tmargin-bottom: 10px;\n\t}\n\t.evc-studyplan-btn-book .btn{\n\t\tdisplay: inline-block;\n\t\tmargin: 10px 8px;\n\t}\n\t.evc-studyplan-btn-book p {\n\t\tfont-size: 1.3em;\n\t}\n\t.evc-studyplan-btn-warp {\n\t\tmargin-top: 20px;\n\t}\n\tp.text-muted{\n\t\tmargin-top: 8px;\n\t}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/book-cp20/main",["troopjs-ef/component/widget","jquery","template!./index.html"],function(a,b,c){"use strict";return a.extend(function(a,b,c){this.unitId=c},{"hub:memory/studyplan/evc/cp20/enter-token":function(a){var b=this,d={};b.unitId&&b.query("evc_url_resource!current").spread(function(e){d.bookUrl=e.studyPlanUrls.CP20Booking.replace("{unitId}",b.unitId).replace("{source}",window.encodeURIComponent(window.location.href)).replace("{token}",a||""),b.html(c,d)})},"dom:.btn-default/click":function(){this.publish("studyplan/sequence/navigate/goal")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/book-pl/index.html",[],function(){return function(a){var b="",c=a.bookUrl,d=a.credit;return b+='\n<div class="evc-studyplan-btn-book">\n    ',d.couponLeft<=0?b+='\n        <a class="btn btn-default disabled" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568596"></a>\n    ':b+='\n        <p data-weave="troopjs-ef/blurb/widget" data-blurb-id="568597"></p>\n        <a href="'+c+'" class="btn btn-primary" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568596"></a>\n    ',b+='\n</div>\n<style type="text/css">\n    .evc-studyplan-btn-book{\n    }\n    .evc-studyplan-btn-book > a{\n        display: inline-block;\n    }\n    .evc-studyplan-btn-book > p{\n        font-size: 1.3em;\n        font-weight: bold;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/book-pl/main",["troopjs-ef/component/widget","jquery","../credit/service","school-ui-studyplan/enum/studyplan-item-typecode","template!./index.html"],function(a,b,c,d,e){"use strict";return a.extend(function(a,b,c,d){var e=this;e.unitId=c,e.spTypeCode=d},{"sig/start":function(){var a=this;a.unitId&&a.query("evc_url_resource!current").spread(function(b){var f=Boolean(a.spTypeCode===d.pl20),g={};g.bookUrl=(f?b.studyPlanUrls.SPPL20Booking:b.studyPlanUrls.SPPL40Booking).replace("{unitid}",a.unitId).replace("{source}",window.encodeURIComponent(window.location.href)),(new c).get(f?"PL20":"PL").then(function(b){b&&(g.credit=b.credit,a.html(e,g))})})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/popupbox/index.html",[],function(){return function(a){function b(a){c+="\n    ",a&&(c+='\n        <style>\n            .popupbox a.popupbox-close\n            {\n                width: 34px;\n                height: 35px;\n                overflow: hidden;\n                background: url(data:image/png;base64,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) left top no-repeat;\n                *background-image: url(/_imgs/evc/block/high/btn_close.png);\n                position: absolute;\n                right: -15px;\n                top: -10px;\n                cursor: pointer;\n                text-indent: -5000px;\n            }\n        </style>\n        <a class="popupbox-close" title="Close">Close</a>\n    '),c+="\n"}var c='<div class="popupbox-cover" style="\n    z-index: '+(a.zIndex||1)+";\n    background-color: "+(a.bgColor||"#000")+";\n    opacity: "+(a.opacity||.8)+";\n    filter: alpha(opacity="+100*(a.opacity||.8)+");\n    margin-top: "+(a.top||0)+'px;\n">\n    ';return a.keySupport&&(c+='\n        <style>\n            input.popupbox-keysupport\n            {\n                width: 1px;\n                height: 1px;\n                border-width: 0;\n                overflow: hidden;\n                float: right;\n                background-color: transparent;\n                outline: none;\n                position: absolute;\n                top: -1px;\n            }\n        </style>\n        <input class="popupbox-keysupport" type="text" />\n    '),c+='\n</div>\n<div class="popupbox" style="\n    z-index: '+(a.zIndex||1)+";\n    margin-top: "+(a.top||0)+'px;\n">\n    <div class="popupbox-main" style="\n        height: 100%;\n        ',a.fullSize||(c+="\n            text-align: center;\n        "),c+='\n    ">\n        ',a.isInnerClose||b(a.hasCloseButton),c+='\n        <div class="popupbox-content popupbox-out" style="\n            ',a.fullSize||(c+="\n                text-align: left;\n                display: inline-block;\n                *display: inline;\n                *zoom: 1;\n            "),c+='\n        ">\n            ',a.isInnerClose&&b(a.hasCloseButton),c+="\n        </div>\n    </div>\n</div>\n\n",c+="\n<style>\n    style\n    {\n        display: none;\n    }\n    /*\n    * Animation for pop effect\n    */\n    /* No animation */\n    .popupbox-in\n    {\n        visibility: visible;\n    }\n    .popupbox-out\n    {\n        visibility: hidden;\n    }\n    /* With animation */\n    .popupbox-pop {\n        -webkit-transform-origin: 50% 50%;\n        -moz-transform-origin: 50% 50%;\n    }\n    .popupbox-pop.popupbox-in {\n        visibility: visible;\n        opacity: 1;\n        -webkit-transform: scale(1);\n\n        -webkit-animation-name: popin;\n        -moz-animation-name: popin;\n        -webkit-animation-duration: 200ms;\n        -moz-animation-duration: 200ms;\n        -webkit-animation-timing-function: ease-out;\n        -moz-animation-timing-function: ease-out;\n    }\n    .popupbox-pop.popupbox-out {\n        visibility: visible;\n        opacity: 0;\n        -webkit-transform: scale(.8);\n\n        -webkit-animation-name: popout;\n        -moz-animation-name: popout;\n        -webkit-animation-duration: 100ms;\n        -moz-animation-duration: 100ms;\n        -webkit-animation-timing-function: ease-in;\n        -moz-animation-timing-function: ease-in;\n    }\n    @-webkit-keyframes popin {\n        from {\n            -webkit-transform: scale(.8);\n            opacity: 0;\n        }\n        to {\n            -webkit-transform: scale(1);\n            opacity: 1;\n        }\n    }\n    @-webkit-keyframes popout {\n        from {\n            -webkit-transform: scale(1);\n            opacity: 1;\n        }\n        to {\n            -webkit-transform: scale(.8);\n            opacity: 0;\n        }\n    }\n    /* evc style */\n    .popupbox-cover,\n    .popupbox\n    {\n        position: "+(a.position||"fixed")+";\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n    }\n    .popupbox-main,\n    .popupbox-content\n    {\n        position: relative;\n    }\n    .popupbox-main\n    {\n        overflow-y: auto;\n        overflow-x: hidden;\n    }\n    .popupbox-content\n    {\n        -webkit-transition: margin-top .3s ease-out;\n        -moz-transition: margin-top .3s ease-out;\n        -o-transition: margin-top .3s ease-out;\n        transition: margin-top .3s ease-out;\n    }\n</style>"}}),define("school-ui-studyplan/widget/gl-pl/popupbox/main",["module","jquery","template!./index.html"],function(a,b,c){"use strict";function d(){var a=navigator.userAgent;return a.indexOf("Windows NT")>=0||a.indexOf("Macintosh")>=0}function e(a,c){return!a||a.length<=0?{popIn:b.noop,popOut:b.noop}:(c?a.removeClass("popupbox-pop"):a.addClass("popupbox-pop"),{popIn:function(){a.removeClass("popupbox-out").addClass("popupbox-in")},popOut:function(){a.removeClass("popupbox-in").addClass("popupbox-out")}})}var f=function(a){this.el=a.el||"body",this.body="body"===this.el,this.msg=a.msg||"",this.overLap=a.overLap||"replace",this.stick=a.stick||!1,this.stickTop=a.stickTop||0,this.top=a.top||0,this.noAnimation=a.noAnimation||!1,this.bgColor=a.bgColor||"#000",this.opacity=a.opacity||.6,this.zIndex=a.zIndex||1,this.fullSize=a.fullSize||!1,this.closeble=a.closeble||!1,this.closeButtonHide=a.closeButtonHide||!1,this.closeButtonList=a.closeButtonList||[],this.closeInner=a.closeInner||!1,this.closeCallback=a.closeCallback||b.noop};return f.prototype={open:function(){var a=this,f=b.Deferred(),g=b(a.el);g.length<=0&&(g=b("body"));var h=g.find(" > div.popupbox, > div.popupbox-cover");if(h.length>0){if("cancel"===a.overLap)return f.reject(),f.promise();"replace"===a.overLap&&h.remove()}return a.$popupBoxWrapper=b(c({position:a.body?"fixed":"absolute",bgColor:a.bgColor,opacity:a.opacity,zIndex:a.zIndex,top:a.top,fullSize:a.fullSize,keySupport:d(),hasCloseButton:a.closeble&&!a.closeButtonHide,isInnerClose:a.closeInner})),a.$popupBoxCover=a.$popupBoxWrapper.filter(".popupbox-cover"),a.$popupBox=a.$popupBoxWrapper.filter(".popupbox"),a.$popupBoxMain=a.$popupBox.find(".popupbox-main"),a.$popupBoxContent=a.$popupBox.find(".popupbox-content"),a.stick||function(){b(window).resize(function(b){a.centralize()})}(),a.$popupBoxContent.prepend(a.msg),a.$popupBoxWrapper.appendTo(g),a.closeble&&(a.closeButtonList.push("a.popupbox-close"),function(){a.closeButtonList.length>0&&b.each(a.closeButtonList,function(b,c){a.$popupBox.on("click",c,function(b){b.preventDefault(),a.close()})})}(),function(){var b=a.$popupBoxCover.find("input.popupbox-keysupport");b.length>0&&b.focus().keydown(function(b){27==b.which&&a.close(),b.preventDefault()})}()),a.centralize(),a.noAnimation?(a.$popupBoxCover.show(),e(a.$popupBoxContent,!0).popIn(),f.resolve(a.$popupBoxContent)):a.$popupBoxCover.fadeIn(400,function(){e(a.$popupBoxContent).popIn(),f.resolve(a.$popupBoxContent)}),f.promise()},close:function(a){function c(){a||d.closeCallback()}var d=this,f=b.Deferred();return d.noAnimation?(e(d.$popupBoxContent,!0).popOut(),d.$popupBoxCover.hide(),c(),d.$popupBoxWrapper.remove(),f.resolve(b)):(e(d.$popupBoxContent).popOut(),window.setTimeout(function(){d.$popupBoxCover.fadeOut(200,function(){c(),d.$popupBoxWrapper.remove(),f.resolve(b)})},100)),f.promise()},centralize:function(){var a=this,b=a.$popupBox,c=a.$popupBoxContent,d=b.height(),e=c.outerHeight(),f=a.stick?a.stickTop:Math.floor((d-e)/2);return f=f<0?0:f,c.css("margin-top",f),a}},f}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/cancel-cp20/index.html",[],function(){return function(a){return'<div class="studyplan-cancel-action clearfix">\n    <button class="evc-studyplan-cancel-btn" role="button" data-action="cancelBooking" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568585" data-toggle="tooltip" data-placement="bottom" title="Cancel Class"></button>\n</div>\n<div class="gud studyplan-cancel-confirm clearfix">\n    <div class="gud studyplan-cancel-confirm-content">\n        <p data-weave="troopjs-ef/blurb/widget" data-blurb-id="18748"></p>\n        <button class="btn btn-default btn-sm" role="button" data-action="confirmCancel" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568588"></button>\n        <button class="btn btn-secondary btn-sm" role="button" data-action="keepBooking" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568589"></button>\n    </div>\n</div>\n<style type="text/css">\n.studyplan-cancel-action .tooltip-arrow{\n    border-bottom-color:#000;\n    border-bottom-color: rgba(0, 0, 0, 0.9);\n}\n.studyplan-cancel-action .tooltip-inner{\n    padding: 10px;\n    max-width: 260px;\n    background: #000;\n    background: rgba(0, 0, 0, 0.9);\n}\n.studyplan-cancel-confirm {\n    display: none;\n}\n.studyplan-cancel-confirm-content {\n    display: inline-block;\n    border: 1px solid #4a4a4a;\n    padding: 30px 40px;\n    background-color: #fff;\n    background-color: rgba(255, 255, 255, 0.8);\n    text-align: center;\n}\n.studyplan-cancel-confirm-content button {\n    margin: 0 10px;\n}\n.studyplan-cancel-confirm-content p {\n    font-size: 1.4em;\n    font-weight: bold;\n    text-align: center;\n}\n.evc-studyplan-cancel-btn{\n    border:none;\n    border-bottom: 1px solid #000;\n    background: none;\n    padding: 0;\n}\n.evc-studyplan-cancel-btn:hover{\n    color:#333;\n    border-bottom: 1px solid #333;\n}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/cancel-cp20/main",["troopjs-browser/component/widget","jquery","troopjs-ef/command/service","troopjs-data/cache/component","school-ui-studyplan/widget/gl-pl/popupbox/main","template!./index.html"],function(a,b,c,d,e,f){"use strict";function g(a,b,c){var d=!1;return{unhook:function(){a.unbind(b),d=!1},hook:function(){d||(a.bind(b,c),d=!0)}}}var h,i=[["Sunday","78946"],["Monday","78940"],["Tuesday","78941"],["Wednesday","78942"],["Thusday","78943"],["Friday","78944"],["Saterday","78945"]],j=[["January","77396"],["February","77397"],["March","77398"],["April","77399"],["May","77400"],["June","77401"],["July","77402"],["August","77403"],["September","77404"],["October","77405"],["November","77406"],["December","77407"]];return a.extend(function(){h||(h=new c("plbooking/cancel",new d),h.configure({url:"/services/school/command/plbooking/cancel",contentType:"application/json; charset=UTF-8",type:"post"}),h.start())},{"hub:memory/studyplan/evc/cp20/status":function(a){var b=this;a&&a.bookedClass&&a.bookedClass.classId&&(b.classId=a.bookedClass.classId,a.countdown.timeIn<=0||(b.html(f),b.showNotice(a)))},showNotice:function(a){var b,c=this,d=c.$element,e=d.find(".evc-studyplan-cancel-btn"),f=a.suggestedCancelTime,g="UTC "+f.timezone;b=f.minute>9?f.hour+":"+f.minute:f.hour+":0"+f.minute,c.publish("query",["blurb!"+i[f.dayOfWeek][1],"blurb!"+j[f.month-1][1],"blurb!639584"]).spread(function(a,c,d){var h=a.translation,i=c.translation,j=d.translation,k=b+", "+h+" "+i+" "+f.day;j=j.replace("%%Canceltime%%",k).replace("%%timezone%%",g),e.attr("title",j),e.tooltip()})},"hub:memory/studyplan/evc/cp20/start-status":function(a){var b=this,c=b.$element;"started"===a&&c.remove()},"dom:[data-action=cancelBooking]/click":function(a){a.preventDefault();var b=this,c=b.$element,d=c.find(".studyplan-cancel-confirm").html();b.popupbox=new e({el:".ets-sp-init",zIndex:160,msg:d,bgColor:"#fff",closeble:!0,closeButtonHide:!0}),b.popupbox.open().then(function(a){g(a.find("button[data-action='keepBooking']"),"click",function(a){a.preventDefault(),b.popupbox.close()}).hook(),g(a.find("button[data-action='confirmCancel']"),"click",function(a){a.preventDefault(),b.popupbox.close();var c={class_id:b.classId};b.publish("plbooking/cancel",c).then(function(){b.publish("studyplan/sequence/update"),b.publish("studyplan/sequence-container/reload")})}).hook()})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/cancel-pl/index.html",[],function(){return function(a){return'<div class="studyplan-cancel-action clearfix">\n    <button class="evc-studyplan-cancel-btn" role="button" data-action="cancelBooking" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568585" data-toggle="tooltip" data-placement="bottom" title="Cancel Class"></button>\n</div>\n<div class="gud studyplan-cancel-confirm clearfix">\n    <div class="gud studyplan-cancel-confirm-content">\n        <p data-weave="troopjs-ef/blurb/widget" data-blurb-id="18748"></p>\n        <button class="btn btn-default btn-sm" role="button" data-action="confirmCancel" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568588"></button>\n        <button class="btn btn-secondary btn-sm" role="button" data-action="keepBooking" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568589"></button>\n    </div>\n</div>\n<style type="text/css">\n.studyplan-cancel-action .tooltip-arrow{\n    border-bottom-color:#000;\n    border-bottom-color: rgba(0, 0, 0, 0.9);\n}\n.studyplan-cancel-action .tooltip-inner{\n    padding: 10px;\n    max-width: 260px;\n    background: #000;\n    background: rgba(0, 0, 0, 0.9);\n}\n.studyplan-cancel-confirm {\n    display: none;\n}\n.studyplan-cancel-confirm-content {\n    display: inline-block;\n    border: 1px solid #4a4a4a;\n    padding: 30px 40px;\n    background-color: #fff;\n    background-color: rgba(255, 255, 255, 0.8);\n    text-align: center;\n}\n.studyplan-cancel-confirm-content button {\n    margin: 0 10px;\n}\n.studyplan-cancel-confirm-content p {\n    font-size: 1.4em;\n    font-weight: bold;\n    text-align: center;\n}\n.evc-studyplan-cancel-btn{\n    border:none;\n    border-bottom: 1px solid #000;\n    background: none;\n    padding: 0;\n}\n.evc-studyplan-cancel-btn:hover{\n    color:#333;\n    border-bottom: 1px solid #333;\n}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/cancel-pl/main",["troopjs-browser/component/widget","jquery","troopjs-ef/command/service","troopjs-data/cache/component","school-ui-studyplan/widget/gl-pl/popupbox/main","template!./index.html"],function(a,b,c,d,e,f){"use strict";function g(a,b,c){var d=!1;return{unhook:function(){a.unbind(b),d=!1},hook:function(){d||(a.bind(b,c),d=!0)}}}var h,i=[["Sunday","78946"],["Monday","78940"],["Tuesday","78941"],["Wednesday","78942"],["Thusday","78943"],["Friday","78944"],["Saterday","78945"]],j=[["January","77396"],["February","77397"],["March","77398"],["April","77399"],["May","77400"],["June","77401"],["July","77402"],["August","77403"],["September","77404"],["October","77405"],["November","77406"],["December","77407"]];return a.extend(function(){h||(h=new c("plbooking/cancel",new d),h.configure({url:"/services/school/command/plbooking/cancel",contentType:"application/json; charset=UTF-8",type:"post"}),h.start())},{"hub:memory/studyplan/evc/pl/status":function(a){var b=this;a&&a.bookedClass&&a.bookedClass.classId&&(b.classId=a.bookedClass.classId,a.countdown.timeIn<=0||(b.html(f),b.showNotice(a)))},showNotice:function(a){var b,c=this,d=c.$element,e=d.find(".evc-studyplan-cancel-btn"),f=a.suggestedCancelTime,g="UTC "+f.timezone;b=f.minute>9?f.hour+":"+f.minute:f.hour+":0"+f.minute,c.publish("query",["blurb!"+i[f.dayOfWeek][1],"blurb!"+j[f.month-1][1],"blurb!568586"]).spread(function(a,c,d){var h=a.translation,i=c.translation,j=d.translation,k=b+", "+h+" "+i+" "+f.day;j=j.replace("%%Canceltime%%",k).replace("%%timezone%%",g),e.attr("title",j),e.tooltip()})},"hub:memory/studyplan/evc/pl/start-status":function(a){var b=this,c=b.$element;"started"===a&&c.remove()},"dom:[data-action=cancelBooking]/click":function(a){a.preventDefault();var b=this,c=b.$element,d=c.find(".studyplan-cancel-confirm").html();b.popupbox=new e({el:".ets-sp-init",zIndex:160,msg:d,bgColor:"#fff",closeble:!0,closeButtonHide:!0}),b.popupbox.open().then(function(a){g(a.find("button[data-action='keepBooking']"),"click",function(a){a.preventDefault(),b.popupbox.close()}).hook(),g(a.find("button[data-action='confirmCancel']"),"click",function(a){a.preventDefault(),b.popupbox.close();var c={class_id:b.classId};b.publish("plbooking/cancel",c).then(function(){b.publish("studyplan/sequence/update"),b.publish("studyplan/sequence-container/reload")})}).hook()})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/checkpoint20/index.html",[],function(){return function(a){var b="",c=a.statusCode;a.unitId;return b+='\n<div class="st-evc-status" data-weave="school-ui-studyplan/widget/gl-pl/announcement/cp20"></div>\n<div class="st-evc-status" data-weave="school-ui-studyplan/widget/gl-pl/statusbar/cp20"></div>\n<div class="evc-studyplan-wrapper">\n\t',"welcome"===c?b+='\n\t\t<div class="evc-studyplan-column-single evc-studyplan-welcome" data-weave="school-ui-studyplan/widget/gl-pl/welcome-cp20/main"></div>\n\t':(b+='\n\t\t<div class="evc-studyplan-column-full"></div>\n\t\t',"nevertake"!==c&&"dropout"!==c&&(b+='\n\t\t\t<div class="evc-studyplan-column-single">\n\t\t\t\t<div class="evc-studyplan-gap-2x" data-weave="school-ui-studyplan/widget/gl-pl/lesson/cp20"></div>\n\t\t\t\t',"pending"!==c&&"attended"!==c&&(b+='\n\t\t\t\t\t<div class="evc-studyplan-gap-1x evc-studyplan-class-info"></div>\n\t\t\t\t'),b+="\n\t\t\t</div>\n\t\t"),b+='\n\t\t<div class="evc-studyplan-activity-container">\n\t\t</div>\n\t'),
b+='\n</div>\n\n<div class="evc-ui-tck-waiting modal fade in" role="dialog" aria-hidden="true">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content">\n\t\t\t<div class="modal-body">\n\t\t\t\t<div class="evc-ui-tck-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639585" data-text-en="Before entering class, let\'s check your microphone and audio."></div>\n\t\t\t\t<div class="evc-ui-tck-sub-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639586" data-text-en="Wait just a moment while we check your sound system. We want to make sure you don\'t miss anything."></div>\n\t\t\t\t<div class="evc-ui-tck-loading"></div>\n\t\t\t\t<div class="evc-ui-tck-checking" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639587" data-text-en="We are checking your microphone and speakers. Please wait a second"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="modal-backdrop fade in hidden"></div>\n\n<style type="text/css">\n\t.evc-studyplan-wrapper{\n\t\ttext-align: center;\n\t\tpadding: 30px 0 50px;\n\t\tcolor: #4a4a4a;\n\t}\n\t.evc-studyplan-column-full{\n\t\tdisplay: inline-block;\n\t}\n\t.evc-studyplan-column-single{\n\t\tdisplay: inline-block;\n\t\twidth: 980px;\n\t}\n\t.evc-studyplan-column-single hr{\n\t\tmargin-bottom: 0;\n\t}\n\t.evc-studyplan-gap-2x{\n\t\ttext-align: left;\n\t\twidth: 620px;\n\t\tpadding-left: 35px;\n\t\tpadding-right: 35px;\n\t\tvertical-align: top;\n\t\tdisplay: inline-block;\n\t\tmargin: 20px auto;\n\t}\n\t.evc-studyplan-gap-1x{\n\t\ttext-align: left;\n\t\twidth: 330px;\n\t\tvertical-align: top;\n\t\tmargin: auto;\n\t\tpadding-left: 30px;\n\t\tdisplay: inline-block;\n\t\tborder-left:1px #eee solid;\n\t}\n\t.evc-studyplan-gap-1x .evc-studyplan-gap-block{\n\t\tmargin-bottom: 15px;\n\t}\n\t.st-evc-status{\n\t\tcolor: #4a4a4a;\n\t\tbackground-color: #e6e6e6;\n\t}\n\t.evc-studyplan-gray{\n\t\tcolor:#999999;\n\t}\n\t.evc-studyplan-green{\n\t\tcolor:#87c600;\n\t}\n\t.evc-studyplan-blue{\n\t\tcolor: #00bee3;\n\t}\n\t.evc-none{\n\t\tdisplay: none;\n\t}\n\t.gud .evc-ui-tck-waiting .modal-dialog{\n\t\tposition: absolute;\n\t\twidth: 920px;\n\t\tleft: 50%;\n\t\ttop:50%;\n\t\tmargin-left: -460px;\n\t\tmargin-top: -200px;\n\t}\n\t.evc-ui-tck-waiting .modal-body{\n\t\tpadding: 20px 20px 50px 20px;\n\t}\n\t.evc-ui-tck-waiting{\n\t\ttext-align: center;\n\t}\n\t.evc-ui-tck-waiting .evc-ui-tck-title {\n\t\tfont: italic bold 16px Georgia, Arial, sans-serif;\n\t\tfont-size: 18px;\n\t\tfont-weight: normal;\n\t\tcolor: #262b31;\n\t\tpadding: 30px 0 10px 0;\n\t}\n\t.evc-ui-tck-waiting .evc-ui-tck-sub-title {\n\t\tfont-size: 14px;\n\t\tcolor: #c4c4c4;\n\t\tpadding-bottom: 10px;\n\t}\n\t.evc-ui-tck-loading{\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tbackground:url(data:image/gif;base64,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);\n\t\tmargin: 30px auto;\n\t}\n\t.evc-studyplan-activity-container {\n\t\twidth:880px;\n\t\tmargin:0 auto;\n\t}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/checkpoint20/main",["when","jquery","troopjs-browser/component/widget","school-ui-studyplan/module","school-ui-studyplan/utils/client-storage","school-ui-studyplan/utils/time-parser","template!./index.html"],function(a,b,c,d,e,f,g){"use strict";function h(a,c,d){var e=this,f=b("<div>");return a===i?f.attr("data-weave",a+"(unitId, classId)").data("classId",e[o]):f.attr("data-weave",a+"(unitId)"),f.addClass(d||"").data("unitId",e[n]).appendTo(e.$element.find(c)).weave()}var i="school-ui-studyplan/widget/gl-pl/enter-class/cp20",j=".evc-studyplan-activity-container",k=".evc-studyplan-class-info",l="evc-studyplan-gap-2x text-center",m="evc-studyplan-gap-block",n="_unit_id",o="_class_id",p=d.config().cacheServer+"/_imgs/evc/pl/topic/100x100/",q=d.config().cacheServer+"/_imgs/evc/pl/pl_default_100x100.png";return c.extend(function(b,c,d){var f=this;(d||d.properties)&&(f._item=d,f.closeOptionalTips="closed"===e.getLocalStorage("cp20_tips"),f.cpStatusDeferred=a.defer())},{"hub:memory/load/unit":function(a){var b=this;a&&a.legacyUnitId&&(b.unitId=a.legacyUnitId,b.publish("query",["member_site_setting!evc;FirstTimeStudyPlanCP20"]).spread(function(a){a&&("true"===a.value.toString()?b.publish("studyplan/evc/cp20/load"):b.html(g,{unitId:b.unitId,statusCode:"welcome"}))}))},"hub/studyplan/evc/techcheck/finished":function(){this.publish("studyplan/evc/cp20/load")},"hub:memory/studyplan/evc/cp20/start-status":function(a){var b=this;switch(a){case"notyet":b.publish("glpl-techcheck/show-desc",!1),b.$element.find(".ets-sp-glpl-techcheck").removeClass("ets-none"),b.$element.find(".ets-sp-glpl-enter-class").addClass("ets-none");break;case"incountdown":b.publish("glpl-techcheck/show-desc",!0),b.$element.find(".ets-sp-glpl-techcheck").removeClass("ets-none"),b.$element.find(".ets-sp-glpl-enter-class").addClass("ets-none");break;case"started":b.publish("glpl-techcheck/show-desc",!0),b.$element.find(".ets-sp-glpl-techcheck").toggleClass("ets-none","passed"===e.getSessionStorage("techcheck_state")),b.$element.find(".ets-sp-glpl-enter-class").toggleClass("ets-none","passed"!==e.getSessionStorage("techcheck_state"))}},"hub/studyplan/evc/cp20/load":function(){var b=this;b[n]=b.unitId,a.all([b.publish("query",["checkpointstate!cp20;"+b.unitId]),b.publish("query",[b._item.id+".progress"])]).spread(function(a,c){var d=a[0],n=c[0];if(d&&d.topic&&d.statusCode){var r={},s=d.topic,t=d.statusCode.toLowerCase();if(b.cpStatusDeferred.resolver.notify(t),r.status={statusCode:t},r.lessonInfo={topic:s.topicBlurbId,description:s.descBlurbId,image:s.imageUrl?p+s.imageUrl:q},"booked"===t||"attended"===t||"pending"===t||"nevertake"===t||"dropout"===t){var u=d.bookedClass||d.pastClass;if(u&&u.easternStartTime&&(b[o]=u.classId,r.timezoneId=u.timezoneId,r.bookedClass={classId:u.classId,teacherId:u.teacherId},r.customizedStartTime=f.toLocalTime(u.easternStartTime,u.timeZoneOffset)),"booked"===t){if(!u||!u.easternSuggestedCancelTime||!d.countdown)return;var v=d.countdown;r.countdown={timeIn:v.secondsLeftForStart,timeOut:v.secondsLeftForEnter},r.suggestedCancelTime=f.toLocalTime(u.easternSuggestedCancelTime,u.timeZoneOffset)}else if("pending"===t){if(!d.feedback)return;r.feedback={teacherId:d.feedback.teacherId}}else if("attended"===t){if(!d.feedback)return;var w=d.feedback;r.feedback={feedbackId:w.feedbackId,teacherId:w.teacherId}}var x=u&&u.evcServerCode||"",y=x.toLowerCase().indexOf("evc")<0;y||e.setSessionStorage("techcheck_state","passed"),b.html(g,{unitId:b.unitId,statusCode:t}).then(function(){b.$element.find(k).empty(),b.$element.find(j).empty();var a=b.$element.find(".modal-backdrop");switch(b._$waiting=b.$element.find(".evc-ui-tck-waiting"),b._$waiting.on("show.bs.modal",function(){a.removeClass("hidden")}).on("hidden.bs.modal",function(){a.addClass("hidden"),b._timer_waiting&&clearTimeout(b._timer_waiting)}),b.publish("studyplan/evc/cp20/status",r),b.publish("studyplan/evc/cp20/start-status","notyet"),b.publish("studyplan/evc/cp20/enter-token",n.progress.properties.token),b.closeOptionalTips||b.publish("studyplan/evc/cp20/notification",{statusCode:"optional_msg_pl"}),t.toLowerCase()){case"nevertake":h.call(b,"school-ui-studyplan/widget/gl-pl/book-cp20/main",j,l);break;case"dropout":h.call(b,"school-ui-studyplan/widget/gl-pl/dropout-cp20/main",j,l);break;case"booked":h.call(b,"school-ui-studyplan/widget/gl-pl/countdown/cp20",k,m),h.call(b,"school-ui-studyplan/widget/gl-pl/class-status/cp20",k,m),y&&h.call(b,"school-ui-studyplan/widget/gl-pl/techcheck/main",k,m+" ets-sp-glpl-techcheck"),h.call(b,i,k,m+" ets-sp-glpl-enter-class ets-none"),h.call(b,"school-ui-studyplan/widget/gl-pl/cancel-cp20/main",k,m);break;case"attended":h.call(b,"school-ui-studyplan/widget/gl-pl/feedback/cp20",j,l);break;case"pending":h.call(b,"school-ui-studyplan/widget/gl-pl/feedback-pending/main",j,l)}})}}})},"hub/studyplan/evc/techcheck/waiting/show":function(){var b=this;return a.promise(function(a){b._$waiting.modal({backdrop:"static"}),b._timer_waiting&&clearTimeout(b._timer_waiting),b._timer_waiting=setTimeout(function(){b._$waiting.modal("hide"),a()},3e3)})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/class-status/class-status.html",[],function(){return function(a){return'<div class="evc-studyplan-class-tips '+(a.classname?a.classname:"")+'">\n    <i class="'+(a.icon?a.icon:"glyphicon icon-comment")+'"></i>\n    <span   data-weave="troopjs-ef/blurb/widget" \n            data-text-en="'+a.en+'" \n            data-blurb-id="'+a.blurbId+'" >\n    </span>\n</div>\n<style>\n    .evc-studyplan-class-tips{\n        font-family: "roboto_condensedbold", "Helvetica Neue", Helvetica, Arial, sans-serif;\n        text-transform: uppercase;\n        font-size: 18px;\n    }\n    .evc-studyplan-class-tips .glyphicon {\n\t    margin-right: 10px;\n    }\n    .evc-studyplan-class-tips *{\n        vertical-align: middle;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/class-status/cp20",["troopjs-ef/component/widget","school-ui-studyplan/utils/client-storage","template!./class-status.html"],function(a,b,c){var d={tckNoPass:{BOOKED:{blurbId:"568587",en:"Class booked",classname:"evc-studyplan-green"},CLOSED:{blurbId:"656133",en:"Classroom not open",classname:"evc-studyplan-gray"},OPEN:{blurbId:"656134",en:"Classroom is open but you cannot enter",classname:"evc-studyplan-blue"}},tckPassed:{BOOKED:{blurbId:"568587",en:"Class booked",classname:"evc-studyplan-green"},CLOSED:{blurbId:"656133",en:"Classroom not open",classname:"evc-studyplan-gray"},OPEN:{blurbId:"568579",en:"Classroom is open",classname:"evc-studyplan-blue"}}};return a.extend(function(a,b,c){this._unitId=c},{"sig/initialize":function(){var a=this;return a.query("checkpointstate!cp20;"+a._unitId).spread(function(b){if(a._statusCode=b.statusCode.toLowerCase(),"booked"===a._statusCode)return a.render("BOOKED")})},"hub:memory/studyplan/evc/cp20/start-status":function(a){var b=this;"booked"===b._statusCode&&("started"===a?b.render("OPEN"):"incountdown"===a&&b.render("CLOSED"))},render:function(a){var e="passed"===b.getSessionStorage("techcheck_state")?d.tckPassed:d.tckNoPass;if(e[a])return this.html(c,e[a])}})}),define("school-ui-studyplan/widget/gl-pl/class-status/gl",["troopjs-ef/component/widget","school-ui-studyplan/utils/client-storage","template!./class-status.html"],function(a,b,c){var d={tckNoPass:{CLOSED:{blurbId:"656133",en:"Classroom not open",classname:"evc-studyplan-gray"},OPEN:{blurbId:"656134",en:"Classroom is open but you cannot enter",classname:"evc-studyplan-blue"}},tckPassed:{CLOSED:{blurbId:"656133",en:"Classroom not open",classname:"evc-studyplan-gray"},OPEN:{blurbId:"568579",en:"Classroom is open",classname:"evc-studyplan-blue"}}};return a.extend({"hub:memory/studyplan/evc/gl/start-status":function(a){var e=this,f="passed"===b.getSessionStorage("techcheck_state")?d.tckPassed:d.tckNoPass;"started"===a?e.html(c,f.OPEN):e.html(c,f.CLOSED)}})}),define("school-ui-studyplan/widget/gl-pl/class-status/pl",["troopjs-ef/component/widget","school-ui-studyplan/utils/client-storage","template!./class-status.html"],function(a,b,c){var d={tckNoPass:{BOOKED:{blurbId:"568587",en:"Class booked",classname:"evc-studyplan-green"},CLOSED:{blurbId:"656133",en:"Classroom not open",classname:"evc-studyplan-gray"},OPEN:{blurbId:"656134",en:"Classroom is open but you cannot enter",classname:"evc-studyplan-blue"}},tckPassed:{BOOKED:{blurbId:"568587",en:"Class booked",classname:"evc-studyplan-green"},CLOSED:{blurbId:"656133",en:"Classroom not open",classname:"evc-studyplan-gray"},OPEN:{blurbId:"568579",en:"Classroom is open",classname:"evc-studyplan-blue"}}};return a.extend(function(a,b,c){this._unitId=c},{"sig/initialize":function(){var a=this;return a.query("plclass!"+a._unitId).spread(function(b){if(a._statusCode=b.statusCode.toLowerCase(),"booked"===a._statusCode)return a.render("BOOKED")})},"hub:memory/studyplan/evc/pl/start-status":function(a){var b=this;"booked"===b._statusCode&&("started"===a?b.render("OPEN"):"incountdown"===a&&b.render("CLOSED"))},render:function(a){var e="passed"===b.getSessionStorage("techcheck_state")?d.tckPassed:d.tckNoPass;if(e[a])return this.html(c,e[a])}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/countdown-scoreboard/index.html",[],function(){return function(a){return'<div class="countdown-scoreboard text-center clearfix">\n    <div class="countdown-scoreboard-boards pull-left">\n        <ol class="boards-container">\n            <li class="countdown-scoreboard-board hh">\n                <div class="top">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="bottom">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="top-animation">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="bottom-animation">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <span class="hh">HOUR</span>\n            </li>\n            <li class="board-separator"></li>\n            <li class="countdown-scoreboard-board mm">\n                <div class="top">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="bottom">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="top-animation">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="bottom-animation">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <span class="mm">MIN</span>\n            </li>\n            <li class="board-separator"></li>\n            <li class="countdown-scoreboard-board ss">\n                <div class="top">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="bottom">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="top-animation">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <div class="bottom-animation">\n                    <span class="tens disabled">0</span>\n                    <span class="ones disabled">0</span>\n                </div>\n                <span class="ss">SEC</span>\n            </li>\n        </ol>\n    </div>\n</div>\n\n<style type="text/css">\n.countdown-scoreboard, .countdown-scoreboard .countdown-scoreboard-boards li, .countdown-scoreboard .countdown-scoreboard-labels li {\n    display: inline-block;\n    *display: inline;\n    *zoom: 1;\n}\n.countdown-scoreboard {\n    position: relative;\n    font-family: Arial;\n    text-align: center;\n}\n.countdown-scoreboard .countdown-scoreboard-boards {\n    position: relative;\n}\n.countdown-scoreboard ol, .countdown-scoreboard ul {\n    margin: 0;\n    list-style: none;\n}\n.countdown-scoreboard .boards-container {\n    border-radius: 4px;\n    position: relative;\n}\n.countdown-scoreboard .countdown-scoreboard-boards li {\n    font-size: 0px;\n    text-align: center;\n    vertical-align: middle;\n}\n.countdown-scoreboard .countdown-scoreboard-board,\n.countdown-scoreboard .countdown-scoreboard-board div,\n.countdown-scoreboard .countdown-scoreboard-board span {\n    width: 38px;\n    height: 31px;\n    line-height: 29px;\n    margin-bottom: 10px;\n}\n.countdown-scoreboard .countdown-scoreboard-board {\n    position:relative;\n    -webkit-perspective: 5em;\n    -moz-perspective: 5em;\n    -ms-perspective: 5em;\n    -o-perspective: 5em;\n    perspective: 5em;\n    text-align:center;\n}\n.countdown-scoreboard .countdown-scoreboard-board div {\n    height: 50%;\n    overflow: hidden;\n    position:absolute;\n    left:0;\n}\n.countdown-scoreboard .countdown-scoreboard-board span {\n    width: auto;\n    color: #000;\n    font-size : 18px;\n    font-family: "roboto_condensedbold", "Helvetica Neue", Helvetica, Arial, sans-serif;\n    font-weight: bold;\n}\n.countdown-scoreboard .board-separator {\n    width: 0px;\n    border-right: 1px solid #828275;\n    height: 32px;\n    vertical-align: middle;\n}\n.countdown-scoreboard .top,\n.countdown-scoreboard .top-animation {\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    top: 0;\n}\n.countdown-scoreboard .bottom,\n.countdown-scoreboard .bottom-animation {\n    border-bottom-left-radius: 4px;\n    border-bottom-right-radius: 4px;\n    top: 50%;\n}\n.countdown-scoreboard .top span,\n.countdown-scoreboard .top-animation span,\n.countdown-scoreboard .bottom span,\n.countdown-scoreboard .bottom-animation span {\n    height: 200%;\n    position: relative;\n}\n.countdown-scoreboard .bottom span,\n.countdown-scoreboard .bottom-animation span {\n    top: -100%;\n}\n.countdown-scoreboard .top-animation,\n.countdown-scoreboard .bottom-animation {\n    visibility: hidden;\n}\n.countdown-scoreboard .top-animation.animation,\n.countdown-scoreboard .bottom-animation.animation {\n    visibility: visible;\n}\n@keyframes countdownScoreboardBottom {\n    from {\n        transform: rotateX(0);\n    }\n    to {\n        transform: rotateX(90deg);\n    }\n}\n@-webkit-keyframes countdownScoreboardBottom {\n    from {\n        -webkit-transform: rotateX(0);\n    }\n    to {\n        -webkit-transform: rotateX(90deg);\n    }\n}\n@-moz-keyframes countdownScoreboardBottom {\n    from {\n        -moz-transform: rotateX(0);\n    }\n    to {\n        -moz-transform: rotateX(90deg);\n    }\n}\n@-ms-keyframes countdownScoreboardBottom {\n    from {\n        -ms-transform: rotateX(0);\n    }\n    to {\n        -ms-transform: rotateX(90deg);\n    }\n}\n@-o-keyframes countdownScoreboardBottom {\n    from {\n        -o-transform: rotateX(0);\n    }\n    to {\n        -o-transform: rotateX(90deg);\n    }\n}\n@keyframes countdownScoreboardTop {\n    from {\n        transform: rotateX(-90deg);\n    }\n    to {\n        transform: rotateX(0);\n    }\n}\n@-webkit-keyframes countdownScoreboardTop {\n    from {\n        -webkit-transform: rotateX(-90deg);\n    }\n    to {\n        -webkit-transform: rotateX(0);\n    }\n}\n@-ms-keyframes countdownScoreboardTop {\n    from {\n        -ms-transform: rotateX(-90deg);\n    }\n    to {\n        -ms-transform: rotateX(0);\n    }\n}\n@-o-keyframes countdownScoreboardTop {\n    from {\n        -o-transform: rotateX(-90deg);\n    }\n    to {\n        -o-transform: rotateX(0);\n    }\n}\n.countdown-scoreboard .bottom-animation.animation {\n    -webkit-animation: countdownScoreboardBottom 0.2s linear 0s forwards 1;\n    -moz-animation: countdownScoreboardBottom 0.2s linear 0s forwards 1;\n    -ms-animation: countdownScoreboardBottom 0.2s linear 0s forwards 1;\n    -o-animation: countdownScoreboardBottom 0.2s linear 0s forwards 1;\n    animation: countdownScoreboardBottom 0.2s linear 0s forwards 1;\n    -webkit-transform-origin: 0 top;\n    -moz-transform-origin: 0 top;\n    -ms-transform-origin: 0 top;\n    -o-transform-origin: 0 top;\n    transform-origin: 0 top;\n}\n.countdown-scoreboard .top-animation {\n    -webkit-transform: rotateX(-90deg);\n    -moz-transform: rotateX(-90deg);\n    -ms-transform: rotateX(-90deg);\n    -o-transform: rotateX(-90deg);\n    transform: rotateX(-90deg);\n}\n.countdown-scoreboard .top-animation.animation {\n    -webkit-animation: countdownScoreboardTop 0.3s ease-out 0.2s forwards 1;\n    -moz-animation: countdownScoreboardTop 0.3s ease-out 0.2s forwards 1;\n    -ms-animation: countdownScoreboardTop 0.3s ease-out 0.2s forwards 1;\n    -o-animation: countdownScoreboardTop 0.3s ease-out 0.2s forwards 1;\n    animation: countdownScoreboardTop 0.3s ease-out 0.2s forwards 1;\n    -webkit-transform-origin: 0 bottom;\n    -moz-transform-origin: 0 bottom;\n    -mstransform-origin: 0 bottom;\n    -o-transform-origin: 0 bottom;\n    transform-origin: 0 bottom;\n}\n.countdown-scoreboard .boards-axis {\n    width: 149px;\n    height: 1px;\n    position: absolute;\n    left: 3px;\n    top: 17px;\n    background: #eee;\n    opacity: 0.5;\n}\n.countdown-scoreboard .countdown-scoreboard-labels li {\n    font-size: 9px;\n}\n.countdown-scoreboard .countdown-scoreboard-board .hh,\n.countdown-scoreboard .countdown-scoreboard-board .ss,\n.countdown-scoreboard .countdown-scoreboard-board .mm {\n    font-size : 10px;\n    width: 38px;\n    position: relative;\n    bottom:-18px;\n    margin-bottom: 0;\n}\n/*.countdown-scoreboard .button,*/\n.countdown-scoreboard div.countdown-scoreboard-action {\n    position: relative;\n}\n.countdown-scoreboard div.countdown-scoreboard-action button.countdown-scoreboard-tips {\n    display: none;\n    color: #56c2d5;\n    background-color: #fff;\n    cursor: default;\n}\n.countdown-scoreboard .countdown-scoreboard-tips-icon {\n    transform: scaleX(-1);\n    -o-transform: scaleX(-1);\n    -moz-transform: scaleX(-1);\n    -webkit-transform: scaleX(-1);\n}\n.countdown-scoreboard .countdown-scoreboard-tips-txt {\n    white-space: nowrap;\n    text-transform: uppercase;\n}\n.countdown-scoreboard div.countdown-scoreboard-action button.countdown-scoreboard-enter {\n    display: none;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/countdown-scoreboard/main",["jquery","template!./index.html"],function(a,b){"use strict";function c(b){b=a.extend({finished:!1,paused:!1},b);var c=b.$el,f=!1;a.contains(document.body,c[0])||(f=!0,c.appendTo("body"));var g=(c.find(".countdown-scoreboard-boards"),c.find(".countdown-scoreboard-enter"));c.find(".countdown-scoreboard-waitting");g.css("left",0),f&&c.remove();return c.find(".top-animation, .bottom-animation").remove(),{$el:c,disabled:!1,checkPoints:{afterEnd:{},beforeEnd:{}},secondTimer:d,afterEndTimer:[],timeoutTimer:d,timeIn:b.timeIn,enterClickHandler:a.noop,secondsLeft:b.timeIn,timeOut:b.timeOut,timeOutHandler:a.noop,startHandler:a.noop,afterEnd:function(a,b){var c=this;return c.checkPoints.afterEnd[a]=b,c},beforeEnd:function(a,b){var c=this;return c.checkPoints.beforeEnd[a]=b,c},disableEnter:function(){var a=this;return a.disabled=!0,a.$el.find(".countdown-scoreboard-enter").addClass("disabled"),a},onDurationEnd:function(){var b=this;b.finished=!0;b.$el;return b.timeOut&&(b.timeoutTimer&&clearTimeout(timeoutTimer),b.timeoutTimer=setTimeout(b.timeOutHandler,1e3*(b.timeOut-b.timeIn))),a.each(b.checkPoints.afterEnd,function(a,c){b.afterEndTimer.push(setTimeout(function(){c.apply(b)},1e3*a))}),b},onEnterClick:function(a){var b=this;return b.enterClickHandler=a,b},onTimeout:function(a){var b=this;return b.timeOutHandler=a,b},onStart:function(a){var b=this;return b.startHandler=a,b},pause:function(){var a=this;return a.paused=!0,a},start:function(){var a=this;a.$el;return a.secondsLeft?(a.updateBoards(0,a.secondsLeft),function b(){if(!a.finished&&!a.paused){if(0===a.secondsLeft)return void a.onDurationEnd();var c=a.secondsLeft,d=--a.secondsLeft;a.updateBoards(c,d),a.checkPoints.beforeEnd[a.secondsLeft]&&a.checkPoints.beforeEnd[a.secondsLeft](),a.secondTimer=setTimeout(b,1e3)}}(),a.startHandler()):(a.checkPoints.beforeEnd[0]&&a.checkPoints.beforeEnd[0](),a.onDurationEnd()),a},updateBoard:function(a,b){var c=this,d=c.$el.find("."+a),e=(b.oldDigits,b.newDigits);return d.find(".tens").text(e.tens).end().find(".ones").text(e.ones),c},updateBoards:function(a,b){var c=this,d=["hh","mm","ss"],f=!0;a=e.convertToObject(a),b=e.convertToObject(b);for(var g=0;g<d.length;g++){var h=d[g],i=a[h],j=b[h];j.tens===i.tens&&j.ones===i.ones||c.updateBoard(d[g],{oldDigits:i,newDigits:j});for(var k,l=["tens","ones"],m=0;m<l.length;m++)k=c.$el.find("."+h+" ."+l[m]),f?j[l[m]]?(k.removeClass("disabled").addClass("enabled"),f=!1):k.removeClass("enabled").addClass("disabled"):k.removeClass("disabled").addClass("enabled")}return c}}}var d,e={convertToObject:function(a){return{hh:this.extractDigits(a/3600>>>0),mm:this.extractDigits(a%3600/60>>>0),ss:this.extractDigits(a%60)}},extractDigits:function(a){if(a<10)return{ones:a,tens:0};var b=(""+a).split("");return{ones:b[1]>>>0,tens:b[0]>>>0}},updateDigits:function(a){}};return function(){var d=a(b()),e={};return e.$el=d.appendTo("body").remove(),e.init=function(b){var d=this;if(!b)throw b={},"Init should have an input object.";var e=b.timeIn,f=b.timeOut;if(isNaN(e))throw b.timeIn=86399,"timeIn should be a number.";if(e>=86400)throw b.timeIn=86399,"timeIn should little than 24 * 60 * 60.";e<0?b.timeIn=0:"number"==typeof f&&f<=e&&(b.timeOut=0);var g=c(a.extend(b,{$el:d.$el}));return setTimeout(function(){g.start()},0),{afterEnd:function(a,b){var c=this;return a>=0&&g.afterEnd(a,b),c},beforeEnd:function(a,b){var c=this;return 0<=a&&(a<=g.secondsLeft?g.beforeEnd(a,b):b&&b()),c},disableEnter:function(){var a=this;return g.disableEnter(),a},onEnd:function(a){var b=this;return this.afterEnd(0,a),b},onEnterClick:function(a){var b=this;return g.onEnterClick(a),b},onTimeout:function(a){var b=this;return g.onTimeout(a),b},onStart:function(a){var b=this;return g.onStart(a),b},restart:function(){g.start()},stop:function(){return g.secondTimer&&clearTimeout(g.secondTimer),g.timeoutTimer&&clearTimeout(g.timeoutTimer),g.afterEndTimer.forEach(function(a){clearTimeout(a)}),this}}},e}}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/countdown/index.html",[],function(){return function(a){var b="";return b+='\n<div class="evc-studyplan-countdown">\n    <div class="evc-studyplan-countdown-block">\n        <strong><span>'+a.time+"</span></strong><span>,</span>&nbsp;<span>"+a.day+"</span>&nbsp;<span>UTC&nbsp;"+a.timezone+'</span>\n    </div>\n</div>\n\n<style type="text/css">\n    .evc-studyplan-countdown{\n        font-size: 14px;\n        display: inline-block;\n\t    background:#eee;\n    }\n    .evc-studyplan-countdown-block{\n        display: inline-block;\n        padding: 10px 18px;\n    }\n    .evc-studyplan-countdown-status{\n        color: #fff;\n        background-color: #bbb;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/countdown/main",["troopjs-browser/component/widget","jquery","template!./index.html"],function(a,b,c){"use strict";var d=[["Sunday","78946"],["Monday","78940"],["Tuesday","78941"],["Wednesday","78942"],["Thusday","78943"],["Friday","78944"],["Saterday","78945"]],e=[["January","77396"],["February","77397"],["March","77398"],["April","77399"],["May","77400"],["June","77401"],["July","77402"],["August","77403"],["September","77404"],["October","77405"],["November","77406"],["December","77407"]];return a.extend({disableEnter:function(){var a=this;a.countdownScoreboard&&a.countdownScoreboard.disableEnter()},renderDate:function(a,b){var f=this;if(a){var g,h;g=a.minute>9?a.hour+":"+a.minute:a.hour+":0"+a.minute,b?f.publish("query",["blurb!"+d[a.dayOfWeek][1],"blurb!"+e[a.month-1][1]]).spread(function(b,d){var e=b.translation,i=d.translation;h=e+" "+i+" "+a.day,f.html(c,{time:g,day:h,timezone:a.timezone})}):f.publish("query",["blurb!103048"]).spread(function(b){h=b.translation||"Today",f.html(c,{time:g,day:h,timezone:a.timezone})})}}})}),
define("school-ui-studyplan/widget/gl-pl/countdown/cp20",["jquery","./main","school-ui-studyplan/widget/gl-pl/countdown-scoreboard/main"],function(a,b,c){"use strict";return b.extend({"sig/stop":function(){var a=this;a.countdownScoreboard&&a.countdownScoreboard.stop()},render:function(a){var b=this;if(a){var d=new c;b.html(d.$el);var e=a.countdown.timeIn,f=a.countdown.timeOut;b.publish("studyplan/evc/cp20/start-status","incountdown"),b.$element.toggleClass("evc-none",0===e),b.countdownScoreboard=d.init({timeIn:e,timeOut:f}).onTimeout(function(){b.publish("studyplan/evc/cp20/load")}).onEnd(function(){b.$element.addClass("evc-none"),b.publish("studyplan/evc/cp20/start-status","started")})}},"hub:memory/studyplan/evc/cp20/status":function(a){var b=this;a&&a.customizedStartTime&&a.suggestedCancelTime&&(b.lesson=a,b.customizedStartTime=a.customizedStartTime,b.suggestedCancelTime=a.suggestedCancelTime,b.timezoneId=a.timezoneId,b.lessonMinutesOfDay=60*b.customizedStartTime.hour+b.customizedStartTime.minute,b.lessonSecondsOfDay=60*b.lessonMinutesOfDay,a.countdown.timeIn>b.lessonSecondsOfDay?b.onemoreDayLesson():a.countdown.timeIn>3600?b.onemoreHourLesson():b.render(a))},onemoreDayLesson:function(){var a=this;a.renderDate(a.customizedStartTime,!0)},onemoreHourLesson:function(b){var c=this;b=b||c.lesson.countdown.timeIn-3600,window.setTimeout(function(){c.render(a.extend(!0,c.lesson,{countdown:{timeIn:3600}}))},1e3*b),c.renderDate(c.customizedStartTime)}})}),define("school-ui-studyplan/widget/gl-pl/grouplesson/service",["troopjs-core/component/gadget","jquery","when","moment","school-ui-studyplan/module"],function(a,b,c,d,e){"use strict";var f=e.config().cacheServer+"/_imgs/evc/gl/topic/100x100/";return a.extend(function(a){this.unitId=a},{get:function(){var a=this,b=c.defer();return a.publish("query",["glclass!"+a.unitId]).spread(function(a){a||b.reject();var c=a.topic,e=a.countDown,g=a.room,h={};h.lessonInfo={topic:c.topicBlurb,description:c.descriptionBlurb,image:f+c.topicImageUrl},h.countdown={timeIn:e.secondsLeftForStart,timeOut:e.secondsLeftForEnter,startTime:d(e.classStartTime).valueOf(),hasClassScheduled:e.hasClassScheduled},h.classroom={global:g.global,local:g.local},h.topicId=a.topic.topicId,b.resolve(h)}),b.promise}})}),define("school-ui-studyplan/widget/gl-pl/countdown/gl",["jquery","when","./main","../grouplesson/service","school-ui-studyplan/widget/gl-pl/countdown-scoreboard/main","template!./index.html"],function(a,b,c,d,e,f){"use strict";return c.extend(function(a,c,d){var e=this;e.unitId=d,e.creditDeferred=b.defer()},{"sig/start":function(){var a=this;new d(a.unitId).get().then(function(b){b&&a.render(b)})},"sig/stop":function(){var a=this;a.countdownScoreboard&&a.countdownScoreboard.stop()},render:function(a){var b=this;if(a){var c=new e,d=a.countdown.timeIn,f=a.countdown.timeOut,g=a.countdown.startTime;b.publish("studyplan/evc/gl/start-time",g),b.publish("studyplan/evc/gl/start-status","incountdown"),a.countdown.hasClassScheduled&&(b.$element.toggleClass("evc-none",0===d),b.html(c.$el),b.countdownScoreboard=c.init({timeIn:d,timeOut:f}).onTimeout(function(){b.publish("studyplan/evc/gl/load")}).onEnd(function(){b.$element.addClass("evc-none"),b.publish("studyplan/evc/gl/start-status","started")}))}}})}),define("school-ui-studyplan/widget/gl-pl/countdown/pl",["jquery","./main","school-ui-studyplan/widget/gl-pl/countdown-scoreboard/main"],function(a,b,c){"use strict";return b.extend({"sig/stop":function(){var a=this;a.countdownScoreboard&&a.countdownScoreboard.stop()},render:function(a){var b=this;if(a){var d=new c;b.html(d.$el);var e=a.countdown.timeIn,f=a.countdown.timeOut;b.publish("studyplan/evc/pl/start-status","incountdown"),b.$element.toggleClass("evc-none",0===e),b.countdownScoreboard=d.init({timeIn:e,timeOut:f}).onTimeout(function(){b.publish("studyplan/evc/pl/load")}).onEnd(function(){b.$element.addClass("evc-none"),b.publish("studyplan/evc/pl/start-status","started")})}},"hub:memory/studyplan/evc/pl/status":function(a){var b=this;a&&a.customizedStartTime&&a.suggestedCancelTime&&(b.lesson=a,b.customizedStartTime=a.customizedStartTime,b.suggestedCancelTime=a.suggestedCancelTime,b.timezoneId=a.timezoneId,b.lessonMinutesOfDay=60*b.customizedStartTime.hour+b.customizedStartTime.minute,b.lessonSecondsOfDay=60*b.lessonMinutesOfDay,a.countdown.timeIn>b.lessonSecondsOfDay?b.onemoreDayLesson():a.countdown.timeIn>3600?b.onemoreHourLesson():b.render(a))},onemoreDayLesson:function(){var a=this;a.renderDate(a.customizedStartTime,!0)},onemoreHourLesson:function(b){var c=this;b=b||c.lesson.countdown.timeIn-3600,window.setTimeout(function(){c.render(a.extend(!0,c.lesson,{countdown:{timeIn:3600}}))},1e3*b),c.renderDate(c.customizedStartTime)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/credit/index.html",[],function(){return function(a){var b='<p class="evc-studyplan-coupon">\n    <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568613"></span>&nbsp;<span>'+a.couponLeft+"</span>\n    ";return a.canBuyMore&&(b+='\n        <a class="evc-studyplan-coupon-buymore" href="'+a.buyUrl+'">\n            <span class="evc-studyplan-coupon-plus">+</span>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="176459"></span>\n        </a>\n    '),b+='\n</p>\n<style type="text/css">\n    .evc-studyplan-gap-block .evc-studyplan-coupon{\n        margin: 20px 0 0 0;\n    }\n    .evc-studyplan-gap-block:first-child .evc-studyplan-coupon{\n        margin: 20px 0 20px 0;\n    }\n    .evc-studyplan-coupon{\n        font-weight: bold;\n        margin-bottom: 0;\n        line-height: 24px;\n\t    text-align: left;\n    }\n    a.evc-studyplan-coupon-buymore, /*add "a" tag to increase css priority*/\n    a.evc-studyplan-coupon-buymore:hover {\n        text-decoration: none;\n        color: #333;\n        margin-left: 10px;\n    }\n    .evc-studyplan-coupon-plus {\n        width: 18px;\n        height: 18px;\n        line-height: 18px;\n        vertical-align: baseline;\n        text-align: center;\n        color: #fff;\n        font-weight: bold;\n        font-family: arial;\n        font-size: 14px;\n        display: inline-block;\n        background-color: #81ba1a;\n        margin-right: 5px;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/credit/main",["troopjs-browser/component/widget","jquery","template!./index.html"],function(a,b,c){"use strict";function d(a,b,c){if(a){var d="";if(-1!==a.indexOf("#")&&(a=a.substr(0,a.indexOf("#"))),-1!==a.indexOf("?")){for(var e=a.substr(1),f=e.split("&"),g=0,h=f.length;g<h;g++)f[g].split("=")[0]===b&&(d=a.replace(f[g].split("=")[1],c));d||(d=a+"&"+b+"="+c)}return d||(d=a+"?"+b+"="+c),d}}return a.extend({render:function(a){var b=this;if(a){var e=location.pathname+location.search+location.hash;a.buyUrl=d(a.buyUrl,"upurl",encodeURIComponent(e)),b.html(c,a)}},generateBuyMoreUrl:function(a){if(a.buyUrl){var b=location.pathname+location.search+location.hash;return d(a.buyUrl,"upurl",encodeURIComponent(b))}}})}),define("school-ui-studyplan/widget/gl-pl/credit/gl",["jquery","./main","./service"],function(a,b,c){"use strict";return b.extend({"sig/start":function(){var a=this;(new c).get("GL").then(function(b){var c=b.credit;if(c)if(c.isUnlimitedAccess)a.publish("studyplan/evc/gl/credit",!0);else{var d,e=c.couponLeft>0;e||(c.canBuyMore&&c.buyUrl&&(d=a.generateBuyMoreUrl(c)),a.publish("studyplan/evc/gl/notification",{statusCode:"no_coupon_gl",link:d})),a.publish("studyplan/evc/gl/credit",e),a.render(c)}})}})}),define("school-ui-studyplan/widget/gl-pl/credit/pl",["jquery","./main","./service"],function(a,b,c){"use strict";return b.extend({"sig/start":function(){var a=this;(new c).get("PL").then(function(b){if(b){var c,d=b.credit;d.couponLeft<=0&&(d.canBuyMore&&d.buyUrl&&(c=a.generateBuyMoreUrl(d)),a.publish("studyplan/evc/pl/notification",{statusCode:"no_coupon_pl",link:c})),a.render(d)}})}})}),define("school-ui-studyplan/widget/gl-pl/credit/sppl20",["jquery","./main","./service"],function(a,b,c){"use strict";return b.extend({"sig/start":function(){var a=this;(new c).get("PL20").then(function(b){if(b){var c,d=b.credit;d.couponLeft<=0&&(d.canBuyMore&&d.buyUrl&&(c=a.generateBuyMoreUrl(d)),a.publish("studyplan/evc/pl/notification",{statusCode:"no_coupon_pl",link:c})),a.render(d)}})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/dropout-cp20/index.html",[],function(){return function(a){var b="";a.bookUrl;return b+='\n<div class="evc-studyplan-btn-book">\n\t<h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="639519" data-text-en="You missed your private lesson"></h2>\n\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="639583" data-text-en="Either you didn\'t show up or you canceled your Private Class too late."></p>\n\t<div class="evc-studyplan-btn-warp">\n\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="639513" data-text-en="Unfortunately, you cannot book a private lesson again. If you believe this was a mistake, please get in touch with us."></p>\n\t\t<button class="btn btn-default" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639514" data-text-en="Continue"></button>\n\t</div>\n</div>\n<p class="text-muted">'+this.blurbs.getTouch.replace("^clicking_here^","<a href=/customerservice/contactus/inschool target=_blank>"+this.blurbs.clicking+"</a>")+'</p>\n<style type="text/css">\n\t.evc-studyplan-activity-container .evc-studyplan-gap-2x {\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t\twidth: 660px;\n\t}\n\t.evc-studyplan-btn-book{\n\t\tpadding: 30px 20px;\n\t\tcolor: #555555;\n\t\tbackground-color: #f0f0f0;\n\t}\n\t.evc-studyplan-btn-book h2 {\n\t\tmargin-bottom: 10px;\n\t}\n\t.evc-studyplan-btn-book .btn{\n\t\tdisplay: inline-block;\n\t\tmargin: 10px 8px;\n\t}\n\t.evc-studyplan-btn-book p {\n\t\tfont-size: 1.3em;\n\t}\n\t.evc-studyplan-btn-warp {\n\t\tmargin-top: 20px;\n\t}\n\tp.text-muted {\n\t\tmargin-top: 8px;\n\t}\n\t.text-muted a {\n\t\tcolor: #999;\n\t\ttext-decoration: underline;\n\t}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/dropout-cp20/main",["jquery","troopjs-ef/component/widget","template!./index.html"],function(a,b,c){"use strict";return b.extend(function(a,b,c){this.unitId=c},{"sig/initialize":function(){var a=this;return a.query("blurb!639515","blurb!639516").spread(function(b,c){a.blurbs={clicking:c&&c.translation,getTouch:b&&b.translation}})},"sig/start":function(){var a=this;if(a.unitId){var b={};b.bookUrl="/school/evc/pl/unitaligned/"+a.unitId+"?source="+encodeURIComponent(location.href)+"&key=SP#booking",a.html(c,b)}},"dom:.btn-default/click":function(){this.publish("studyplan/sequence/navigate/goal")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/enter-class/enter-class.html",[],function(){return function(a){var b="",a=a||{};return b+='\n<div class="evc-studyplan-enter">\n\t<button class="btn btn-primary countdown-scoreboard-enter" data-weave="troopjs-ef/blurb/widget" data-blurb-id="78907">Enter class</button>\n</div>\n',a.hasRecord&&(b+='\n<label class="evc-studyplan-record '+(a.recordDisabled?"evc-studyplan-record-disabled":"")+'">\n\t<input type="checkbox" class="evc-studyplan-record-check" '+(a.recordChecked?'checked="checked"':"")+" "+(a.recordDisabled?'disabled="disabled"':"")+'/>\n\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="708472" data-text-en="Send me class video"></span>\n\t<span class="glyphicon glyphicon-exclamation-sign" data-toggle="popover" data-trigger="hover" data-placement="bottom" data-content="'+a.recordHint+'"></span>\n</label>\n'),b+='\n<style>\n\t.evc-studyplan-enter{\n\t\tmargin:20px 0;\n\t}\n\t.evc-studyplan-enter .btn {\n\t\tfont-family: "roboto_condensedbold", "Helvetica Neue", Helvetica, Arial, sans-serif;\n\t\ttext-transform: uppercase;\n\t\tpadding:10px 30px;\n\t}\n\tlabel.evc-studyplan-record {\n\t\tfont-weight: normal;\n\t}\n\tlabel.evc-studyplan-record-disabled {\n\t\tcolor: #ccc;\n\t}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/enter-class/cp20",["troopjs-ef/component/widget","template!./enter-class.html"],function(a,b){function c(a,b){return this[d].replace("?","?showcontentonly=y&").replace("{unitId}",a).replace("{source}",window.encodeURIComponent(window.location.href)).replace("{classId}",b)}var d="_cp20_enter_url";return a.extend(function(a,b,c,d){var e=this;e._unitId=c,e._classId=d},{"sig/start":function(){var a=this;return a.query("evc_url_resource!current").spread(function(b){a[d]=b.studyPlanUrls.CP20Entering})},"hub:memory/studyplan/evc/cp20/start-status":function(a){var c=this;"started"===a&&c.html(b)},"dom:.countdown-scoreboard-enter/click":function(){var a=this;a.publish("glpl-techcheck/trigger",!0).then(function(){window.open(c.call(a,a._unitId,a._classId),"_self")})}})}),define("school-ui-studyplan/widget/gl-pl/enter-class/gl",["jquery.gudstrap","troopjs-ef/component/widget","client-tracking","template!./enter-class.html"],function(a,b,c,d){function e(a){var b=this,c=b[m].replace("{unitId}",a).replace("{source}",window.encodeURIComponent(window.location.href));return b[k]&&(c+=";glRecordChecked="+b[l]),c}function f(){return"gl_record_checked_"+this[j]}function g(){var a;try{a=localStorage.getItem(f.call(this))}catch(b){a=null}return a}function h(a){try{localStorage.setItem(f.call(this),a)}catch(a){}}var i="_class_start_time",j="_member_id",k="_has_gl_record",l="_user_gl_record",m="_gl_enter_url";return b.extend(function(a,b,c){this._unitId=c},{"sig/start":function(){var a=this;return a.query(["user!current","evc_url_resource!current","evcmember!current","blurb!708473"]).spread(function(b,c,d,e){a[j]=b.member_id,a[m]=c.studyPlanUrls.SPGL,a[k]=d.enableGLRecord,a[l]=d.defaultGLRecordOption,a._record_hint=e&&e.translation||"",a.render()})},render:function(a){var b=this;if(b._started&&b._gl_credit&&b[i]&&b[j]){var c=g.call(b),e=b[i]+"_",f=null!==c&&c.substr(0,e.length)===e;return b.html(d,{hasRecord:b[k],recordChecked:b[l],recordDisabled:f,recordHint:b._record_hint}).then(function(){b.$element.find(".glyphicon-exclamation-sign").popover()})}},"hub:memory/studyplan/evc/gl/credit":function(a){var b=this;b._gl_credit=a,b.render()},"hub:memory/studyplan/evc/gl/start-time":function(a){var b=this;b[i]=a,b.render()},"hub:memory/studyplan/evc/gl/start-status":function(a){var b=this;b._started="started"===a,b.render()},"hub:memory/studyplan/evc/gl/topicId":function(a){this._topicID=a},"dom:.countdown-scoreboard-enter/click":function(){var a=this;c.useraction({"action.joinGL":a._topicID}),h.call(a,a[i]+"_"+a[l]),window.open(e.call(a,a._unitId),"_self")},"dom:.evc-studyplan-record-check/change":function(a){this[l]=a.currentTarget.checked}})}),define("school-ui-studyplan/widget/gl-pl/enter-class/pl",["troopjs-ef/component/widget","client-tracking","school-ui-studyplan/enum/studyplan-item-typecode","template!./enter-class.html"],function(a,b,c,d){function e(a){return this[f].replace("?","?showcontentonly=y&").replace("{source}",window.encodeURIComponent(window.location.href)).replace("{classId}",a)}var f="_pl_enter_url";return a.extend(function(a,b,c,d,e){var f=this;f._unitId=c,f._classId=d,f._spTypeCode=e},{"sig/start":function(){var a=this;return a.query("evc_url_resource!current").spread(function(b){a[f]=a._spTypeCode===c.pl20?b.studyPlanUrls.SPPL20Entering:b.studyPlanUrls.SPPL40Entering})},"hub:memory/studyplan/evc/pl/start-status":function(a){var b=this;"started"===a&&b.html(d)},"hub:memory/studyplan/evc/pl/status":function(a){this._topicId=a.topicId},"dom:.countdown-scoreboard-enter/click":function(){var a=this;a.publish("glpl-techcheck/trigger",!0).then(function(){b.useraction({"action.joinPL":a._topicId}),window.open(e.call(a,a._classId),"_self")})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/feedback-pending/index.html",[],function(){return function(a){var b="";return b+='\n<div class="text-center">\n    <p class="evc-studyplan-pedding-status" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568580"></p>\n    <p data-weave="troopjs-ef/blurb/widget" data-blurb-id="568582"></p>\n    <p data-weave="troopjs-ef/blurb/widget" data-blurb-id="568606"></p>\n</div>\n<style type="text/css">\n    .evc-studyplan-pedding-status{\n        font-size: 1.3em;\n        font-weight: bold;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/feedback-pending/main",["troopjs-browser/component/widget","jquery","template!./index.html"],function(a,b,c){"use strict";return a.extend({"sig/start":function(){this.html(c)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/feedback/index.html",[],function(){return function(a){var b="",c=a.url;return b+='\n<div class="evc-studyplan-btn-feedback text-center">\n    <p class="evc-studyplan-feedback-status" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568590"></p>\n    <p>\n        <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568591"></span>\n        <span>'+a.date+'</span>\n    </p>\n    <a href="'+c+'" class="btn btn-primary" role="button" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568592"></a>\n</div>\n<style type="text/css">\n    .evc-studyplan-btn-feedback{\n        margin-top: 20px;\n    }\n    .evc-studyplan-btn-feedback > a{\n        display: inline-block;\n    }\n    .evc-studyplan-feedback-status{\n        font-size: 1.3em;\n        font-weight: bold;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/feedback/main",["when","jquery","moment","school-ui-shared/enum/moment-language","troopjs-ef/component/widget","template!./index.html"],function(a,b,c,d,e,f){"use strict";return e.extend({"sig/start":function(){this._context_promise=a.defer()},"hub:memory/context":function(a){a&&this._context_promise.resolve([a])},render:function(a){var b=this;a&&b._context_promise.promise.spread(function(e){var g=c(new Date(a.year,a.month-1,a.day));g.lang(d[e.cultureCode.toLowerCase()]),b.html(f,{url:a.url,date:g.format("LL")})})}})}),define("school-ui-studyplan/widget/gl-pl/feedback/cp20",["jquery","./main","school-ui-studyplan/module"],function(a,b,c){"use strict";return b.extend({"hub:memory/studyplan/evc/cp20/status":function(a){var b=this;if(a&&a.feedback&&a.customizedStartTime){var c=a.feedback,d=a.customizedStartTime,e=d.year,f=d.month,g=d.day,h=c.feedbackId,i="/school/progressreport#teacher-feedback?fb_id=EVC_"+h;b.render({url:i,year:e,month:f,day:g})}}})}),define("school-ui-studyplan/widget/gl-pl/feedback/gl",["jquery","./main","school-ui-studyplan/module"],function(a,b,c){"use strict";return b.extend({"hub:memory/studyplan/evc/gl/status":function(a){var b=this;if(a&&a.feedback){var c=a.feedback,d=c.customizedEntryDate,e="/school/progressreport#teacher-feedback?fb_id=EVC_"+c.feedbackId,f=d.year,g=d.month,h=d.day;b.render({url:e,year:f,month:g,day:h})}}})}),define("school-ui-studyplan/widget/gl-pl/feedback/pl",["jquery","./main","school-ui-studyplan/module"],function(a,b,c){"use strict";return b.extend({"hub:memory/studyplan/evc/pl/status":function(a){var b=this;if(a&&a.feedback&&a.customizedStartTime){var c=a.feedback,d=a.customizedStartTime,e=d.year,f=d.month,g=d.day,h=c.feedbackId,i="/school/progressreport#teacher-feedback?fb_id=EVC_"+h;b.render({url:i,year:e,month:f,day:g})}}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/grouplesson/index.html",[],function(){return function(a){var b='<div class="st-evc-status" data-weave="school-ui-studyplan/widget/gl-pl/announcement/gl"></div>\n<div class="st-evc-status" data-weave="school-ui-studyplan/widget/gl-pl/statusbar/gl"></div>\n<div class="evc-studyplan-wrapper">\n    ';return"welcome"===a.statusCode?b+='\n        <div class="evc-studyplan-column-single evc-studyplan-welcome" data-weave="school-ui-studyplan/widget/gl-pl/welcome-gl/main"></div>\n    ':b+='\n        <div class="evc-studyplan-column-single">\n            <div class="evc-studyplan-gap-2x" data-weave="school-ui-studyplan/widget/gl-pl/lesson/gl"></div>\n            <div class="evc-studyplan-gap-1x evc-studyplan-class-info">\n            </div>\n        </div>\n        <div class="evc-studyplan-activity-container">\n        </div>\n    ',b+='\n</div>\n<style type="text/css">\n    .evc-studyplan-wrapper{\n        text-align: center;\n        padding: 30px 0 50px;\n        color: #4a4a4a;\n    }\n    .evc-studyplan-column-full{\n        display: inline-block;\n    }\n    .evc-studyplan-column-single{\n        display: inline-block;\n        width: 980px;\n    }\n    .evc-studyplan-column-single hr{\n        margin-bottom: 0;\n    }\n    .evc-studyplan-welcome{\n        width: 900px;\n        padding-top: 50px;\n    }\n    .evc-studyplan-gap-2x{\n        text-align: left;\n        width: 620px;\n        padding-left: 35px;\n        padding-right: 35px;\n        vertical-align: top;\n        display: inline-block;\n        margin: 20px auto;\n    }\n    .evc-studyplan-gap-1x{\n        text-align: left;\n        width: 330px;\n        vertical-align: top;\n        margin: auto;\n        padding-left: 30px;\n        display: inline-block;\n        border-left:1px #eee solid;\n    }\n    .evc-studyplan-gap-1x .evc-studyplan-gap-block{\n        margin-bottom: 15px;\n    }\n    .st-evc-status{\n        color: #4a4a4a;\n        background-color: #e6e6e6;\n    }\n    .evc-studyplan-gray{\n        color:#999999;\n    }\n    .evc-studyplan-green{\n        color:#87c600;\n    }\n    .evc-studyplan-blue{\n        color: #00bee3;\n    }\n    .evc-none{\n        display: none;\n    }\n    .evc-studyplan-activity-container {\n        width:880px;\n        margin:0 auto;\n    }\n    .evc-studyplan-activity-tc {\n        text-align: left;\n        padding-right: 330px;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/grouplesson/main",["when","jquery","moment","troopjs-ef/component/widget","school-ui-shared/enum/moment-language","school-ui-studyplan/module","school-ui-studyplan/utils/client-storage","template!./index.html"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,c,d){var e=this;return b("<div>").attr("data-weave",a+"(unitId)").addClass(d||"").data("unitId",e[q]).appendTo(e[j].find(c)).weave()}var j="$element",k=f.config().cacheServer+"/_imgs/evc/gl/topic/100x100/",l=f.config().cacheServer+"/_imgs/evc/gl/gl_default_100x100.jpg",m="school-ui-studyplan/widget/gl-pl/credit/gl",n=".evc-studyplan-activity-container",o="evc-studyplan-gap-2x text-center",p="evc-studyplan-gap-block",q="_unit_id";return d.extend(function(b,c,d){if(d||d.properties){var e=this;e.closeOptionalTips="closed"===g.getLocalStorage("gl_tips"),e._context_promise=a.defer()}},{"hub:memory/load/unit":function(a){var b=this;a&&a.legacyUnitId&&(b.unitId=a.legacyUnitId,b.publish("query",["member_site_setting!evc;FirstTimeStudyPlanGL"]).spread(function(a){a&&("true"===a.value.toString()?b.publish("studyplan/evc/gl/load"):b.html(h,{statusCode:"welcome"}))}))},"hub/studyplan/evc/techcheck/finished":function(){this.publish("studyplan/evc/gl/load")},"hub:memory/studyplan/evc/gl/start-status":function(a){var b=this;switch(a){case"notyet":b.publish("glpl-techcheck/show-desc",!1),b.$element.find(".ets-sp-glpl-techcheck").removeClass("ets-none"),b.$element.find(".ets-sp-glpl-enter-class").addClass("ets-none");break;case"incountdown":b.publish("glpl-techcheck/show-desc",!0),b.$element.find(".ets-sp-glpl-techcheck").removeClass("ets-none"),b.$element.find(".ets-sp-glpl-enter-class").addClass("ets-none");break;case"started":b.publish("glpl-techcheck/show-desc",!0),b.$element.find(".ets-sp-glpl-techcheck").toggleClass("ets-none","passed"===g.getSessionStorage("techcheck_state")),b.$element.find(".ets-sp-glpl-enter-class").toggleClass("ets-none","passed"!==g.getSessionStorage("techcheck_state"))}},"hub/studyplan/evc/gl/load":function(){var d=this;d[q]=d.unitId,d.publish("query",["glstatus!"+d.unitId,"glclass!"+d.unitId]).spread(function(f,q){if(f){var r=f.statusCode.toLowerCase(),s=f.feedback,t={unitId:d.unitId,statusCode:r,teacherId:s.teacherId||"",feedbackId:s.feedbackId||"",topic:{},feedback:s||{}};if("pending"===r||"attended"===r){var u=s.topic;u&&(t.topic={topic:u.topicBlurb,description:u.descriptionBlurb,image:k+u.topicImageUrl||l})}var v=q&&q.evcServerCode||"",w=v.toLowerCase().indexOf("evc")<0;w||g.setSessionStorage("techcheck_state","passed");var x=f;b.extend(!0,x,{unitId:d.unitId}),d.html(h,x).then(function(){if(d[j].find(".evc-studyplan-class-info").empty(),d[j].find(n).empty(),d.publish("studyplan/evc/gl/start-time",new Date(q.countDown.classStartTime||0).getTime()),d.publish("studyplan/evc/gl/status",t),d.publish("studyplan/evc/gl/start-status","notyet"),d.closeOptionalTips||d.publish("studyplan/evc/gl/notification",{statusCode:"optional_msg_gl"}),"dropout"===r){if(!s.entryDate)return;a.all([d._context_promise.promise,d.query("blurb!568599")]).spread(function(a,b){var f=a[0],g=c(s.entryDate);g.lang(e[f.cultureCode.toLowerCase()]);var h=b[0],i=h.translation;i=i.replace("%%date%%",g.format("YYYY-MM-DD")).replace("%%time%%",g.format("HH:mm")),d.publish("studyplan/evc/gl/notification",{statusCode:"leftearly",link:"http://www.ef.com",msg:i})})}switch(r.toLowerCase()){case"nevertake":case"dropout":i.call(d,"school-ui-studyplan/widget/gl-pl/countdown/gl",".evc-studyplan-class-info",p),i.call(d,"school-ui-studyplan/widget/gl-pl/class-status/gl",".evc-studyplan-class-info",p),w&&i.call(d,"school-ui-studyplan/widget/gl-pl/techcheck/main",".evc-studyplan-class-info",p+" ets-sp-glpl-techcheck"),i.call(d,"school-ui-studyplan/widget/gl-pl/enter-class/gl",".evc-studyplan-class-info",p+" ets-sp-glpl-enter-class ets-none"),i.call(d,m,n,p),i.call(d,"school-ui-studyplan/widget/gl-pl/terms-and-conditions/main",n,"evc-studyplan-activity-tc");break;case"pending":i.call(d,"school-ui-studyplan/widget/gl-pl/feedback-pending/main",n,o),i.call(d,m,n,p);break;case"attended":i.call(d,"school-ui-studyplan/widget/gl-pl/feedback/gl",n,o),i.call(d,m,n,p)}})}})},"hub:memory/context":function(a){a&&this._context_promise.resolve([a])}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/lesson/index.html",[],function(){return function(a){var b="",c=a.lessonInfo,d=a.profile;return b+='\n<div class="clearfix ',d&&(b+="evc-studyplan-withteacher"),b+='" >\n    <div class="pull-left evc-studyplan-topic-pic">\n        <img src="'+c.image+'" width="100" height="100" alt="" />\n        ',d&&(b+='\n            <div class="evc-studyplan-teacher">\n                ',d.link?b+='\n                    <a href="'+d.link+'" target="_blank">\n                        <img class="img-circle" src="'+d.imageUrl+'" width="42" height="42" alt="'+d.nickname+'">\n                    </a>\n                ':b+='\n                    <img class="img-circle" src="'+d.imageUrl+'" width="42" height="42" alt="'+d.nickname+'">\n                ',b+="\n            </div>\n        "),b+='\n    </div>\n    <div class="pull-left evc-studyplan-topic">\n        ',a.changeTopicTitle?b+='\n            <h5 data-weave="troopjs-ef/blurb/widget" data-blurb-id="490207"></h5>\n        ':b+='\n            <h5 data-weave="troopjs-ef/blurb/widget" data-blurb-id="80310"></h5>\n        ',b+='\n        <h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+c.topic+'"></h2>\n        ',d&&(b+='\n            <p><span data-weave="troopjs-ef/blurb/widget" data-blurb-id="78910"></span>&nbsp;<span>'+d.nickname+"</span></p>\n        "),b+='\n    </div>\n</div>\n<div class="evc-studyplan-description">\n    <p data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+c.description+'"></p>\n</div>\n\n<style type="text/css">\n    .evc-studyplan-withteacher {\n        padding-bottom: 14px;\n    }\n    .evc-studyplan-topic-pic {\n        position: relative;\n        width: 100px;\n        height: 100px;\n        margin-right: 20px;\n    }\n    .evc-studyplan-teacher {\n        position: absolute;\n        left: 72px;\n        top: 72px;\n        white-space: nowrap;\n    }\n    .evc-studyplan-teacher a {\n        display: inline-block;\n        text-decoration: none;\n    }\n    .evc-studyplan-teacher a:hover {\n        text-decoration: none;\n    }\n    .evc-studyplan-topic {\n        width: 420px;\n    }\n    .evc-studyplan-topic h5 {\n        margin-bottom: 5px;\n    }\n    .evc-studyplan-topic h2 {\n        margin-top: 0;\n        line-height: 1em;\n    }\n    .evc-studyplan-topic p {\n        font-size: 112%;\n        font-weight: bold;\n        vertical-align: middle;\n        margin-bottom: 0;\n        margin-top: 6px;\n    }\n    .evc-studyplan-description {\n        margin-top: 10px;\n        clear: both;\n        line-height: 1.55em;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/lesson/main",["troopjs-browser/component/widget","jquery","template!./index.html"],function(a,b,c){"use strict";return a.extend({render:function(a){var b=this
;a&&("https:"===window.location.protocol&&a.profile&&a.profile.imageUrl&&0===a.profile.imageUrl.indexOf("http://")&&(a.profile.imageUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkEzNzkzNzJDRDQ1MTFFNEJCQTBDRTQ3OUEzNjM5OEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkEzNzkzNzNDRDQ1MTFFNEJCQTBDRTQ3OUEzNjM5OEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2QTM3OTM3MENENDUxMUU0QkJBMENFNDc5QTM2Mzk4QSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2QTM3OTM3MUNENDUxMUU0QkJBMENFNDc5QTM2Mzk4QSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PjsNI60AAA0mSURBVHja7F13UBXd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"),b.html(c,a))}})}),define("school-ui-studyplan/widget/gl-pl/lesson/cp20",["jquery","./main","template!./index.html"],function(a,b,c){"use strict";return b.extend({"hub/studyplan/evc/cp20/status":function(a){var b=this;if(a){var c=a.status,d=c.statusCode,e="",f={};if(f.lessonInfo=a.lessonInfo,f.changeTopicTitle=!1,"attended"===d||"pending"===d){if(!a.feedback)return;e=a.feedback.teacherId,f.changeTopicTitle=!0}else if("booked"===d){if(!a.bookedClass)return;e=a.bookedClass.teacherId}e&&e>0?b.publish("query",["teacherprofile!"+e]).spread(function(a){a&&(f.profile={imageUrl:a.imageUrl,link:"",nickname:a.displayName},b.render(f))}):b.render(f)}}})}),define("school-ui-studyplan/widget/gl-pl/lesson/gl",["jquery","./main","../grouplesson/service"],function(a,b,c){"use strict";return b.extend({"hub/studyplan/evc/gl/status":function(a){var b=this;if(a&&a.statusCode&&a.unitId){var d,e,f=a.statusCode,g=a.unitId,h={};if(h.changeTopicTitle=!1,"pending"===f||"attended"===f){if(!a.topic)return;d=a.topic,e=a.teacherId,h.lessonInfo=d,h.changeTopicTitle=!0,e?b.publish("query",["teacherprofile!"+e]).spread(function(a){a&&(h.profile={imageUrl:a.imageUrl,link:a.pageUrl,nickname:a.displayName},b.render(h))}):b.render(h)}else new c(g).get().then(function(a){a&&a.lessonInfo&&(h.lessonInfo=a.lessonInfo,b.render(h),b.publish("studyplan/evc/gl/topicId",a.topicId))})}}})}),define("school-ui-studyplan/widget/gl-pl/lesson/pl",["jquery","./main","template!./index.html"],function(a,b,c){"use strict";return b.extend({"hub/studyplan/evc/pl/status":function(a){var b=this;if(a){var c=a.status,d=c.statusCode,e="",f={};if(f.lessonInfo=a.lessonInfo,f.changeTopicTitle=!1,"attended"===d||"pending"===d){if(!a.feedback)return;e=a.feedback.teacherId,f.changeTopicTitle=!0}else if("booked"===d){if(!a.bookedClass)return;e=a.bookedClass.teacherId}e&&e>0?b.publish("query",["teacherprofile!"+e]).spread(function(a){a&&(f.profile={imageUrl:a.imageUrl,link:a.pageUrl,nickname:a.displayName},b.render(f))}):b.render(f)}}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/mark/booked.html",[],function(){return function(a){return'<span class="badge evc-studyplan-mark evc-studyplan-mark-booked" data-weave="troopjs-ef/blurb/widget" data-text-en="Booked" data-blurb-id="78918"></span>\n<style type="text/css">\n    .evc-studyplan-mark-booked,\n    .gud .evc-studyplan-mark-booked\n    {\n        background-color: #232c33;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/mark/cp20",["troopjs-ef/component/widget","when","school-ui-shared/utils/console","template!./booked.html"],function(a,b,c,d){return a.extend(function(a,c,d){function e(a){a&&a.legacyUnitId&&(f.getUnit.resolver.resolve(a.legacyUnitId),f.unsubscribe("load/unit",e))}var f=this;f.getUnit=b.defer(),f.subscribe("load/unit",e),f.republish("load/unit",!1,e)},{"sig/start":function(){var a=this;return a.getUnit.promise.then(function(c){return a.publish("query",["checkpointstate!cp20;"+c]).spread(function(c){return c&&c.statusCode?"booked"!==c.statusCode.toLowerCase()?b.reject("skip CP20 mark, CP20 not booked."):void a.html(d):b.reject("skip CP20 mark, CP20 status query failed.")})})}})}),define("school-ui-studyplan/widget/gl-pl/mark/pl",["troopjs-ef/component/widget","when","school-ui-shared/utils/console","template!./booked.html"],function(a,b,c,d){return a.extend(function(a,c,d){function e(a){a&&a.legacyUnitId&&(f.getUnit.resolver.resolve(a.legacyUnitId),f.unsubscribe("load/unit",e))}var f=this;f.getUnit=b.defer(),f.subscribe("load/unit",e),f.republish("load/unit",!1,e)},{"sig/start":function(){var a=this;return a.getUnit.promise.then(function(c){return a.publish("query",["plclass!"+c]).spread(function(c){return c&&c.statusCode?"booked"!==c.statusCode.toLowerCase()?b.reject("skip PL mark, PL not booked."):void a.html(d):b.reject("skip PL mark, PL status query failed.")})})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/popupvideo/index.html",[],function(){return function(a){return'<div class="evc-studyplan-popup-video modal">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content">\n\t\t</div>\n\t\t<div class="close" data-dismiss="modal"></div>\n\t</div>\n</div>\n\n<style type="text/css">\n\t.evc-studyplan-popup-video .modal-dialog {\n\t\tpadding:0;\n\t\twidth:640px;\n\t\theight: 400px;\n\t}\n\t.evc-studyplan-popup-video .close {\n\t\tposition: absolute;\n\t\ttop: -14px;\n\t\tright: -24px;\n\t\twidth:35px;\n\t\theight:35px;\n\t\tbackground: url(data:image/png;base64,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) center top no-repeat;\n\t\t*background-image: url(/_imgs/evc/block/high/btn_close.png);\n\t\tfilter:none;\n\t}\n\t.evc-studyplan-popup-video .close:hover {\n\t\topacity: 1;\n\t\tfilter:none;\n\t}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/popupvideo/main",["jquery","jquery.gudstrap","jquery.mediaelement","troopjs-ef/component/widget","template!./index.html"],function(a,b,c,d,e){"use strict";return d.extend({"sig/start":function(){var b=this;return b._video_url=b.$element.data("videoUrl"),b.html(e).then(function(){var d=b.$element.find(".modal-content");a(".evc-studyplan-popup-video").on("shown.bs.modal",function(){var e=a("<video/>",{class:"ets-vp",width:"100%",height:"100%",type:"video/mp4",controls:"controls",src:b._video_url});e.appendTo(d.empty()),c.MediaElementPlayer(e,{pauseOtherPlayers:!0,alwaysShowControls:!0,startVolume:.8,features:["playpause","progress","current","duration","tracks","volume"],videoWidth:640,videoHeight:360,success:function(a,c,d){a.play(),b._media_element=a}})}),a(".evc-studyplan-popup-video").on("hide.bs.modal",function(){b._media_element.pause(),d.find("video")[0].player.remove()})})},"hub/studyplan/evc/welcome-video/show":function(){this.$element.find(".evc-studyplan-popup-video").modal()},"dom:.mejs-cover/click":function(){var a=this;!a._media_element.paused&&a._media_element.pause()}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/privatelesson/index.html",[],function(){return function(a){var b="",c=a.statusCode;a.unitId;return b+='\n<div class="st-evc-status" data-weave="school-ui-studyplan/widget/gl-pl/announcement/pl"></div>\n<div class="st-evc-status" data-weave="school-ui-studyplan/widget/gl-pl/statusbar/pl"></div>\n<div class="evc-studyplan-wrapper">\n    ',b+="welcome"===c?'\n        <div class="evc-studyplan-column-single evc-studyplan-welcome" data-weave="school-ui-studyplan/widget/gl-pl/welcome-pl/main"></div>\n    ':'\n        <div class="evc-studyplan-column-single">\n            <div class="evc-studyplan-gap-2x" data-weave="school-ui-studyplan/widget/gl-pl/lesson/pl"></div>\n            <div class="evc-studyplan-gap-1x evc-studyplan-class-info">\n            </div>\n        </div>\n        <div class="evc-studyplan-activity-container">\n        </div>\n    ',b+='\n</div>\n\n<div class="evc-ui-tck-waiting modal fade in" role="dialog" aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-body">\n                <div class="evc-ui-tck-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639585" data-text-en="Before entering class, let\'s check your microphone and audio."></div>\n                <div class="evc-ui-tck-sub-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639586" data-text-en="Wait just a moment while we check your sound system. We want to make sure you don\'t miss anything."></div>\n                <div class="evc-ui-tck-loading"></div>\n                <div class="evc-ui-tck-checking" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639587" data-text-en="We are checking your microphone and speakers. Please wait a second"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="modal-backdrop fade in hidden"></div>\n\n<style type="text/css">\n\n    .evc-studyplan-wrapper{\n        text-align: center;\n        padding: 30px 0 50px;\n        color: #4a4a4a;\n    }\n    .evc-studyplan-column-full{\n        display: inline-block;\n    }\n    .evc-studyplan-column-single{\n        display: inline-block;\n        width: 980px;\n    }\n    .evc-studyplan-column-single hr{\n        margin-bottom: 0;\n    }\n    .evc-studyplan-welcome{\n        width: 900px;\n        padding-top: 50px;\n    }\n    .evc-studyplan-gap-2x{\n        text-align: left;\n        width: 620px;\n        padding-left: 35px;\n        padding-right: 35px;\n        vertical-align: top;\n        display: inline-block;\n\t\tmargin: 20px auto;\n    }\n    .evc-studyplan-gap-1x{\n        text-align: left;\n        width: 330px;\n        vertical-align: top;\n        margin: auto;\n\t    padding-left: 30px;\n        display: inline-block;\n\t    border-left:1px #eee solid;\n    }\n    .evc-studyplan-gap-1x .evc-studyplan-gap-block{\n\t    margin-bottom: 15px;\n    }\n    .st-evc-status{\n        color: #4a4a4a;\n        background-color: #e6e6e6;\n    }\n    .evc-studyplan-gray{\n        color:#999999;\n    }\n    .evc-studyplan-green{\n        color:#87c600;\n    }\n    .evc-studyplan-blue{\n        color: #00bee3;\n    }\n    .evc-none{\n        display: none;\n    }\n    .gud .evc-ui-tck-waiting .modal-dialog{\n        position: absolute;\n        width: 920px;\n        left: 50%;\n        top:50%;\n        margin-left: -460px;\n        margin-top: -200px;\n    }\n    .evc-ui-tck-waiting .modal-body{\n        padding: 20px 20px 50px 20px;\n    }\n    .evc-ui-tck-waiting{\n        text-align: center;\n    }\n    .evc-ui-tck-waiting .evc-ui-tck-title {\n        font: italic bold 16px Georgia, Arial, sans-serif;\n        font-size: 18px;\n        font-weight: normal;\n        color: #262b31;\n        padding: 30px 0 10px 0;\n    }\n    .evc-ui-tck-waiting .evc-ui-tck-sub-title {\n        font-size: 14px;\n        color: #c4c4c4;\n        padding-bottom: 10px;\n    }\n    .evc-ui-tck-loading{\n        width: 32px;\n        height: 32px;\n        background:url(data:image/gif;base64,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);\n        margin: 30px auto;\n    }\n    .evc-studyplan-activity-container {\n\t    width:880px;\n\t    margin:0 auto;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/privatelesson/main",["troopjs-browser/component/widget","when","jquery","school-ui-studyplan/module","school-ui-studyplan/utils/client-storage","school-ui-studyplan/utils/time-parser","school-ui-studyplan/enum/studyplan-item-typecode","template!./index.html"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,b,d){var e=this,f=c("<div>");return a===j?f.attr("data-weave",a+"(unitId, classId, spTypeCode)").data("classId",e[p]):f.attr("data-weave",a+"(unitId, spTypeCode)"),f.addClass(d||"").data("unitId",e[o]).data("spTypeCode",e[s]).appendTo(e.$element.find(b)).weave()}var j="school-ui-studyplan/widget/gl-pl/enter-class/pl",k=".evc-studyplan-activity-container",l=".evc-studyplan-class-info",m="evc-studyplan-gap-2x text-center",n="evc-studyplan-gap-block",o="_unit_id",p="_class_id",q=d.config().cacheServer+"/_imgs/evc/pl/topic/100x100/",r=d.config().cacheServer+"/_imgs/evc/pl/pl_default_100x100.png",s="_type_code";return a.extend(function(a,b,c){var d=this;(c||c.properties)&&(d[s]=c.typeCode,d._widget_credit=d[s]===g.pl20?"school-ui-studyplan/widget/gl-pl/credit/sppl20":"school-ui-studyplan/widget/gl-pl/credit/pl",d.closeOptionalTips="closed"===e.getLocalStorage("pl_tips"))},{"hub:memory/load/unit":function(a){var b=this;a&&a.legacyUnitId&&(b.unitId=a.legacyUnitId,b.publish("query",["member_site_setting!evc;FirstTimeStudyPlanPL"]).spread(function(a){a&&("true"===a.value.toString()?b.publish("studyplan/evc/pl/load"):b.html(h,{unitId:b.unitId,statusCode:"welcome"}))}))},"hub/studyplan/evc/techcheck/finished":function(){this.publish("studyplan/evc/pl/load")},"hub:memory/studyplan/evc/pl/start-status":function(a){var b=this;switch(a){case"notyet":b.publish("glpl-techcheck/show-desc",!1),b.$element.find(".ets-sp-glpl-techcheck").removeClass("ets-none"),b.$element.find(".ets-sp-glpl-enter-class").addClass("ets-none");break;case"incountdown":b.publish("glpl-techcheck/show-desc",!0),b.$element.find(".ets-sp-glpl-techcheck").removeClass("ets-none"),b.$element.find(".ets-sp-glpl-enter-class").addClass("ets-none");break;case"started":b.publish("glpl-techcheck/show-desc",!0),b.$element.find(".ets-sp-glpl-techcheck").toggleClass("ets-none","passed"===e.getSessionStorage("techcheck_state")),b.$element.find(".ets-sp-glpl-enter-class").toggleClass("ets-none","passed"!==e.getSessionStorage("techcheck_state"))}},"hub/studyplan/evc/pl/load":function(){var a=this;a[o]=a.unitId,a.publish("query",["plclass!"+a.unitId]).spread(function(b){if(b&&b.topic&&b.statusCode){var c={},d=b.topic,g=b.statusCode.toLowerCase();if(c.status={statusCode:g},c.lessonInfo={topic:d.topicBlurb,description:d.descriptionBlurb,image:d.topicImageUrl?q+d.topicImageUrl:r},c.topicId=b.topic.topicId,"booked"===g||"attended"===g||"pending"===g){if(!b.bookedClass||!b.bookedClass.easternStartTime)return;var o=b.bookedClass;if(a[p]=o.classId,c.timezoneId=o.timezoneId,c.bookedClass={classId:o.classId,teacherId:o.teacherId},c.customizedStartTime=f.toLocalTime(o.easternStartTime,o.timeZoneOffset),"booked"===g){if(!o.easternSuggestedCancelTime||!b.countDown)return;var s=b.countDown;c.countdown={timeIn:s.secondsLeftForStart,timeOut:s.secondsLeftForEnter},c.suggestedCancelTime=f.toLocalTime(o.easternSuggestedCancelTime,o.timeZoneOffset)}else if("attended"===g||"pending"===g){if(!b.feedback)return;var t=b.feedback;c.feedback={feedbackId:t.feedbackId,teacherId:t.teacherId,entryDate:t.entryDate}}}a.html(h,{unitId:a.unitId,statusCode:g}).then(function(){a.$element.find(l).empty(),a.$element.find(k).empty();var d=a.$element.find(".modal-backdrop");a._$waiting=a.$element.find(".evc-ui-tck-waiting"),a._$waiting.on("show.bs.modal",function(){d.removeClass("hidden")}).on("hidden.bs.modal",function(){d.addClass("hidden"),a._timer_waiting&&clearTimeout(a._timer_waiting)}),a.publish("studyplan/evc/pl/status",c),a.publish("studyplan/evc/pl/start-status","notyet"),a.closeOptionalTips||a.publish("studyplan/evc/pl/notification",{statusCode:"optional_msg_pl"}),"dropout"===g&&a.publish("studyplan/evc/pl/notification",{statusCode:"missingclass"});var f=b.bookedClass&&b.bookedClass.evcServerCode||"",h=f.toLowerCase().indexOf("evc")<0;switch(h||e.setSessionStorage("techcheck_state","passed"),g.toLowerCase()){case"nevertake":case"dropout":i.call(a,"school-ui-studyplan/widget/gl-pl/book-pl/main",l,n),i.call(a,a._widget_credit,k,n);break;case"booked":i.call(a,"school-ui-studyplan/widget/gl-pl/countdown/pl",l,n),i.call(a,"school-ui-studyplan/widget/gl-pl/class-status/pl",l,n),h&&i.call(a,"school-ui-studyplan/widget/gl-pl/techcheck/main",l,n+" ets-sp-glpl-techcheck"),i.call(a,j,l,n+" ets-sp-glpl-enter-class ets-none"),i.call(a,"school-ui-studyplan/widget/gl-pl/cancel-pl/main",l,n),i.call(a,a._widget_credit,k,n);break;case"pending":i.call(a,"school-ui-studyplan/widget/gl-pl/feedback-pending/main",k,m),i.call(a,a._widget_credit,k,n);break;case"attended":i.call(a,"school-ui-studyplan/widget/gl-pl/feedback/pl",k,m),i.call(a,a._widget_credit,k,n)}})}})},"hub/studyplan/evc/techcheck/waiting/show":function(){var a=this;return b.promise(function(b){a._$waiting.modal({backdrop:"static"}),a._timer_waiting&&clearTimeout(a._timer_waiting),a._timer_waiting=setTimeout(function(){a._$waiting.modal("hide"),b()},3e3)})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/statusbar/index.html",[],function(){return function(a){var b="",c=a.statusCode,d=a.link||"";switch(b+="\n",b+="optional_msg_gl"===c?'\n    <div class="evc-studyplan-status-container evc-studyplan-status-optional-gl-container clearfix">\n':"optional_msg_pl"===c?'\n    <div class="evc-studyplan-status-container evc-studyplan-status-optional-pl-container clearfix">\n':'\n    <div class="evc-studyplan-status-container clearfix">\n',b+='\n    <hr>\n    <div class="evc-studyplan-status-tips">\n        ',c){case"leftearly":!function(){b+='\n    <h4 data-weave="troopjs-ef/blurb/widget" data-blurb-id="568598"></h4>\n    <p class="evc-studyplan-status-subline">\n        <span>'+a.msg+'</span><br>\n        <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568602"></span>\n    </p>\n'}();break;case"missingclass":!function(){b+='\n    <h4 data-weave="troopjs-ef/blurb/widget" data-blurb-id="568621"></h4>\n    <p class="evc-studyplan-status-subline">\n        <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568622"></span>\n        <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568602"></span>\n    </p>\n'}();break;case"no_coupon_pl":!function(){b+='\n    <h4 data-weave="troopjs-ef/blurb/widget" data-blurb-id="568594"></h4>\n    ',d&&(b+='\n        <p class="evc-studyplan-status-subline">\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568593"></span>\n            <strong>\n                <a href="'+d+'" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568595"></a>\n            </strong>\n\x3c!--             ',a.showSkip&&(b+='\n                <span data-blurb-id="101321" data-weave="troopjs-ef/blurb/widget">or</span>\n                <strong data-weave="school-ui-studyplan/widget/gl-pl/skip-pl/main"></strong>\n            '),b+=" --\x3e\n        </p>\n    "),b+="\n"}();break;case"no_coupon_gl":!function(){b+='\n    <h4 data-weave="troopjs-ef/blurb/widget" data-blurb-id="570577"></h4>\n    ',d&&(b+='\n        <p class="evc-studyplan-status-subline">\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="570578"></span>\n            <strong>\n                <a href="'+d+'" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568595"></a>\n            </strong>\n        </p>\n    '),b+="\n"}();break;case"optional_msg_gl":!function(){b+='\n    <button type="button" class="close" aria-hidden="true" data-action="closeGLOptionalMsg">&times;</button>\n    <h4 data-weave="troopjs-ef/blurb/widget" data-blurb-id="629827"></h4>\n    <p class="evc-studyplan-status-subline">\n        <span data-weave="school-ui-shared/widget/blurb" data-blurb-ccl="school.courseware.blurb.629828" data-blurb-id="629828" data-text-en="The Group Class is a great opportunity to practice your English, meet other students and get answers to your questions from one of our experienced teachers."></span>\n    </p>\n'}();break;case"optional_msg_pl":!function(){
b+='\n    <button type="button" class="close" aria-hidden="true" data-action="closePLOptionalMsg">&times;</button>\n    <h4 data-weave="troopjs-ef/blurb/widget" data-blurb-id="629827"></h4>\n    <p class="evc-studyplan-status-subline">\n        <span data-weave="school-ui-shared/widget/blurb" data-blurb-ccl="school.courseware.blurb.629829" data-blurb-id="629829" data-text-en="The Private Class is a great opportunity for you to practice and get feedback from one of our experienced teachers on what youâ€™ve just learned."></span>\n    </p>\n'}()}return b+="\n    </div>\n</div>\n\n",b+="\n\n",b+="\n\n",b+="\n\n",b+="\n\n",b+="\n\n",b+='\n\n<style type="text/css">\n    .evc-studyplan-status-container{\n        text-align: left;\n        width: 680px;\n        margin: 0 auto;\n    }\n    .evc-studyplan-status-container hr{\n        border-top-color: #bdbdbd;\n        margin: 0;\n    }\n    .evc-studyplan-status-tips{\n        margin: 15px 0;\n    }\n    .evc-studyplan-status-tips .evc-studyplan-status-subline {\n        font-size: 12px;\n        margin-top: 6px;\n    }\n    .evc-studyplan-status-tips .evc-studyplan-status-subline strong {\n        white-space: nowrap;\n        font-style: italic;\n    }\n    .evc-studyplan-status-tips .evc-studyplan-status-subline strong a{\n        cursor: pointer;\n    }\n    .evc-studyplan-status-tips button.close {\n        float: right;\n        padding: 0;\n        cursor: pointer;\n        background: transparent;\n        border: 0;\n        -webkit-appearance: none;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/statusbar/main",["troopjs-browser/component/widget","jquery","template!./index.html"],function(a,b,c){"use strict";return a.extend({render:function(a){var b=this;a&&b.append(c,a)},hideSeparateLine:function(){var a=this,b=a.$element,c=b.find("hr").eq(0);c.length>0&&c.hide()}})}),define("school-ui-studyplan/widget/gl-pl/statusbar/cp20",["./main","jquery","school-ui-studyplan/utils/client-storage","template!./index.html"],function(a,b,c,d){"use strict";return a.extend({"hub/studyplan/evc/cp20/notification":function(a){this.render(a)},"hub/studyplan/evc/cp20/announcement/disable":function(){this.hideSeparateLine()},"dom:[data-action = closePLOptionalMsg]/click":function(a){var b=this,d=b.$element;c.setLocalStorage("cp20_tips","closed"),d.find(".evc-studyplan-status-optional-pl-container").remove(),b.hideSeparateLine()}})}),define("school-ui-studyplan/widget/gl-pl/statusbar/gl",["./main","jquery","school-ui-studyplan/utils/client-storage","template!./index.html"],function(a,b,c,d){"use strict";return a.extend({"hub/studyplan/evc/gl/notification":function(a){this.render(a)},"hub/studyplan/evc/gl/announcement/disable":function(){this.hideSeparateLine()},"dom:[data-action = closeGLOptionalMsg]/click":function(a){var b=this,d=b.$element;c.setLocalStorage("gl_tips","closed"),d.find(".evc-studyplan-status-optional-gl-container").remove(),b.hideSeparateLine()}})}),define("school-ui-studyplan/widget/gl-pl/statusbar/pl",["./main","jquery","school-ui-studyplan/utils/client-storage","template!./index.html"],function(a,b,c,d){"use strict";return a.extend({"hub/studyplan/evc/pl/notification":function(a){this.render(a)},"hub/studyplan/evc/pl/announcement/disable":function(){this.hideSeparateLine()},"dom:[data-action = closePLOptionalMsg]/click":function(a){var b=this,d=b.$element;c.setLocalStorage("pl_tips","closed"),d.find(".evc-studyplan-status-optional-pl-container").remove(),b.hideSeparateLine()}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/techcheck/techcheck.html",[],function(){return function(a){return'<div class="ets-sp-glpl-techcheck-container">\n\t<div class="ets-sp-glpl-techcheck-desc" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656135" data-text-en="You can\'t enter the classroom until you complete technology check."></div>\n\t<button class="btn btn-primary" data-action="startCheck" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656136" data-text-en="Complete technology check"></button>\n</div>\n\n<style type="text/css">\n\t.ets-sp-glpl-techcheck-container {\n\t}\n\t.ets-sp-glpl-techcheck-container .ets-sp-glpl-techcheck-desc {\n\t\tmargin: 15px 0;\n\t\tcolor: #999;\n\t}\n\n\t.ets-sp-glpl-techcheck-container .btn {\n\t\tfont-family: "roboto_condensedbold", "Helvetica Neue", Helvetica, Arial, sans-serif;\n\t\ttext-transform: uppercase;\n\t}\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/techcheck/main",["troopjs-ef/component/widget","troopjs-core/pubsub/hub","jquery","when","school-ui-studyplan/utils/client-storage","school-ui-shared/utils/hub-memory","template!./techcheck.html"],function(a,b,c,d,e,f,g){"use strict";function h(){return"passed"===e.getSessionStorage("techcheck_state")}function i(){var a=this;return!h()&&a[j]?a.publish("tech-check/request",[{id:"flash-install"},{id:"flash-setting",reload:!1},{id:"chrome-auth"},{id:"check-audio"}],{flashPath:k+a[j]+l}).then(function(){e.setSessionStorage("techcheck_state","passed"),e.setSessionStorage("legacy_techcheck_state",!0),a.publish("studyplan/evc/techcheck/finished")}).catch(function(a){if("cancel techcheck"!==a)throw a}):d.resolve()}var j="_classroom_host",k="//",l="/techcheck{version,-}/default/techcheck-{version}.swf";return a.extend({"sig/initialize":function(){var a=this;if(a._techcheckStarted=!1,a._techcheck_enable=f.readMemory("plugins/tech-check/enable"),!h()&&a._techcheck_enable)return a.query("ccl!'evc.classroom.host'").spread(function(b){return a[j]=b&&b.value,a.html(g)})},"hub/glpl-techcheck/trigger":function(a){var b=this;return!h()&&b._techcheck_enable?d(a&&b.publish("studyplan/evc/techcheck/waiting/show")).then(function(){return i.call(b)}):d.resolve()},"hub:memory/glpl-techcheck/show-desc":function(a){this.$element.find(".ets-sp-glpl-techcheck-desc").toggleClass("ets-none",!a)},"dom:[data-action='startCheck']/click":function(){var a=this;a._techcheckStarted||(a._techcheckStarted=!0,i.call(a).ensure(function(){a._techcheckStarted=!1}))}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/terms-and-conditions/main.html",[],function(){return function(a){return'<p data-blurb-id="708942" data-text-en=""\n\tdata-pattern="\\*{3}([^*]+)\\*{3}"\n\tdata-weave="troopjs-ef/blurb/widget">\n\t<a href="javascript:void(0);" data-value-name="Terms and Conditions"\n\t\tdata-blurb-id="685505"\n\t\tdata-weave-delay="troopjs-ef/blurb/widget"\n\t\tdata-toggle="modal" data-target="#teamsAndConditions"></a>\n</p>\n\x3c!-- Modal --\x3e\n<div class="ets-sp-modal-tc modal fade" id="teamsAndConditions" tabindex="-1" role="dialog" aria-labelledby="teamsAndConditionsLabel" aria-hidden="true">\n\t<div class="modal-dialog" role="document">\n\t\t<div class="modal-content">\n\t\t\t<div class="modal-header">\n\t\t\t\t<h5 class="modal-title"\n\t\t\t\t\tid="teamsAndConditionsLabel"\n\t\t\t\t\tdata-weave="troopjs-ef/blurb/widget"\n\t\t\t\t\tdata-blurb-id="685505"\n\t\t\t\t\tdata-value-name="Terms and Conditions"\n\t\t\t\t></h5>\n\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close">\n\t\t\t\t\t<span aria-hidden="true">&times;</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="modal-body"\n\t\t\t\tdata-blurb-id="708943"\n\t\t\t\tdata-weave="troopjs-ef/blurb/widget">\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'}}),define("school-ui-studyplan/widget/gl-pl/terms-and-conditions/main",["troopjs-ef/component/widget","template!./main.html","jquery.gudstrap"],function(a,b){return a.extend({"sig/start":function(){this.html(b)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/welcome-cp20/index.html",[],function(){return function(a){var b='<div class="clearfix row">\n    <div class="evc-studyplan-welcome-content">\n        <h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="568614"></h2>\n        <p class="evc-studyplan-welcome-content-des">\n            <span data-weave="school-ui-shared/widget/blurb" data-blurb-ccl="school.courseware.blurb.568615" data-blurb-id="568615" data-text-en="In the private class you learn English with your own private teacher."></span><br>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568616"></span>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568617"></span><br>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568618"></span>\n        </p>\n        <p>\n            <button type="button" class="btn btn-primary" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568611" data-action="getStart"></button>\n        </p>\n    </div>\n    <div class="evc-studyplan-welcome-image">\n        ';return a.video?b+='\n            <a href="" data-action="showVideo">\n                <img src="'+a.cacheServer+'/_imgs/evc/pl/studyplan/video.jpg">\n            </a>\n            <p class="evc-studyplan-welcome-video-description" data-weave="troopjs-ef/blurb/widget" data-blurb-id="569775"></p>\n            <div data-weave="school-ui-studyplan/widget/gl-pl/popupvideo/main" data-video-url="'+a.video+'"></div>\n        ':a.image&&(b+='\n            <img src="'+a.image+'">\n        '),b+='\n    </div>\n</div>\n\n<style type="text/css">\n    .evc-studyplan-welcome-content{\n        text-align: left;\n        float: left;\n        width: 510px;\n        padding: 0 15px;\n    }\n    .evc-studyplan-welcome-content > p{\n        margin-top: 30px;\n    }\n    .evc-studyplan-welcome-content-des{\n        line-height: 1.7em;\n    }\n    .evc-studyplan-welcome-image{\n        float: right;\n        padding: 0 30px 0 15px;\n        width: 375px;\n    }\n    .evc-studyplan-welcome-image > a{\n        display: inline-block;\n        margin-top: 7px;\n        margin-bottom: 10px;\n    }\n    .evc-studyplan-welcome-video-description {\n        font-style: italic;\n        text-align: center;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/welcome-cp20/main",["jquery","troopjs-ef/component/widget","school-ui-studyplan/module","template!./index.html"],function(a,b,c,d){"use strict";return b.extend({"sig/start":function(){var a=this;a.query("ccl!'school.studyplan.cp20.intro.media'").spread(function(b){a.query(b.value).spread(function(b){var e=/\.jpg$|\.png$|\.gif$/i.test(b.url);a.html(d,{cacheServer:c.config().cacheServer,image:e&&b.url,video:!e&&b.url})})})},"dom:[data-action = getStart]/click":function(a){a.preventDefault();var b=this;b.publish("school/member_site_setting/Save",{siteArea:"evc",keyCode:"FirstTimeStudyPlanCP20",keyValue:"true"}).spread(function(){b.publish("studyplan/evc/cp20/load")})},"dom:[data-action = showVideo]/click":function(a){a.preventDefault(),this.publish("studyplan/evc/welcome-video/show")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/welcome-gl/index.html",[],function(){return function(a){var b='<div class="clearfix row">\n    <div class="evc-studyplan-welcome-content">\n        <h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="568607"></h2>\n        <p class="evc-studyplan-welcome-content-des">\n            <span data-weave="school-ui-shared/widget/blurb" data-blurb-ccl="school.courseware.blurb.568608" data-blurb-id="568608" data-text-en="In the conversation class you practice your spoken English together with other students."></span><br>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568609"></span>\n        </p>\n        <p>\n            <button type="button" class="btn btn-primary" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568611" data-action="getStart"></button>\n        </p>\n    </div>\n    <div class="evc-studyplan-welcome-image">\n        ';return a.video?b+='\n            <a href="" data-action="showVideo">\n                <img src="'+a.cacheServer+'/_imgs/evc/gl/studyplan/video.jpg">\n            </a>\n            <p class="evc-studyplan-welcome-video-description" data-weave="troopjs-ef/blurb/widget" data-blurb-id="569776"></p>\n            <div data-weave="school-ui-studyplan/widget/gl-pl/popupvideo/main" data-video-url="'+a.video+'"></div>\n        ':a.image&&(b+='\n            <img src="'+a.image+'">\n        '),b+='\n    </div>\n</div>\n\n<style type="text/css">\n    .evc-studyplan-welcome-content{\n        text-align: left;\n        float: left;\n        width: 510px;\n        padding: 0 15px;\n    }\n    .evc-studyplan-welcome-content > p{\n        margin-top: 30px;\n    }\n    .evc-studyplan-welcome-content-des{\n        line-height: 1.7em;\n    }\n    .evc-studyplan-welcome-image{\n        float: right;\n        padding: 0 30px 0 15px;\n        width: 375px;\n    }\n    .evc-studyplan-welcome-image > a{\n        display: inline-block;\n        margin-top: 7px;\n        margin-bottom: 10px;\n    }\n    .evc-studyplan-welcome-video-description {\n        font-style: italic;\n        text-align: center;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/welcome-gl/main",["jquery","troopjs-ef/component/widget","school-ui-studyplan/module","template!./index.html"],function(a,b,c,d){"use strict";return b.extend({"sig/start":function(){var a=this;a.query("ccl!'school.studyplan.gl.intro.media'").spread(function(b){a.query(b.value).spread(function(b){var e=/\.jpg$|\.png$|\.gif$/i.test(b.url);a.html(d,{cacheServer:c.config().cacheServer,image:e&&b.url,video:!e&&b.url})})})},"dom:[data-action = getStart]/click":function(a){a.preventDefault();var b=this;b.publish("school/member_site_setting/Save",{siteArea:"evc",keyCode:"FirstTimeStudyPlanGL",keyValue:"true"}).spread(function(){b.publish("studyplan/evc/gl/load")})},"dom:[data-action = showVideo]/click":function(a){a.preventDefault(),this.publish("studyplan/evc/welcome-video/show")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/gl-pl/welcome-pl/index.html",[],function(){return function(a){var b='<div class="clearfix row">\n    <div class="evc-studyplan-welcome-content">\n        <h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="568614"></h2>\n        <p class="evc-studyplan-welcome-content-des">\n            <span data-weave="school-ui-shared/widget/blurb" data-blurb-ccl="school.courseware.blurb.568615" data-blurb-id="568615" data-text-en="In the private class you learn English with your own private teacher."></span><br>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568616"></span>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568617"></span><br>\n            <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="568618"></span>\n        </p>\n        <p>\n            <button type="button" class="btn btn-primary" data-weave="troopjs-ef/blurb/widget" data-blurb-id="568611" data-action="getStart"></button>\n        </p>\n    </div>\n    <div class="evc-studyplan-welcome-image">\n        ';return a.video?b+='\n            <a href="" data-action="showVideo">\n                <img src="'+a.cacheServer+'/_imgs/evc/pl/studyplan/video.jpg">\n            </a>\n            <p class="evc-studyplan-welcome-video-description" data-weave="troopjs-ef/blurb/widget" data-blurb-id="569775"></p>\n            <div data-weave="school-ui-studyplan/widget/gl-pl/popupvideo/main" data-video-url="'+a.video+'"></div>\n        ':a.image&&(b+='\n            <img src="'+a.image+'">\n        '),b+='\n    </div>\n</div>\n\n<style type="text/css">\n    .evc-studyplan-welcome-content{\n        text-align: left;\n        float: left;\n        width: 510px;\n        padding: 0 15px;\n    }\n    .evc-studyplan-welcome-content > p{\n        margin-top: 30px;\n    }\n    .evc-studyplan-welcome-content-des{\n        line-height: 1.7em;\n    }\n    .evc-studyplan-welcome-image{\n        float: right;\n        padding: 0 30px 0 15px;\n        width: 375px;\n    }\n    .evc-studyplan-welcome-image > a{\n        display: inline-block;\n        margin-top: 7px;\n        margin-bottom: 10px;\n    }\n    .evc-studyplan-welcome-video-description {\n        font-style: italic;\n        text-align: center;\n    }\n</style>'}}),define("school-ui-studyplan/widget/gl-pl/welcome-pl/main",["jquery","troopjs-ef/component/widget","school-ui-studyplan/module","template!./index.html"],function(a,b,c,d){"use strict";return b.extend({"sig/start":function(){var a=this;a.query("ccl!'school.studyplan.pl.intro.media'").spread(function(b){a.query(b.value).spread(function(b){var e=/\.jpg$|\.png$|\.gif$/i.test(b.url);a.html(d,{cacheServer:c.config().cacheServer,image:e&&b.url,video:!e&&b.url})})})},"dom:[data-action = getStart]/click":function(a){a.preventDefault();var b=this;b.publish("school/member_site_setting/Save",{siteArea:"evc",keyCode:"FirstTimeStudyPlanPL",keyValue:"true"}).spread(function(){b.publish("studyplan/evc/pl/load")})},"dom:[data-action = showVideo]/click":function(a){a.preventDefault(),this.publish("studyplan/evc/welcome-video/show")}})}),define("school-ui-studyplan/widget/initialization/hash-preview",["jquery","when","troopjs-ef/component/widget","poly"],function(a,b,c,d){"use strict";return c.extend({"hub/school/interface/get/activity-container/closeHash":function(){return[{prefix:"preview",studyplan:0,studyplan_item:0}]}})}),define("school-ui-studyplan/widget/initialization/hash",["jquery","when","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/state-parser","school-ui-studyplan/enum/studyplan-mode","school-ui-studyplan/enum/studyplan-velocity","poly"],function(a,b,c,d,e,f,g,h){"use strict";function i(){var a=this;a[n]&&a[o]&&"school"==a[r]&&a.query("campus_student_unit_studyplan!"+a[n]+".studyPlan.items,.studyPlan.progress").spread(function(b){var c,e=b.studyPlan.id,g=b.studyPlan,h=[];b.mode===f.Study?(g.items.forEach(function(a,b){"lesson"==a.typeCode?h.push("pc_student_lesson_map!"+a.properties.templateLessonId):h.push(m)}),a.query(h).spread(function(){Array.prototype.forEach.call(arguments,function(b,d){b&&b.lesson&&b.lesson.templateLessonId===a[o]&&(c=g.items[d].id)}),c?a[q]||a[p]?(a[s]=d.parseId(e),a[t]=d.parseId(c)):a[o]&&a.publish("load",{prefix:w,studyplan:d.parseId(e),studyplan_item:d.parseId(c)}):k.call(a,x+a[n])})):window.location.search.indexOf("unlock")<0&&k.call(a,x+a[n])})}function j(a){var b=this,c="campus_student_unit_studyplan!"+a+".studyPlan";b.query(c+".items").spread(function(a){return a.mode===f.Study?b.query(c+".progress"):[a]}).spread(function(a){var c=a.studyPlan,e=d.parseId(c.id);switch(a.mode){case f.Create:b.publish("load",{prefix:v,unit:x+c.properties.templateUnitId});break;case f.Locked:b.publish("load",{prefix:w,studyplan:e,studyplan_item:m});break;case f.Study:var g=c.items.filter(function(a){return c.progress&&a.itemIndex===c.progress.properties.suggestedItemIndex}),h=g.length?g[0]:c.items[0],i=d.parseId(h.id);b.publish("load",{prefix:w,studyplan:e,studyplan_item:i})}})}function k(a){this.publish("load",{prefix:v,unit:a,step:m})}function l(a,b,c){var e=this;if(b&&c&&a&&"2.0"===a.version)switch(b){case v:e.query("campus_student_unit_studyplan!"+c.unit.templateUnitId+".studyPlan.items,.studyPlan.progress").spread(function(a){var b=a.studyPlan;if(a.mode!==f.Create){var c=b.items.filter(function(a){return b.progress&&b.progress.properties&&a.itemIndex===b.progress.properties.suggestedItemIndex}),g=c.length?c[0]:b.items[0];e.publish("load",{prefix:"study",studyplan:d.parseId(b.id),studyplan_item:a.mode===f.Locked?m:d.parseId(g.id)})}});break;case w:c.studyplan?c.studyplan&&!c.studyplan_item?c.unit_studyplan.mode===f.Study&&j.call(e,c.studyplan.properties.templateUnitId):c.studyplan&&c.studyplan_item&&("goal"!==c.studyplan_item.typeCode?e.query(c.studyplan.id+".progress").spread(function(a){if(g.Crashed===a.progress.properties.velocity){var b;a.items.forEach(function(a){"goal"===a.typeCode&&(b=d.parseId(a.id))}),e.publish("load",{studyplan_item:b})}}):e[u]&&e[u].studyplan&&e[u].studyplan.id===c.studyplan.id&&e.publish("studyplan/sequence/update")):j.call(e,"current")}e[u]=c}var m,n="template_unit_id",o="template_lesson_id",p="step_id",q="activity_id",r="prefix",s="studyplan_id",t="studyplan_item_id",u="results",v="config",w="study",x="template_unit;";return c.extend({"hub:memory/context":function(a,b,c){var d=this;l.call(d,d.platformVersion=c,d[r],d[u])},"hub:memory/load/prefix":function(a){var b=this;b[r]=a,i.call(b)},"hub:memory/load/unit":function(a){var b=this;a&&(b.unit_id=d.parseId(a.id),b[n]=a.templateUnitId,i.call(b))},"hub:memory/load/lesson":function(a){var b=this;a&&(b.lesson_id=d.parseId(a.id),b[o]=a.templateLessonId,i.call(b))},"hub:memory/load/step":function(a){var b=this;a&&(b[p]=d.parseId(a.id))},"hub:memory/load/activity":function(a){var b=this;a&&(b[q]=d.parseId(a.id))},"hub:memory/load/studyplan":function(a){var b=this;a&&(b[s]=d.parseId(a.id))},"hub:memory/load/studyplan_item":function(a){var b=this;a&&(b[t]=d.parseId(a.id))},"hub:memory/route":function(a){var b=this,c=b[r];b[r]=a.path?a.path[0]:w,c!==b[r]&&l.call(b,b.platformVersion,b[r],b[u])},"hub/enrollment/update":function(){return this.publish("load",{studyplan:m,studyplan_item:m,command:m,prefix:m,unit:m})},"hub:memory/load/results":function(a){var b=this;a&&l.call(b,b.platformVersion,b[r]=a.prefix,a)},"hub:memory/load/config":function(a){var b=this;j.call(b,a)},"hub/school/interface/get/activity-container/closeHash":function(){var a=this;return[{prefix:w,studyplan:a[s],studyplan_item:a[t]}]}})}),define("troopjs-requirejs/multiversion",[],function(){"use strict";var a=/(.+?)#(.+)$/,b=require.s.contexts;return{load:function(c,d,e){var f,g;null!==(g=a.exec(c))&&(c=g[1],(f=g[2])in b&&(d=b[f].require)),d([c],function(a){e(a)},e.error)}}}),define("troopjs-requirejs/template!school-ui-studyplan/widget/initialization/initialization.html",[],function(){return function(a){return'<div class="ets-sp-init-container">\n\t<div class="ets-sp-study" data-weave="school-ui-studyplan/widget/studyplan/main"></div>\n</div>\n<div class="ets-sp-loading ets-none">\n\t<div class="ets-inner">\n\t\t<div class="ets-inner-cell">\n\t\t\t<div class="ets-icon">\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="ets-backdrop"></div>\n</div>\n<div data-weave="school-ui-shared/plugins/http-request-handling/main"></div>'}}),define("school-ui-studyplan/widget/initialization/main",["when","logger","poly","jquery","client-tracking","mv!jquery#troopjs-1.0","troopjs-ef/component/widget","troopjs-browser/loom/config","troopjs-browser/loom/weave","school-ui-shared/enum/course-type","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/server-time","school-ui-shared/plugins/techcheck/techcheck-render","template!./initialization.html"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";return g.extend(function(){this._page_context_data={}},{"hub:memory/context":function(a,b,c){var d=this;"2.0"===c.version&&(d._rendered||d.query("ccl!'school.activity.interaction.sampleRate'").spread(function(b){var c=parseFloat(b.value);d._isSample=a.user.member_id%100<100*c,d.html(n).then(function(){d._rendered=!0,f("[data-weave-1]").each(function(a,b){var c=f(b);c.attr("data-weave",c.attr("data-weave-1")).weave()})})}))},"hub:memory/logger/troopjs1":function(a){this._isSample&&b.log(a)},"hub:memory/load/results":function(a){var b,c=this,d={unitID:"null",levelID:"null",lessonID:"null"};Object.keys(a).forEach(function(b){var c=a[b];if(c)switch(b){case"level":c.templateLevelId&&(d.levelID=c.templateLevelId);break;case"unit":c.templateUnitId&&(d.unitID=c.templateUnitId);break;case"lesson":c.templateLessonId&&(d.lessonID=c.templateLessonId)}}),Object.keys(d).forEach(function(a){b=b||d[a]!==c._page_context_data["page."+a],c._page_context_data["page."+a]=d[a]}),b&&e.usercontext(c._page_context_data)},"hub/school/toggle/overflow":function(a){d("html").css("overflow",a)},"hub:memory/school/spinner":function(a){this.task(function(b,c,d){return a.then(b,c,d)})},"hub/tracking/useraction":function(a){e.useraction(a)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/migration/main.html",[],function(){return function(a){return'<div class="modal fade ets-sp-migration-progress-modal" data-backdrop="static">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content">\n\t\t\t<div class="modal-body">\n\t\t\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="660194" data-text-en="We are upgrading your school to the latest version, this might take a few seconds. Please don\'t leave this page until the upgrade is complated."></p>\n\t\t\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="660195" data-text-en="Thank you for your patience!"></p>\n\t\t\t\t<div class="progress progress-striped active">\n\t\t\t\t\t<div class="progress-bar" role="progressbar">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="modal fade ets-sp-migration-fail-modal" data-backdrop="static">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content">\n\t\t\t<div class="modal-body">\n\t\t\t\t<p><span class="glyphicon glyphicon-remove"></span></p>\n\t\t\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="660196" data-text-en="Oops! Something went wrong during the upgrade of your school. We apologise for the inconvenience, please contact customer support."></p>\n\t\t\t\t<p><a href="/customerservice/contactus/inschool"><span data-weave="troopjs-ef/blurb/widget" data-blurb-id="660199" data-text-en="contact customer support"></span></a></p>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="modal-backdrop fade in hidden"></div>'}}),define("school-ui-studyplan/widget/migration/main",["jquery","jquery.gudstrap","troopjs-ef/component/widget","school-ui-shared/utils/update-helper","template!./main.html"],function(a,b,c,d,e){"use strict";function f(){this[m].find(r).modal("hide")}function g(a){var b=this;i.call(b,t).find(s).width(a-5+"%").text(a+"%"),100===a&&j()}function h(){var a=this;i.call(a,u)}function i(a){var b=this,c=b[m].find(a);return c.on("show.bs.modal",function(a){b[m].find(".modal-backdrop").removeClass("hidden")}).on("hidden.bs.modal",function(a){b[m].find(".modal-backdrop").addClass("hidden")}),c.hasClass("in")||(f.call(b),c.modal({keyboard:!1})),c}function j(){window.open(q,"_self")}function k(){var a=this;a[n]>=p?h.call(a):d.platformMigrate().then(function(b){switch(a[n]++,b.response){case"DONE":j();break;case"OK":l.call(a);break;case"ERROR":h.call(a);break;case"RETRY":k.call(a);break;default:h.call(a)}})}function l(){var a=this,b=function(){window.setTimeout(function(){l.call(a)},o)};a.query("platform_migration!current").spread(function(c){switch(c.status){case"":k.call(a);break;case"QUEUED":case"STARTED":g.call(a,c.progress),b();break;case"TIMEOUT":case"CONFLICTED":case"ERROR":h.call(a);break;case"DONE":g.call(a,100);break;case"CANCELLED":case"RESET":k.call(a);break;default:h.call(a)}})}var m="$element",n="_retry",o=100,p=3,q="/school/course/currentcourse/handler.aspx",r=".modal",s=".progress-bar",t=".ets-sp-migration-progress-modal",u=".ets-sp-migration-fail-modal";return c.extend({"hub:memory/context":function(a,b,c){var d=this;if("1.0"===c.version)return d.html(e).then(function(){d[n]=0,l.call(d)})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/config/config.html",[],function(){return function(a){var b="";a.unit;return b+='\n<div class="ets-sp-cfg">\n\t<div class="ets-sp-cfg-hd">\n\t\t<h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="656054" data-text-en="set up unit plan"></h2>\n\t\t<h5 data-weave="troopjs-ef/blurb/widget" data-blurb-id="656055" data-text-en="Estimated 6 hours to complete the unit"></h5>\n\t</div>\n\t<div class="ets-sp-cfg-bd">\n        <div data-weave="school-ui-studyplan/shared/pace-config/main" data-mode="'+a.mode+"\" data-config='"+JSON.stringify(a.properties).replace(/\'/g,"&#39;")+'\'></div>\n\t</div>\n\t<div class="ets-sp-cfg-ft">\n\t\t<button type="button" class="btn btn-primary btn-m btn-block ets-sp-cfg-create"><span data-weave="troopjs-ef/blurb/widget" data-blurb-id="656059" data-text-en="Let\'s go"></span> <i class="glyphicon icon-caret-right"></i></button>\n\t</div>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/config/main",["jquery","poly","json2","moment","when","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/studyplan-update-helper","school-ui-studyplan/enum/studyplan-mode","school-ui-shared/enum/moment-language","template!./config.html"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(b,c){var d=this,e={};if(b&&c){e.unit=b;var f=d[n]=a.extend(!0,{},c.studyPlan);return c.mode===i.Create?(f.items.forEach(function(a){"goal"===a.typeCode&&(d[o]=a,e.properties=a.properties)}),d.query('ccl!"school.studyplan.pace.mode"','member_site_setting!"school;studyplan.newui.enabled"').spread(function(a,b){return e.mode=a.value,"view"===a.value&&m(e.properties.paces),"true"===b.value?h.createStudyplan({studentStudyPlanTemplate:f}).then(function(a){var b=a.id;return d.publish("school/clearCache",c.id).then(function(){d.publish("load",{prefix:"study",studyplan:g.parseId(b)})})}):d.html(k,e)})):void 0}}function m(a){for(var b=0,c=a.length;b<c;b++){var d=a[b];p in d&&(d[p]=!1)}return a[c-1][p]=!0,a}var n="_studyplan_template",o="_goal",p="selected";return f.extend({"hub:memory/load/unit":function(a){var b=this;a&&l.call(b,b._unit=a,b._unit_studyplan)},"hub:memory/load/unit_studyplan":function(a){var b=this;a&&l.call(b,b._unit,b._unit_studyplan=a)},"hub/config/pace-change":function(a){this[o].properties.paces=a},"dom:.ets-sp-cfg-create/click":function(b){var d=this;d[o].properties.paces.every(function(a){return!a.selected})&&(d.log("Studyplan exception when creating, goal properties is : "+c.stringify(d[o].properties)),d[o].properties.paces[0].selected=!0),a(b.currentTarget).prop("disabled",!0);var e=d._unit_studyplan;h.createStudyplan({studentStudyPlanTemplate:d[n]}).then(function(a){var b=a.id;d.publish("context/update/context").then(function(){return d.publish("school/clearCache",e.id)}).then(function(){d.publish("load",{prefix:"study",studyplan:g.parseId(b)})})})}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/course-target/progress-state-engage",{NotStarted:0,Started:1,Completed:2,PreviouslyPassed:128}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/course-target/BE-target",["troopjs-core/component/factory","./progress-state-engage","lodash"],function(a,b,c){"use strict";function d(a,b){return function(c){return c[a]===Number(b)}}function e(a){return this&a}function f(a){return p.call(a.progress.state)}function g(a){return q.call(a.progress.state)}function h(a){return r.call(a.progress.state)}function i(a){return!f(a)}function j(a){return!c.every(a.children,h)}function k(a,b){var d={};return d[a]=b,c.assign(this,d)}function l(a){return isNaN(a)?0:a}function m(a,b){return function(d){return c.indexOf(b,d[a])>-1}}function n(a,b){var d=c.invert(b);return function(b,c){var e=d[b[a]],f=d[c[a]];return e&&f?e-f:e?-1:f?1:0}}var o=c.partial(d,"legacyUnitId"),p=c.partial(e,b.Completed),q=c.partial(e,b.Started),r=c.partial(e,b.PreviouslyPassed),s=c.partial(k,"priority"),t=c.partial(m,"templateLevelId"),u=c.partial(n,"templateLevelId");return a(function(a,b){var c=this;c.studyTarget=a,c.studyProgress=b,c.progress=b.children,c.recommendedUnit=c.studyTarget.businessEnglishRecommendedUnit,c.currentUnitId=c.studyTarget.currentUnitId,c.multiple=3,c.count=Math.ceil(c.studyTarget.businessSpinTarget/c.multiple),c.count=Math.max(1,c.count),c.count=Math.min(c.progress.length,c.count),c.expectedUnitCount=c.studyTarget.businessSpinTarget,c.lastTargetsNodeId=c.studyTarget.BusinessEnglishTopics,c.targetCompleted=!1},{getTarget:function(){var a=this,b=[];if(c.isArray(a.lastTargetsNodeId)){var d=c.filter(a.progress,t(a.lastTargetsNodeId));if(c.chain(d).pluck("children").flatten().filter(f).value().length>=a.expectedUnitCount)return d=c.reject(d,function(a){return c.every(a.children,i)}),d.sort(u(a.lastTargetsNodeId)),a.targetCompleted=!0,d}
c.forEach(a.progress,function(d){if(f(d)&&j(d))b.push(s.call(d,1));else if(c.find(d.children,o(a.currentUnitId)))b.push(s.call(d,2));else if(g(d)){var e=c(d.children).pluck("progress").pluck("score").value(),h=c.reduce(e,function(a,b){return l(a)+l(b)})||0;k.call(d,"score",h),b.push(s.call(d,3))}else c.find(d.children,o(a.recommendedUnit))&&j(d)&&b.push(s.call(d,4))}),b=b.sort(function(a,b){return a.priority>b.priority?1:a.priority===b.priority&&a.score===b.score?0:void 0!==a.score&&void 0!==b.score?b.score-a.score:-1});var e=0;for(b=c.filter(b,function(b){var d=c.reject(b.children,h);return e<a.expectedUnitCount&&(e+=d.length,!0)});e<a.expectedUnitCount;){var m=c.difference(a.progress,b);if(m=c.filter(m,j),0===m.length)break;e+=c.reject(m[0].children,h).length,b.push(s.call(m[0],5)),a.count++}return b}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/course-target/helper",["lodash","./progress-state-engage"],function(a,b){var c={isPassedUnit:function(a){return a.progress.state&b.Completed},isValidUnit:function(a){return!(a.progress.state&b.PreviouslyPassed)},getUnitCount:function(b,c){var d=0;return a.forEach(b,function(b){d+=a.filter(b.children,c).length}),d}};return c.isUncompletedLevel=function(b){return a.filter(b.children,c.isPassedUnit).length<6},c}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/course-target/course-target",["troopjs-core/component/factory","./helper","lodash"],function(a,b,c){"use strict";function d(a,c,d,e){var f=[],g=1,h="push",i="max",j=c;c>d&&(g=-1,h="unshift",i="min");do{f[h](a[j-1]),j+=g}while(Math[i](j,d)===d&&b.getUnitCount(f,b.isValidUnit)<e);return f}return a(function(a,c){var e=this;e.studyTarget=a,e.progress=c.children,e.startingLevelNo=e.studyTarget.startingLevelNo,e.currentLevelNo=e.studyTarget.currentLevelNo||e.startingLevelNo,e.currentLevelChanged=void 0!==e.studyTarget.schoolCurrentGELevel&&e.studyTarget.schoolCurrentGELevel!==e.currentLevelNo,e.currentLevelNo=e.studyTarget.schoolCurrentGELevel||e.currentLevelNo,e.levels=d(e.progress,e.startingLevelNo,e.progress.length,e.studyTarget.originGeneralEnglishTarget),e.expectedUnitCount=Math.min(b.getUnitCount(e.levels,b.isValidUnit),e.studyTarget.originGeneralEnglishTarget),e.targetCompleted=b.getUnitCount(e.levels,b.isPassedUnit)>=e.expectedUnitCount,e.targetLevelNo=Math.min(e.progress.length,e.startingLevelNo+e.levels.length)},{getTarget:function(){var a=this;return a.progress.slice(a.startingLevelNo-1,a.startingLevelNo+a.levels.length-1)},getDisplayLevelNo:function(){var a=this,d=a.currentLevelNo,e=a.targetLevelNo;if(a.targetCompleted)e=a.getTargetLevelNo(d,1);else if(!a.studyTarget.schoolCurrentGELevel){var f=c.findIndex(a.levels,b.isUncompletedLevel);d=a.startingLevelNo+f}return{currentLevelNo:d,targetLevelNo:e}},getTargetLevelNo:function(a,b){var c=this,d=Math.max(1,a+b);return Math.min(c.progress.length,d)},recalculate:function(){var a=this,e=a.currentLevelNo>=a.startingLevelNo&&a.currentLevelNo<a.startingLevelNo+a.levels.length;if(a.currentLevelChanged&&!a.targetCompleted&&!e){var f=d(a.progress,a.currentLevelNo,1,a.studyTarget.originGeneralEnglishTarget);f.pop(),a.startingLevelNo=a.currentLevelNo-(f.length-c.findLastIndex(f,b.isUncompletedLevel)-1),a.levels=d(a.progress,a.startingLevelNo,a.progress.length,a.studyTarget.originGeneralEnglishTarget),a.expectedUnitCount=Math.min(b.getUnitCount(a.levels,b.isValidUnit),a.studyTarget.originGeneralEnglishTarget),a.targetCompleted=b.getUnitCount(a.levels,b.isPassedUnit)>=a.expectedUnitCount,a.targetLevelNo=Math.min(a.progress.length,a.startingLevelNo+a.levels.length)}}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/course-target/IND-target",["./BE-target","./progress-state-engage","lodash"],function(a,b,c){"use strict";function d(a){return this&a}function e(a,b){return function(c){return c[a]===Number(b)}}function f(a,b){var d={};return d[a]=b,c.assign(this,d)}function g(a){return i.call(a.progress.state)}function h(a){return!c.every(a.children,g)}var i=c.partial(d,b.PreviouslyPassed),j=c.partial(e,"legacyUnitId"),k=c.partial(f,"priority");return a.extend(function(a,b){var c=this;c.multiple=1,c.count=c.studyTarget.industrySpinTarget,c.enforcedUnit=c.studyTarget.industryEnglishAutoEnrolledUnit,c.recommendedUnit=c.studyTarget.industryEnglishRecommendedUnit,c.expectedUnitCount=c.count,c.lastTargetsNodeId=c.studyTarget.industryEnglishTopics},{getTarget:function(){var b=this,d=[];return c.forEach(b.progress,function(a){c.find(a.children,j(b.enforcedUnit))&&h(a)&&d.push(k.call(a,0))}),d.length<b.count&&(d=d.concat(a.prototype.getTarget.call(this)),d=c.uniq(d)),d}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/main.html",[],function(){return function(a){var b="",c=0===a.levelsBE.length?"unit-inline":"";b+='\n<p class="cp-extra-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695399"></p>\n<p class="cp-extra-reminder">\n\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+(0===a.unitsLeft?"696870":"695400")+'" data-values=\'{"lefttarget":"'+a.unitsLeft+'"}\'></span>\n\t<span class="cp-extra-target">'+a.expireDate+'</span>\n</p>\n<p class="cp-extra-show" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695402"></p>\n<div class="cp-extra-container hidden">\n\t<p class="cp-extra-hide" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695401"></p>\n\t<div class="cp-extra-body">\n\t\t<div class="cp-ge-units">\n\t\t\t<p class="unit-title '+c+'" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639157"></p>\n\t\t\t';for(var d=0;d<a.levelsGE.length;d++){b+="\n\t\t\t";var e=a.levelsGE[d];b+='\n\t\t\t<p class="unit-level '+c+'" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639430" data-values=\'{"lvlNumber":"'+e.levelNo+'"}\'></p>\n\t\t\t<ul class="unit-progress">\n\t\t\t';for(var f=0;f<e.units.length;f++){b+="\n\t\t\t\t";var g=f+1;b+="\n\t\t\t\t";var h=e.units[f]?"finished":"";b+='\n\t\t\t\t<li class="'+h+'"><p>'+g+"</p></li>\n\t\t\t"}b+="\n\t\t\t</ul>\n\t\t\t"}if(b+="\n\t\t</div>\n\t\t",a.levelsBE.length>0){b+='\n\t\t<div class="cp-be-units">\n\t\t\t<p class="unit-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639158"></p>\n\t\t\t';for(var d=0;d<a.levelsBE.length;d++){b+="\n\t\t\t";var e=a.levelsBE[d];b+='\n\t\t\t<div class="unit-progress-body">\n\t\t\t\t<p class="unit-level">'+e.levelName+'</p>\n\t\t\t\t<ul class="unit-progress">\n\t\t\t\t';for(var f=0;f<e.units.length;f++){b+="\n\t\t\t\t\t";var g=f+1;b+="\n\t\t\t\t\t";var h=e.units[f]?"finished":"";b+='\n\t\t\t\t\t<li class="'+h+'"><p>'+g+"</p></li>\n\t\t\t\t"}b+="\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t"}b+="\n\t\t</div>\n\t\t"}if(b+="\n\t\t",a.levelsINDB2B.length>0){b+='\n\t\t<div class="cp-ind-units">\n\t\t\t<p class="unit-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="639159"></p>\n\t\t\t';for(var d=0;d<a.levelsINDB2B.length;d++){b+="\n\t\t\t";var e=a.levelsINDB2B[d];b+='\n\t\t\t<div class="unit-progress-body">\n\t\t\t\t<p class="unit-level">'+e.levelName+'</p>\n\t\t\t\t<ul class="unit-progress">\n\t\t\t\t';for(var f=0;f<e.units.length;f++){b+="\n\t\t\t\t\t";var g=f+1;b+="\n\t\t\t\t\t";var h=e.units[f]?"finished":"";b+='\n\t\t\t\t\t<li class="'+h+'"><p>'+g+"</p></li>\n\t\t\t\t"}b+="\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t"}b+="\n\t\t</div>\n\t\t"}return b+="\n\t</div>\n</div>"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/main",["lodash","jquery","when","poly","moment","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-shared/utils/update-helper","school-ui-studyplan/enum/studyplan-velocity","school-ui-shared/enum/moment-language","template!./main.html","./course-target/BE-target","./course-target/course-target","./course-target/IND-target","./course-target/progress-state-engage"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function p(a){return function(b){return b.courseTypeCode===a}}function q(a){return this&a}function r(b){a.each(b,function(b){b.unitCompletedQuantity=a.filter(b.children,function(a){return q.call(a.progress.state,o.Completed)}).length,b.units=a.map(b.children,function(a){return a.progress.state})})}function s(a,b){return a+b}function t(b,c){var d=a.pluck(b,"unitCompletedQuantity");d=a.reduce(d,s)||0;var e=Math.min(c-d);return e<0?0:e}function u(a){return function(b){b&&b.progress.completionDate&&e(a)>e(b.progress.completionDate)&&(b.progress.state=o.PreviouslyPassed)}}function v(a,b){a.length>b&&a.splice(b)}function w(b){return a.map(b.split(y),Number)}function x(c){function d(a){return{levelName:a.unitName,progress:a.progress,templateLevelId:a.templateUnitId,children:[a]}}var e=b.extend({},c);e.children=e.children.map(function(a){var c=b.extend({},a);return c.children=c.children.slice(),c});for(var f=0,g=e.children.length;f<g;f++){var h=e.children[f],i=h.children;if(i.length>1){var j=i.splice(1);h.levelName=i[0].unitName,j=a.map(j,d);var k=j.length;j.unshift(f+1,0),Array.prototype.splice.apply(e.children,j),g+=k,f+=k}}return e}var y=",",z=p("GE"),A=p("BE"),B=p("INDB2B"),C=c.defer();return f.extend(function(){this._context_defer=c.defer()},{"sig/start":function(){var b=this,c={};b.query("studytarget!current","student_enrollable_courses!*.items.children.children.progress,.items.children.progress",C.promise,"accountbasicinfo!current","campus_student_unit_studyplan!current.studyPlan.progress,.studyPlan.items.progress,.studentUnit.children.progress.detail,.studentUnit.children.lessonImage,.studentUnit.parent.parent","member_site_setting!CampMyPage;BusinessEnglishTopics","member_site_setting!CampMyPage;IndustryEnglishTopics",b._context_defer.promise).spread(function(d,f,g,h,i,l,m,n){if(d.isSuccess){a.forEach(f.items,function(b){a.forEach(b.children,function(c){"GE"===b.courseTypeCode&&v(c.children,6),a.forEach(c.children,u(h.activatedDate))})}),l&&l.value&&(d.BusinessEnglishTopics=w(l.value)),m&&m.value&&(d.industryEnglishTopics=w(m.value));var o=f.items,p={unit:i.studentUnit,level:i.studentUnit.parent,course:i.studentUnit.parent.parent},q=b.recalculate({studyTarget:d,courses:o,schoolData:p});q.endLevelNo<=6&&(q.BETarget.length=0,q.INDTarget.length=0,q.BEexpectedUnitCount=0,q.INDexpectedUnitCount=0);var s=e(h.expireDate).lang(j[n.cultureCode.toLowerCase()]).format("MMMM Do YYYY");r(q.GETarget),r(q.BETarget),r(q.INDTarget),c.expireDate=s,c.levelsGE=q.GETarget,c.levelsBE=q.BETarget,c.levelsINDB2B=q.INDTarget,c.startingLevelNo=q.startingLevelNo,c.currentLevelNo=q.currentLevelNo,c.targetLevelNo=q.targetLevelNo,c.unitsLeft=t(q.GETarget,q.GEexpectedUnitCount),c.unitsLeft+=t(q.BETarget,q.BEexpectedUnitCount),c.unitsLeft+=t(q.INDTarget,q.INDexpectedUnitCount),b.html(k,c)}})},"hub:memory/load/results":function(a){C.resolve(a)},"hub:memory/context":function(a){var b=this;a&&b._context_defer.resolve(a)},"dom:.cp-extra-show/click":function(){var a=this;a.$element.find(".cp-extra-show").addClass("hidden"),a.$element.find(".cp-extra-container").removeClass("hidden")},"dom:.cp-extra-hide/click":function(){var a=this;a.$element.find(".cp-extra-show").removeClass("hidden"),a.$element.find(".cp-extra-container").addClass("hidden")},recalculate:function(b){var c;if(b.studyTarget&&b.courses&&b.schoolData){"GE"===b.schoolData.course.courseTypeCode&&(c=b.schoolData.level.levelNo),a.assign(b.studyTarget,{currentUnitId:b.schoolData.unit.legacyUnitId,schoolCurrentGELevel:c});var d=new m(b.studyTarget,a.find(b.courses,z));d.recalculate();var e,f,g,h,i=d.getDisplayLevelNo();if(b.courses.length>1){var j=a.find(b.courses,B);j=x(j),e=new l(b.studyTarget,a.find(b.courses,A)),f=new n(b.studyTarget,j),g=e.getTarget(),h=f.getTarget()}else e={expectedUnitCount:0},f={expectedUnitCount:0},g=[],h=[];return{GETarget:d.getTarget(),BETarget:g,INDTarget:h,startingLevelNo:d.startingLevelNo,endLevelNo:d.targetLevelNo,currentLevelNo:i.currentLevelNo,targetLevelNo:i.targetLevelNo,GEexpectedUnitCount:d.expectedUnitCount,BEexpectedUnitCount:e.expectedUnitCount,INDexpectedUnitCount:f.expectedUnitCount}}}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/goal.html",[],function(){return function(a){return'<div class="ets-sp-cfg cp-cfg '+a.status+'">\n\t<div class="ets-sp-cfg-hd">\n\t\t\x3c!--\n\t\tthe progress widget will render here\n\t\t--\x3e\n\t</div>\n\t<div class="ets-sp-cfg-bd cp-pace-bd">\n\t\t\x3c!--\n\t\tthe pace config widget will render here\n\t\t--\x3e\n\t</div>\n\t<div class="ets-sp-cfg-ft">\n\t\t\x3c!--\n\t\tthe restart & moveon widget will render here\n\t\tdisplay extra information for b2b\n\t\t--\x3e\n\t</div>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/main",["when","jquery","json2","lodash","troopjs-ef/component/widget","troopjs-browser/loom/config","troopjs-browser/loom/weave","school-ui-shared/utils/progress-state","school-ui-studyplan/utils/state-parser","school-ui-studyplan/enum/studyplan-state","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/enum/studyplan-velocity","template!./goal.html"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(a){return this&a}function o(a){return"lesson"===a.typeCode}function p(a){return n.call(a.progress.state,k.Completed)}return e.extend(function(a,b,c){this._data_goal=c},{"hub:memory/load/results":function(c){var d=c.studyplan;if(d){var e,g=this;return g._data_goal.properties.paces.forEach(function(a){0===a.pacePoints&&(e=a.selected)}),a.all([g.query("campus_student_studyplan_hours_estimation!"+d.id.split("!")[1]),g.query(d.id+".progress,.items.progress"),g.query("campus_student_unit_studyplan!current.studyPlan.progress,.studyPlan.items.progress,.studentUnit.children.progress.detail,.studentUnit.children.lessonImage,.studentUnit.parent.parent"),g.query('ccl!"student.partnercode.is.b2b"')]).spread(function(a,h,i,k){g.getStatusKey(d,e,c,i[0]).then(function(c){g.html(m,{status:"cp-cfg-"+c.key.toLowerCase()}).then(function(){var d,e,i,l,m,n=h[0];n.items.forEach(function(a){"goal"===a.typeCode&&(m=a)}),g.$element.find(".ets-sp-cfg-hd").append(e=b("<div></div>").attr(f.weave,"school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/progress/main").data("studyplan",n).data("status",c).data("remainHour",a[0].hours).data("config",b.extend({},m&&m.properties,m&&m.progress.properties))),e.weave(),g.$element.find(".ets-sp-cfg-bd").append(i=b("<div></div>").attr(f.weave,"school-ui-studyplan/shared/cp-pace-config/main").data("mode","view").data("status",c).data("studyplan",n).data("config",b.extend({},m&&m.properties,m&&m.progress.properties))),i.weave();var o=n.progress.state===j.Completed?"school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/moveon/main":"school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/restart/main";g.$element.find(".ets-sp-cfg-ft").append(d=b("<div></div>").attr(f.weave,o).data("studyplan",n).data("status",c)),d.weave(),"true"===k[0].value&&(g.$element.find(".ets-sp-cfg-ft").append(l=b("<div></div>").attr(f.weave,"school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/extra/main").data("studyplan",n).data("status",c).addClass("cp-extra")),l.weave())})})})}},"hub/studyplan/goal/body/status/update":function(a){var b=this;0===a.action?b.$element.find(".ets-sp-cfg").removeClass(a.class):b.$element.find(".ets-sp-cfg").addClass(a.class)},getStatusKey:function(a,b,c,e){return this.checkIfTestIsAvailable({studyPlan:e.studyPlan,course:e.studentUnit.parent.parent,level:e.studentUnit.parent,unit:e.studentUnit}).then(function(e){var f=c.unit,g=f.parent.children,h=g.length,k=a.progress.state===j.Completed?"Completed":"",m=b?"Nopace":"",n=i.parseFlag(l,a.progress.properties.velocity),o="";d.find(n,function(a,b){a&&(o=b)});var p=k||m||o,q=p.toLowerCase();return k&&(q="unit_complete",f.templateUnitId===g[h-1].templateUnitId&&(q="all_unit_complete"),f.templateUnitId===g[h-1].templateUnitId&&e.levelTestIsDone&&(q="level_complete"),f.templateUnitId===g[h-1].templateUnitId&&"GE"!==c.course.courseTypeCode&&(q="course_change")),{key:p,code:q}})},checkLevelIsCompleted:d.memoize(function(a){var b=a.studyPlan,c=a.level,e=a.unit,f=d.filter(b.items,o),g=d.filter(f,p),h=f.length===g.length,i=b.progress&&n.call(b.progress.state,j.Completed);return c.children.length-1===d.indexOf(c.children,e)&&i&&h}),checkIfTestIsAvailable:function(b){var c=this,d=b.level,e=a.defer(),f={};return c.checkLevelIsCompleted(b)?c.query('ccl!"school.courseware.enableleveltest"',"member_site_setting!'school;student.leveltest.version'").spread(function(a,b){var g="true"===a.value.toLowerCase(),i=parseInt(b&&b.value||1);if(f.canDoLevelTest=g,g)return 1===i?c.query("leveltest_overview!"+d.levelCode).spread(function(a){f.levelTestIsDone=a.hasPassed,e.resolve(f)}):c.query(d.id+".levelTest.progress").spread(function(a){f.levelTestIsDone=Boolean(a.levelTest&&h.hasPassed(a.levelTest.progress.state)),e.resolve(f)});f.levelTestIsDone=!0,e.resolve(f)}):e.resolve({canDoLevelTest:!1,levelTestIsDone:!1}),e.promise}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/moveon/moveon.html",[],function(){return function(a){var b="";return"all_unit_complete"===a.status.code&&(b+='\n<div class="cp-studyplan-action">\n\t<p class="cp-studyplan-or" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695094"></p>\n\t<div class="cp-action-move">\n\t\t',a.isLastLevel?b+='\n\t\t<span class="cp-select-course" data-weave="troopjs-ef/blurb/widget" data-link="'+a.changeCourseLink+'" data-blurb-id="'+a.blurbIds.cpSelectCourse+'" data-action="select/course">\n\t\t</span>\n\t\t':b+='\n\t\t<span class="cp-next-level" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695074" data-action="next/level">\n\t\t</span>\n\t\t',b+='\n\t\t<span class="ets-icon-cp-arrow-right"></span>\n\t</div>\n</div>\n'),b}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/moveon/main",["school-ui-studyplan/module","jquery","when","poly","lodash","troopjs-ef/component/widget","client-tracking","school-ui-shared/enum/course-type","school-ui-shared/utils/typeid-parser","school-ui-shared/utils/progress-state","school-ui-shared/utils/update-helper","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/utils/state-parser","template!./moveon.html"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function o(a,b){return"demo"===a.partnercode.value.toLowerCase()&&(h.isGECourse(b)||h.isBECourse(b))}function p(){var a=this,b=a.course.children,c=a.level,d=b.length,e=a.unit,f=e.parent.children,g=f.length,h={};return e.templateUnitId===f[g-1].templateUnitId?(h.isLastUnit=!0,a.isGE?(h.levelTestId=1===a.levelTestVersion?c.legacyLevelId:c.templateLevelId,c.templateLevelId===b[d-1].templateLevelId&&(h.isLastLevel=!0)):h.isLastLevel=!0):f.every(function(b,c){return b.templateUnitId!==e.templateUnitId||(h.nextUnitIndex=c+2,a.nextUnitId=f[c+1].templateUnitId,!1)}),o(a.common_context,a.course.courseTypeCode)&&(h.isLastUnit=!0,h.isLastLevel=!0),h}function q(){var a=this,b=a[y];a.course&&a.level&&a.unit&&a.common_context&&a.levelTestVersion&&a.query(t,u,v,w,x,a.level.id+".children").spread(function(c,d,e,f,g,h){var i,j=p.call(a);j.isGE=a.isGE,j.enableLevelTest=c&&"true"===c.value.toLowerCase(),j.enableChangeLevel=d&&"true"===d.value.toLowerCase(),j.enableSelectCourse=e&&"true"===e.value.toLowerCase(),j.changeCourseLink=f.value,j.status=a[z],j.blurbIds=B.blurbIds,j.optionalItems=[],b.items.forEach(function(a){var b;"goal"!==a.typeCode&&a.isOptional?(b=m.parseFlag(l,a.progress.state),b.Completed||j.optionalItems.push({itemData:a,locked:b.Locked})):i=a}),m.parseFlag(l,i.progress.state).Completed&&(j.isLastLevel&&j.isLastUnit?a.query("blurb!656580").spread(function(b){b&&a.publish(A,b.translation)}):j.isLastUnit?a.query("blurb!656556").spread(function(b){b&&a.publish(A,b.translation)}):a.query("blurb!656555").spread(function(b){b&&a.publish(A,b.translation)})),j.hasActiveSPInCurrentLevel=h.children.reduce(function(a,b){return a||b.templateUnitId===g.studyPlan.properties.templateUnitId},!1),a.html(n,j)})}function r(a){return this.publish("load/config",i.parseId(a))}function s(){var a=this;return a.query("student_course_enrollment!current",a.unit.progress.id).spread(function(b,c){if(a.nextUnitId&&b.studentUnitId===a.unit.studentUnitId&&j.hasPassed(c.state))return k.updateEnrollment({templateId:a.nextUnitId})})}var t='ccl!"school.courseware.enableleveltest"',u='ccl!"school.courseware.enableSelectNextLevel"',v='ccl!"school.menu.changecourse.display"',w="ccl!'school.studyplan.changeCourse.link'",x="campus_student_unit_studyplan!current.studyPlan.items,.studyPlan.progress",y="_data_studyplan",z="_data_status",A="studyplan/goal/moveon-tips/show",B=e.merge({blurbIds:{cpSelectCourse:"656560"}},a.config()||{});return f.extend(function(){var a=this;a[y]=a.$element.data("studyplan"),a[z]=a.$element.data("status"),a.query("member_site_setting!'school;student.leveltest.version'").spread(function(b){a.levelTestVersion=parseInt(b&&b.value||1),q.call(a)})},{"hub:memory/common_context":function(a){var b=this;a&&(b.common_context=a.values,q.call(b))},"hub:memory/load/results":function(a){var b=this;!a||b.course===a.course&&b.level===a.level&&b.unit===a.unit||(b.studyplan=a.studyplan,b.isGE=h.isGECourse((a.course||{}).courseTypeCode),b.course=a.course,b.level=a.level,b.unit=a.unit,q.call(b))},"hub/ef/update/progress":function(a){var b=this;b.query(b.studyplan.id+".items.progress").spread(function(a){b[y]=a,q.call(b)})},"hub/ef/next/unit":function(a){var b=this;s.call(b).then(function(){r.call(b,b.nextUnitId)})},"dom:[data-action='next/unit']/click":function(a){var b=this;s.call(b).then(function(){r.call(b,b.nextUnitId)})},"dom:[data-action='next/level']/click":function(a){this.publish("enroll/next/level")},"dom:[data-action='select/course']/click":function(a){var c=b(a.currentTarget).data("link");c?window.location=c:this.publish("show/course/list")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/progress/progress.html",[],function(){return function(a){var b='<div class="ets-sp-goal-progress cp-goal-progress '+a.customClass+'">\n\t<p class="cp-progres-title">\n\t\t';return a.leftDays&&(b+='\n\t\t<span class="cp-left-day">'+a.leftDays+"</span>\n\t\t"),b+=' \n\t\t<span class="cp-left-unit" data-weave="troopjs-ef/blurb/widget" data-blurb-id="694961">days</span>\n\t\t<span class="ets-icon-badge-goal-poly"></span>\n\t</p>\n\t<p class="cp-progress-msg" data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+a.progressMsg+'">LEFT TO COMPLETE THIS UNIT</p>\n\t<p class="cp-progress-msg-goal-set" data-weave="troopjs-ef/blurb/widget" data-blurb-id="695058">Set a new study goal</p>\n\t<div class="cp-progress-sub-msg">\n\t\t<h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+a.subMsg+'"></h2>\n\t\t',a.tooltipMsg&&(b+='\n\t\t<div class="msg-tooltip">\n\t\t\t<div data-weave="school-ui-studyplan/shared/tooltip/main(option)" data-option=\'{"content": '+a.tooltipMsg+', "customClass": "message"}\'>\n\t\t\t</div>\n\t\t</div>\n\t\t'),b+='\n\t</div>\n\n\t<div class="cp-progress-sub-msg-goal-set">\n\t\t<h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="695059" data-text-en="Estimated ^hours^ to complete the unit" data-values=\'{"hours": "'+a.remainingHour+"\"}'></h2>\n\t</div>\n</div>"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/progress/main",["when","lodash","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/animation-helper","school-ui-studyplan/utils/state-parser","school-ui-studyplan/enum/studyplan-velocity","school-ui-studyplan/enum/studyplan-state","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/enum/studyplan-status","template!./progress.html"],function(a,b,c,d,e,f,g,h,i,j,k){return c.extend(function(){var a=this;a._data_studyplan=a.$element.data("studyplan"),a._config=a.$element.data("config"),a._status=a.$element.data("status"),a._remainhour=a.$element.data("remainHour")},{velocityState:g,"sig/start":function(){var b,c,d,g,l=this,m=l._data_studyplan,n=optionalCount=mandatoryFinished=optionalFinished=0,o=[];m.items.forEach(function(a){var c;"goal"!==a.typeCode?(c=f.parseFlag(i,a.progress.state),a.isOptional?(optionalCount++,c.Completed&&optionalFinished++,o.push({itemData:a,locked:c.Locked})):(n++,c.Completed&&mandatoryFinished++)):b=a}),c=n?parseInt(mandatoryFinished/n*100,10)+"%":void 0,d=optionalCount?parseInt(optionalFinished/optionalCount*100,10)+"%":void 0,b&&b.properties.paces.forEach(function(a){0===a.pacePoints&&(g=a.selected)});var p=l._status.key;return l.html(k,{completed:m.progress.state===h.Completed,goal:b,isNopace:g,mandatoryRate:c,optionalRate:d,optionalItems:o,velocity:m.progress.properties.velocity,subMsg:j[p].subMsg,progressMsg:j[p].progressMsg,tooltipMsg:j[p].tooltipMsg,customClass:j[p].customClass,leftDays:l._config.leftDays,remainingHour:l._remainhour}).then(function(){var b=l.$element.find(".ets-sp-optional-popover"),f=l.$element.find(".ets-sp-mandatory .ets-sp-finished"),g=l.$element.find(".ets-sp-optional .ets-sp-finished");b.data({content:l.$element.find(".ets-sp-optional-holder").html(),trigger:"hover",placement:"bottom",html:!0}),b.popover(),f.css("width",0),g.css("width",0),setTimeout(function(){e.request("goalEnter",function(){return a.promise(function(a){f.css("width",c),g.css("width",d),setTimeout(function(){a()},800)})})},0)})},"hub/studyplan/goal/moveon-tips/show":function(a){a&&this.$element.find(".ets-sp-moveon-tips").removeClass("ets-none").text(a)},"hub/studyplan/goal/progress/edit/show":function(a){var b=this.$element.find(".cp-goal-progress");a?b.addClass("cp-progress-goal-edit"):b.removeClass("cp-progress-goal-edit")},getStatusKey:function(a,c){var d=a.progress.state===h.Completed?"Completed":"",e=c?"Nopace":"",i=f.parseFlag(g,a.progress.properties.velocity),j="";return b.find(i,function(a,b){if(a)return void(j=b)}),d||e||j}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/restart/restart.html",[],function(){return function(a){var b="";return b+='\n<div class="ets-sp-goal-restart cp-goal-restart">\n\t<div class="goal-mail '+("true"===a.emailEnable?"":"hidden")+'">\n\t\t',a.isSubscribed?b+='\n\t\t<input type="checkbox" name="motivation-mail" checked>\n\t\t':b+='\n\t\t<input type="checkbox" name="motivation-mail" >\n\t\t',b+='\n\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="695969">Send me motivation emails to help me reach my study goal</span>\n\t</div>\n\t<div class="ets-sp-goal-restart-confirm-wrapper">\n\t\t<button type="button" class="btn  btn-m btn-block cp-goal-change" data-weave="troopjs-ef/blurb/widget" data-blurb-id="694971">change your goal\n\t\t</button>\n\t</div>\n\t<div class="ets-sp-goal-restart-confirm-wrapper">\n\t\t<button type="button" class="btn  btn-m btn-block cp-goal-set" data-weave="troopjs-ef/blurb/widget" data-blurb-id="694972">Set new Goal\n\t\t</button>\n\t</div>\n\t<p class="cp-goal-cancel" data-weave="troopjs-ef/blurb/widget" data-blurb-id="694973">\n\t\tCancel\n\t</p>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp-goal/restart/main",["jquery","poly","when","troopjs-ef/command/service","troopjs-data/cache/component","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/studyplan-update-helper","school-ui-studyplan/enum/studyplan-velocity","template!./restart.html"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k,l;return f.extend(function(){var a=this;a._data_studyplan=a.$element.data("studyplan"),k||(k=new d("studyplan_email/off",new e),k.configure({url:"/services/api/campusstudyplan/command/campus_student_studyplan_email_subscrib/UnsubscribStudyPlanEmail",contentType:"application/json; charset=UTF-8",type:"post"}),k.start()),l||(l=new d("studyplan_email/on",new e),l.configure({url:"/services/api/campusstudyplan/command/campus_student_studyplan_email_subscrib/SubscribStudyPlanEmail",contentType:"application/json; charset=UTF-8",type:"post"}),l.start())},{"sig/start":function(){var a=this,b=a.query("campus_student_studyplan_email_subscription!current",'ccl!"CoachingEmail.enabled"');return c(b).then(function(b){return a.html(j,{isSubscribed:b[0].isSubscribed,emailEnable:b[1].value})}).then(function(){a._data_studyplan&&a._data_studyplan.progress.properties.velocity===i.Crashed&&a.$element.find(".ets-sp-goal-restart-link").addClass("btn-primary btn-m btn")})},"hub/config/pace-change":function(a){var b=this;a.every(function(a,c){return!a.selected||(b._pacePoints=a.pacePoints,!1)})},"dom:.ets-sp-goal-restart-link/click":function(){var a=this;a.$element.find(".ets-sp-goal-restart-link").addClass("ets-none"),a.$element.find(".ets-sp-goal-restart-confirm-wrapper").removeClass("ets-none"),a.publish("config/pace-config/mode","edit")},"dom:.ets-sp-goal-restart-confirm/click":function(){var a=this;h.restartStudyplan({reason:"",pacePoints:a._pacePoints}).then(function(b){a.publish("load",{studyplan_item:g.parseId(b.id)})})},"dom:.ets-sp-goal-restart-cancel/click":function(){var a=this;a.publish("config/pace-config/mode","view"),a.$element.find(".ets-sp-goal-restart-link").removeClass("ets-none"),a.$element.find(".ets-sp-goal-restart-confirm-wrapper").addClass("ets-none")},"dom:.cp-goal-change/click":function(){var a=this;a.$element.find(".ets-sp-goal-restart").addClass("goal-changing"),a.publish("config/pace-config/mode","edit"),a.publish("studyplan/goal/progress/edit/show",!0),a.publish("studyplan/goal/body/status/update",{action:1,class:"cp-cfg-edit"})},"dom:.cp-goal-set/click":function(){var a=this;a.$element.find(".ets-sp-goal-restart").removeClass("goal-changing"),h.restartStudyplan({reason:"",pacePoints:a._pacePoints}).then(function(b){a.publish("load",{studyplan_item:g.parseId(b.id)})})},"dom:.cp-goal-cancel/click":function(){var a=this;a.$element.find(".ets-sp-goal-restart").removeClass("goal-changing"),a.publish("config/pace-config/mode","view"),a.publish("studyplan/goal/progress/edit/show",!1),a.publish("studyplan/goal/body/status/update",{action:0,class:"cp-cfg-edit"})},"dom:.goal-mail input/click":function(){var a=this,b=a.$element.find("input"),c=b.is(":checked")?"studyplan_email/on":"studyplan_email/off";a.publish(c)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/cp20/locked.html",[],function(){return function(a){return'<div class="ets-sp-cp20-locked">\n    <h1><i class="ets-icon-lock"></i></h1>\n    <h1 data-weave="troopjs-ef/blurb/widget" data-text-en="The private lesson Is Locked" data-blurb-id="639500"></h1>\n    <p class="ets-sp-cp20-tips" data-weave="troopjs-ef/blurb/widget" data-text-en="You must complete the unit lessons before reviewing what youâ€™ve learned with a teacher." data-blurb-id="639501"></p>\n    <p class="ets-sp-cp20-purpose" data-weave="troopjs-ef/blurb/widget" data-text-en="The purpose of the private lesson is to review what you\'ve learned in this unit with a live teacher. This live session takes 20 minutes and is included with your subscription." data-blurb-id="639502"></p>\n    <p class="ets-sp-cp20-btn-tips" data-weave="troopjs-ef/blurb/widget" data-text-en="You must complete your lessons before booking the private lesson." data-blurb-id="639503"></p>\n    <div class="ets-sp-cp20-next">\n    \t<button type="button" data-action="takeNext" class="btn btn-primary btn-ml ets-sp-btn-next-lesson">\n    \t\t<span data-blurb-id="639504" data-text-en="Take your next lesson" data-weave="troopjs-ef/blurb/widget"></span>\n    \t\t<i class="glyphicon icon-caret-right"></i>\n    \t</button>\n    </div>\n</div>'}}),
define("school-ui-studyplan/widget/studyplan/body/sequence-container/cp20/main",["jquery","troopjs-ef/component/widget","school-ui-studyplan/utils/state-parser","school-ui-studyplan/enum/studyplan-item-state","template!./locked.html"],function(a,b,c,d,e){"use strict";return b.extend(function(a,b,c){this._item_data=c},{"sig/start":function(){var b=this;if(b._item_data||b._item_data.progress)return b.query(b._item_data.progress.id).spread(function(f){return c.parseFlag(d,f.state).Locked?b.publish("school/interface/studyplan/cp20-locked-widget").spread(function(c){if(!c)return b.html(e,{itemData:b._item_data});a("<div></div>",{"data-weave":c+"(itemData)",data:{itemData:b._item_data}}).appendTo(b.$element).weave()}):b.publish("school/interface/studyplan/cp20-container-widget","school-ui-studyplan/widget/gl-pl/checkpoint20/main").spread(function(c){a("<div></div>",{"data-weave":c+"(itemData)",data:{itemData:b._item_data}}).appendTo(b.$element).weave()})})},"dom:[data-action=takeNext]/click":function(){this.publish("studyplan/sequence/navigate/suggest-item")}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/gl/main",["jquery","troopjs-ef/component/widget"],function(a,b,c){"use strict";return b.extend(function(a,b,c){this._item_data=c},{"sig/start":function(){var b=this;return b.publish("school/interface/studyplan/gl-container-widget","school-ui-studyplan/widget/gl-pl/grouplesson/main").spread(function(c){a("<div></div>",{"data-weave":c+"(itemData)",data:{itemData:b._item_data}}).appendTo(b.$element).weave()})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/goal/goal.html",[],function(){return function(a){return'<div class="ets-sp-cfg">\n\t<div class="ets-sp-cfg-hd">\n\t\t\x3c!--\n\t\tthe progress widget will render here\n\t\t--\x3e\n\t</div>\n\t<div class="ets-sp-cfg-bd">\n\t\t\x3c!--\n\t\tthe pace config widget will render here\n\t\t--\x3e\n\t</div>\n\t<div class="ets-sp-cfg-ft">\n\t\t\x3c!--\n\t\tthe restart & moveon widget will render here\n\t\t--\x3e\n\t</div>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/goal/main",["when","jquery","json2","troopjs-ef/component/widget","troopjs-browser/loom/config","troopjs-browser/loom/weave","school-ui-studyplan/utils/state-parser","school-ui-studyplan/enum/studyplan-state","school-ui-studyplan/enum/studyplan-item-state","template!./goal.html"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return d.extend(function(a,b,c){this._data_goal=c},{"hub:memory/load/studyplan":function(c){if(c){var d,f=this;return f._data_goal.properties.paces.forEach(function(a){0===a.pacePoints&&(d=a.selected)}),a.all([f.html(j),f.query(c.id+".progress,.items.progress")]).spread(function(a,c){var g,i,j,k,l=c[0];l.items.forEach(function(a){"goal"===a.typeCode&&(k=a)}),f.$element.find(".ets-sp-cfg-hd").append(i=b("<div></div>").attr(e.weave,"school-ui-studyplan/widget/studyplan/body/sequence-container/goal/progress/main").data("studyplan",l)),i.weave(),l.progress.state===h.Completed?(f.$element.find(".ets-sp-cfg-ft").append(g=b("<div></div>").attr(e.weave,"school-ui-studyplan/widget/studyplan/body/sequence-container/goal/moveon/main").data("studyplan",l)),g.weave()):(f.$element.find(".ets-sp-cfg-bd").append(j=b("<div></div>").attr(e.weave,"school-ui-studyplan/shared/pace-config/main").data("mode","view").data("config",b.extend({},k&&k.properties,k&&k.progress.properties))),j.weave(),d?f.$element.find(".ets-sp-cfg-ft").addClass("ets-sp-blank"):(f.$element.find(".ets-sp-cfg-ft").append(g=b("<div></div>").attr(e.weave,"school-ui-studyplan/widget/studyplan/body/sequence-container/goal/restart/main").data("studyplan",l)),g.weave()))})}}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/goal/moveon/moveon.html",[],function(){return function(a){var b="";if(b+='\n\n<div class="ets-sp-goal-moveon">\n\t\t',a.hasActiveSPInCurrentLevel&&(b+='\n\t\t\x3c!--\n\t\tif not, we cann\'t render the move on button. because case SPC-4998\n\t\t--\x3e\n\t\t\t<div class="ets-sp-goal-moveon-main">\n\t\t\t\t\t'+function(){var b,c=" <button class=";return a.isLastLevel?a.isLastUnit&&(a.enableLevelTest&&a.isGE&&(c='<a href="/school/content/leveltest.aspx?testid='+a.levelTestId+'" target="_blank"><span class="btn btn-m btn-default" data-weave="troopjs-ef/blurb/widget" data-blurb-id="450035" data-text-en="Take the level test"></span></a>'+c),a.enableSelectCourse&&(c+='"btn btn-m btn-primary" data-action="select/course" data-link="'+a.changeCourseLink+'">',b='<span data-blurb-id="'+a.blurbIds.cpSelectCourse+'" data-text-en="Select the next course you want to do" data-weave="troopjs-ef/blurb/widget"></span>')):a.isLastUnit?(c+='"btn btn-m btn-primary '+(a.enableChangeLevel?"":"hide")+'" data-action="next/level">',a.enableLevelTest&&a.isGE&&(c='<a href="/school/content/leveltest.aspx?testid='+a.levelTestId+'" target="_blank"><span class="btn btn-m btn-default" data-weave="troopjs-ef/blurb/widget" data-blurb-id="450035" data-text-en="Take the level test"></span></a>'+c),b='<span data-blurb-id="569912" data-text-en="Move to the next level" data-weave="troopjs-ef/blurb/widget"></span> '):(c+='"btn btn-m btn-primary" data-action="next/unit">',b='<span data-blurb-id="569911" data-text-en="Go to Unit ^number^" data-weave="troopjs-ef/blurb/widget" data-values=\'{"number":'+a.nextUnitIndex+"}'></span>"),b?c+b+' <i class="glyphicon icon-caret-right"></i></button>':""}()+"\n\t\t\t</div>\n\t\t"),b+="\n\n\t\t",a.optionalItems.length){b+='\n\t\t<div class="ets-sp-moveon-items">\n\t\t\t<div class="ets-sp-optional-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656559" data-text-en="We recommend you to take optional lessons before you move on"></div>\n\t\t\t<div class="ets-sp-optional-items">\n\t\t\t';for(var c=0;c<a.optionalItems.length;c++)switch(a.optionalItems[c].itemData.typeCode){case"cp20":b+='\n\t\t\t\t\t\t<div class="ets-sp-item-small">\n\t\t\t\t\t\t\t<i class="ets-sp-icon">\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-badge ets-icon-badge-check-point"></i>\n\t\t\t\t\t\t\t\t',a.optionalItems[c].locked&&(b+='\n\t\t\t\t\t\t\t\t\t<i class="ets-icon-badge-locked">\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-icon ets-icon-lock"></i>\n\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t'),b+='\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t<span class="ets-sp-name" data-weave="troopjs-ef/blurb/widget" data-text-en="Private Class" data-blurb-id="639494"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t';break;case"pl":b+='\n\t\t\t\t\t\t<div class="ets-sp-item-small">\n\t\t\t\t\t\t\t<i class="ets-sp-icon">\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-badge ets-icon-badge-private-lesson"></i>\n\t\t\t\t\t\t\t\t',a.optionalItems[c].locked&&(b+='\n\t\t\t\t\t\t\t\t\t<i class="ets-icon-badge-locked">\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-icon ets-icon-lock"></i>\n\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t'),b+='\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t<span class="ets-sp-name" data-weave="troopjs-ef/blurb/widget" data-text-en="Private Class" data-blurb-id="569833"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t';break;case"gl":b+='\n\t\t\t\t\t\t<div class="ets-sp-item-small">\n\t\t\t\t\t\t\t<i class="ets-sp-icon">\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-badge ets-icon-badge-group-lesson"></i>\n\t\t\t\t\t\t\t\t',a.optionalItems[c].locked&&(b+='\n\t\t\t\t\t\t\t\t\t<i class="ets-icon-badge-locked">\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-icon ets-icon-lock"></i>\n\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t'),b+='\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t<span class="ets-sp-name" data-weave="troopjs-ef/blurb/widget" data-text-en="Private Class" data-blurb-id="638118"></span>\n\t\t\t\t\t\t</div>\n\t\t\t'}b+="\n\t\t\t</div>\n\t\t</div>\n\t\t"}return b+="\n</div>"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/goal/moveon/main",["school-ui-studyplan/module","jquery","when","poly","lodash","troopjs-ef/component/widget","school-ui-shared/enum/course-type","school-ui-shared/utils/typeid-parser","school-ui-shared/utils/progress-state","school-ui-shared/utils/update-helper","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/utils/state-parser","template!./moveon.html"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(a,b){return"demo"===a.partnercode.value.toLowerCase()&&(g.isGECourse(b)||g.isBECourse(b))}function o(){var a=this,b=a.course.children,c=a.level,d=b.length,e=a.unit,f=e.parent.children,g=f.length,h={};return e.templateUnitId===f[g-1].templateUnitId||"INDB2B"===a.course.courseTypeCode?(h.isLastUnit=!0,a.isGE?(h.levelTestId=1===a.levelTestVersion?c.legacyLevelId:c.templateLevelId,c.templateLevelId===b[d-1].templateLevelId&&(h.isLastLevel=!0)):h.isLastLevel=!0):f.every(function(b,c){return b.templateUnitId!==e.templateUnitId||(h.nextUnitIndex=c+2,a.nextUnitId=f[c+1].templateUnitId,!1)}),n(a.common_context,a.course.courseTypeCode)&&(h.isLastUnit=!0,h.isLastLevel=!0),h}function p(){var a=this,b=a[x];a.course&&a.level&&a.unit&&a.common_context&&a.levelTestVersion&&a.query(s,t,u,v,w,a.level.id+".children").spread(function(c,d,e,f,g,h){var i,j=o.call(a);j.isGE=a.isGE,j.enableLevelTest=c&&"true"===c.value.toLowerCase(),j.enableChangeLevel=d&&"true"===d.value.toLowerCase(),j.enableSelectCourse=e&&"true"===e.value.toLowerCase(),j.changeCourseLink=f.value,j.blurbIds=z.blurbIds,j.optionalItems=[],b.items.forEach(function(a){var b;"goal"!==a.typeCode&&a.isOptional?(b=l.parseFlag(k,a.progress.state),b.Completed||j.optionalItems.push({itemData:a,locked:b.Locked})):i=a}),l.parseFlag(k,i.progress.state).Completed&&(j.isLastLevel&&j.isLastUnit?a.query("blurb!656580").spread(function(b){b&&a.publish(y,b.translation)}):j.isLastUnit?a.query("blurb!656556").spread(function(b){b&&a.publish(y,b.translation)}):a.query("blurb!656555").spread(function(b){b&&a.publish(y,b.translation)})),j.hasActiveSPInCurrentLevel=h.children.reduce(function(a,b){return a||b.templateUnitId===g.studyPlan.properties.templateUnitId},!1),a.html(m,j)})}function q(a){return this.publish("load/config",h.parseId(a))}function r(){var a=this;return a.query("student_course_enrollment!current",a.unit.progress.id).spread(function(b,c){if(a.nextUnitId&&b.studentUnitId===a.unit.studentUnitId&&i.hasPassed(c.state))return j.updateEnrollment({templateId:a.nextUnitId})})}var s='ccl!"school.courseware.enableleveltest"',t='ccl!"school.courseware.enableSelectNextLevel"',u='ccl!"school.menu.changecourse.display"',v="ccl!'school.studyplan.changeCourse.link'",w="campus_student_unit_studyplan!current.studyPlan.items,.studyPlan.progress",x="_data_studyplan",y="studyplan/goal/moveon-tips/show",z=e.merge({blurbIds:{cpSelectCourse:"656560"}},a.config()||{});return f.extend(function(){var a=this;a[x]=a.$element.data("studyplan"),a.query("member_site_setting!'school;student.leveltest.version'").spread(function(b){a.levelTestVersion=parseInt(b&&b.value||1),p.call(a)})},{"hub:memory/common_context":function(a){var b=this;a&&(b.common_context=a.values,p.call(b))},"hub:memory/load/results":function(a){var b=this;!a||b.course===a.course&&b.level===a.level&&b.unit===a.unit||(b.studyplan=a.studyplan,b.isGE=g.isGECourse((a.course||{}).courseTypeCode),b.course=a.course,b.level=a.level,b.unit=a.unit,p.call(b))},"hub/ef/update/progress":function(a){var b=this;b.query(b.studyplan.id+".items.progress").spread(function(a){b[x]=a,p.call(b)})},"dom:[data-action='next/unit']/click":function(a){var b=this;r.call(b).then(function(){q.call(b,b.nextUnitId)})},"dom:[data-action='next/level']/click":function(a){this.publish("enroll/next/level")},"dom:[data-action='select/course']/click":function(a){var c=b(a.currentTarget).data("link");c?window.open(c,"_self"):this.publish("show/course/list")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/goal/progress/progress.html",[],function(){return function(a){var b='<div class="ets-sp-goal-progress">\n\t';if(a.completed)b+='\n\t\t<h2 class="ets-sp-velocity" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656554" data-text-en="Congratulations!"></h2>\n\t\t';else if(a.isNopace)b+='\n\t\t<h2 class="ets-sp-velocity" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656581" data-text-en="You are studying at your own pace."></h2>\n\t\t';else switch(a.velocity){case this.velocityState.Fast:b+='\n\t\t\t\t<h2 class="ets-sp-velocity" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656562" data-text-en="Fantastic. You are running ahead."></h2>\n\t\t\t\t';break;case this.velocityState.Normal:b+='\n\t\t\t\t<h2 class="ets-sp-velocity" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656561" data-text-en="Thumbs up. You are right on track."></h2>\n\t\t\t\t';break;case this.velocityState.Slow:b+='\n\t\t\t\t<h2 class="ets-sp-velocity" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656563" data-text-en="You are falling behind. Letâ€™s get back on track."></h2>\n\t\t\t\t';break;case this.velocityState.Crashing:b+='\n\t\t\t\t<h2 class="ets-sp-velocity" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656582" data-text-en="Your unit plan will expire soon. Letâ€™s get back on track."></h2>\n\t\t\t\t';break;case this.velocityState.Crashed:b+='\n\t\t\t\t<h2 class="ets-sp-velocity" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656564" data-text-en="Your study plan has expired. Set a new one."></h2>\n\t\t\t\t'}if(b+='\n\t\n\t<div class="ets-sp-moveon-tips ets-none"></div>\n\t<div class="ets-sp-bar">\n\t\t<span class="ets-sp-complete-rate">\n\t\t\t<span class="ets-sp-rate-num">'+a.mandatoryRate+'</span>\n\t\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="656557" data-text-en="completed"></span>\n\t\t</span>\n\t\t\n\t\t<div class="ets-sp-mandatory">\n\t\t\t<div class="ets-sp-progress-border"></div>\n\t\t\t<span class="ets-sp-finished"></span>\n\t\t</div>\t\t\n\t\t',a.optionalItems.length&&(b+='\n\t\t\t<div class="ets-sp-optional-popover">\n\t\t\t\t<div class="ets-sp-optional">\n\t\t\t\t\t<div class="ets-sp-progress-border"></div>\n\t\t\t\t\t<span class="ets-sp-finished"></span>\n\t\t\t\t\t<span class="ets-sp-dots">\n\t\t\t\t\t\t<span class="ets-sp-dot"></span>\n\t\t\t\t\t\t<span class="ets-sp-dot"></span>\n\t\t\t\t\t\t<span class="ets-sp-dot"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'),b+='\n\n\n\t</div>\n</div>\n\x3c!-- use in gubstrap popover plugin --\x3e\n<div class="ets-sp-optional-holder ets-none">\n\t<div class="ets-sp-optional-lessons">\n\t\t<div class="ets-sp-optional-title" data-weave="troopjs-ef/blurb/widget" data-blurb-id="656558" data-text-en="Optional lessons"></div>\n\t\t<div class="ets-sp-optional-items">\n\t\t',a.optionalItems&&a.optionalItems.length)for(var c=0;c<a.optionalItems.length;c++)switch(a.optionalItems[c].itemData.typeCode){case"cp20":b+='\n\t\t\t\t\t\t<div class="ets-sp-item-small">\n\t\t\t\t\t\t\t<i class="ets-sp-icon">\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-badge ets-icon-badge-check-point"></i>\n\t\t\t\t\t\t\t\t',a.optionalItems[c].locked&&(b+='\n\t\t\t\t\t\t\t\t\t<i class="ets-icon-badge-locked">\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-icon ets-icon-lock"></i>\n\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t'),b+='\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t<span class="ets-sp-name" data-weave="troopjs-ef/blurb/widget" data-text-en="Private Class" data-blurb-id="639494"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t';break;case"pl":b+='\n\t\t\t\t\t\t<div class="ets-sp-item-small">\n\t\t\t\t\t\t\t<i class="ets-sp-icon">\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-badge ets-icon-badge-private-lesson"></i>\n\t\t\t\t\t\t\t\t',a.optionalItems[c].locked&&(b+='\n\t\t\t\t\t\t\t\t\t<i class="ets-icon-badge-locked">\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-icon ets-icon-lock"></i>\n\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t'),b+='\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t<span class="ets-sp-name" data-weave="troopjs-ef/blurb/widget" data-text-en="Private Class" data-blurb-id="569833"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t';break;case"gl":b+='\n\t\t\t\t\t\t<div class="ets-sp-item-small">\n\t\t\t\t\t\t\t<i class="ets-sp-icon">\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t<i class="ets-sp-icon-badge ets-icon-badge-group-lesson"></i>\n\t\t\t\t\t\t\t\t',a.optionalItems[c].locked&&(b+='\n\t\t\t\t\t\t\t\t\t<i class="ets-icon-badge-locked">\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-bg glyphicon icon-circle"></i>\n\t\t\t\t\t\t\t\t\t\t<i class="ets-sp-locked-mark-icon ets-icon-lock"></i>\n\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t'),b+='\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t<span class="ets-sp-name" data-weave="troopjs-ef/blurb/widget" data-text-en="Private Class" data-blurb-id="638118"></span>\n\t\t\t\t\t\t</div>\n\t\t\t'}return b+="\n\t\t</div>\t\n\t</div>\n</div>"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/goal/progress/main",["when","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/animation-helper","school-ui-studyplan/utils/state-parser","school-ui-studyplan/enum/studyplan-velocity","school-ui-studyplan/enum/studyplan-state","school-ui-studyplan/enum/studyplan-item-state","template!./progress.html"],function(a,b,c,d,e,f,g,h,i){return b.extend(function(){var a=this;a._data_studyplan=a.$element.data("studyplan")},{velocityState:f,"sig/start":function(){var b,c,f,j,k=this,l=k._data_studyplan,m=optionalCount=mandatoryFinished=optionalFinished=0,n=[];return l.items.forEach(function(a){var c;"goal"!==a.typeCode?(c=e.parseFlag(h,a.progress.state),a.isOptional?(optionalCount++,c.Completed&&optionalFinished++,n.push({itemData:a,locked:c.Locked})):(m++,c.Completed&&mandatoryFinished++)):b=a}),c=m?parseInt(mandatoryFinished/m*100,10)+"%":void 0,f=optionalCount?parseInt(optionalFinished/optionalCount*100,10)+"%":void 0,b&&b.properties.paces.forEach(function(a){0===a.pacePoints&&(j=a.selected)}),k.html(i,{completed:l.progress.state===g.Completed,goal:b,isNopace:j,mandatoryRate:c,optionalRate:f,optionalItems:n,velocity:l.progress.properties.velocity}).then(function(){var b=k.$element.find(".ets-sp-optional-popover"),e=k.$element.find(".ets-sp-mandatory .ets-sp-finished"),g=k.$element.find(".ets-sp-optional .ets-sp-finished");b.data({content:k.$element.find(".ets-sp-optional-holder").html(),trigger:"hover",placement:"bottom",html:!0}),b.popover(),e.css("width",0),g.css("width",0),setTimeout(function(){d.request("goalEnter",function(){return a.promise(function(a){e.css("width",c),g.css("width",f),setTimeout(function(){a()},800)})})},0)})},"hub/studyplan/goal/moveon-tips/show":function(a){a&&this.$element.find(".ets-sp-moveon-tips").removeClass("ets-none").text(a)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/goal/restart/restart.html",[],function(){return function(a){return'<div class="ets-sp-goal-restart">\n\t<span class="ets-sp-goal-restart-link" data-blurb-id="569840" data-text-en="Restart" data-weave="troopjs-ef/blurb/widget"></span>\n\t<div class="ets-sp-goal-restart-confirm-wrapper ets-none">\n\t\t<button type="button" class="btn btn-primary btn-m btn-block ets-sp-goal-restart-confirm" data-blurb-id="450019" data-text-en="Confirm" data-weave="troopjs-ef/blurb/widget"><span></span></button>\n\t\t<span class="ets-sp-goal-restart-cancel" data-blurb-id="450018" data-text-en="Cancel" data-weave="troopjs-ef/blurb/widget"></span>\n\t</div>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/goal/restart/main",["jquery","poly","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/studyplan-update-helper","school-ui-studyplan/enum/studyplan-velocity","template!./restart.html"],function(a,b,c,d,e,f,g){"use strict";return c.extend(function(){var a=this;a._data_studyplan=a.$element.data("studyplan")},{"sig/start":function(){var a=this;return a.html(g).then(function(){a._data_studyplan&&a._data_studyplan.progress.properties.velocity===f.Crashed&&a.$element.find(".ets-sp-goal-restart-link").addClass("btn-primary btn-m btn")})},"hub/config/pace-change":function(a){var b=this;a.every(function(a,c){return!a.selected||(b._pacePoints=a.pacePoints,!1)})},"dom:.ets-sp-goal-restart-link/click":function(){var a=this;a.$element.find(".ets-sp-goal-restart-link").addClass("ets-none"),a.$element.find(".ets-sp-goal-restart-confirm-wrapper").removeClass("ets-none"),a.publish("config/pace-config/mode","edit")},"dom:.ets-sp-goal-restart-confirm/click":function(){var a=this;e.restartStudyplan({reason:"",pacePoints:a._pacePoints}).then(function(b){a.publish("load",{studyplan_item:d.parseId(b.id)})})},"dom:.ets-sp-goal-restart-cancel/click":function(){var a=this;a.publish("config/pace-config/mode","view"),a.$element.find(".ets-sp-goal-restart-link").removeClass("ets-none"),a.$element.find(".ets-sp-goal-restart-confirm-wrapper").addClass("ets-none")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/lesson.html",[],function(){return function(a){var b="",c=a.lesson,d=a.pcScore,e=a.pcHasPassed,f=a.mobHasPassed,g=a.mobHasStarted,h=a.physicalLesson;return b+='\n<div class="ets-sp-lsn">\n\t<div class="ets-sp-lsn-main">\n\t\t<div class="ets-sp-lsn-hd clearfix">\n\t\t\t<img src="'+(c.lessonImage?c.lessonImage.url:"")+'" width="260" height="160">\n\t\t\t<div class="ets-sp-lsn-info">\n\t\t\t\t<h4><span data-weave="troopjs-ef/blurb/widget" data-blurb-id="490238" data-text-en="Lesson"></span> '+c.lessonNo+"</h4>\n\t\t\t\t<h1>"+c.lessonName+"</h1>\n\t\t\t\t",e?b+='\n\t\t\t\t<div class="ets-sp-lsn-status ets-pass">\n\t\t\t\t\t<h3>\n\t\t\t\t\t\t<i class="ets-icon-badge-checkmark"></i>\n\t\t\t\t\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="569854" data-text-en="PASSED"></span> / '+d+"%\n\t\t\t\t\t</h3>\n\t\t\t\t</div>\n\t\t\t\t":(b+="\n\t\t\t\t\t",g&&(b+='\n\t\t\t\t\t<div class="ets-sp-lsn-status ets-start">\n\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t<i class="ets-mob-icon ets-icon-mob-started"></i>\n\t\t\t\t\t\t\t<span class="ets-mob-status" data-weave="troopjs-ef/blurb/widget" data-blurb-id="661846" data-text-en="Started on mobile"></span>\n\t\t\t\t\t\t\t<i class="ets-icon-mob-tip ets-mob-tip-started"></i>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t</div>\n\t\t\t\t\t'),b+="\n\t\t\t\t\t",f&&(b+='\n\t\t\t\t\t<div class="ets-sp-lsn-status ets-pass">\n\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t<i class="ets-mob-icon ets-icon-mob-passed"></i>\n\t\t\t\t\t\t\t<span class="ets-mob-status" data-weave="troopjs-ef/blurb/widget" data-blurb-id="661847" data-text-en="Passed on mobile"></span>\n\t\t\t\t\t\t\t<i class="ets-icon-mob-tip ets-mob-tip-passed"></i>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t</div>\n\t\t\t\t\t'),b+="\n\t\t\t\t"),b+='\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="ets-sp-lsn-bd">\n\t\t\t<div data-weave="school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/step-list/main" data-physical-lesson-id="'+h+'"></div>\n\t\t</div>\n\t</div>\n</div>\n<div class="modal fade ets-mob-modal ets-mob-modal-started" role="dialog">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content ets-mob-modal-tip">\n\t\t\t<div class="ets-tip-icon">\n\t\t\t\t<i class="ets-icon-mob-started"></i>\n\t\t\t</div>\n\t\t\t<h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="661846" data-text-en="Started on mobile"></h2>\n\t\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="661848" data-text-en="You have started this lesson on your mobile."></p>\n\t\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="663229" data-text-en="You can choose to study the lesson on the web as well, or continue on your mobile device."></p>\n\t\t\t<div class="ets-tip-button">\n\t\t\t\t<button class="btn btn-default ets-btn-modal-close" data-weave="troopjs-ef/blurb/widget" data-blurb-id="661850" data-text-en="Got it"></button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="modal fade ets-mob-modal ets-mob-modal-passed" role="dialog">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content ets-mob-modal-tip">\n\t\t\t<div class="ets-tip-icon">\n\t\t\t\t<i class="ets-icon-mob-passed"></i>\n\t\t\t</div>\n\t\t\t<h2 data-weave="troopjs-ef/blurb/widget" data-blurb-id="661847" data-text-en="Passed on mobile"></h2>\n\t\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="663228" data-text-en="You have passed this lesson on your mobile."></p>\n\t\t\t<p data-weave="troopjs-ef/blurb/widget" data-blurb-id="661849" data-text-en="You might see more new content herebut don\'t worry, all good!"></p>\n\t\t\t<div class="ets-tip-button">\n\t\t\t\t<button class="btn btn-default ets-btn-modal-close" data-weave="troopjs-ef/blurb/widget" data-blurb-id="661850" data-text-en="Got it"></button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/main",["jquery","troopjs-ef/component/widget","school-ui-shared/utils/progress-state","school-ui-shared/utils/typeid-parser","jquery.gudstrap","poly","template!./lesson.html"],function(a,b,c,d,e,f,g){"use strict";function h(a){var b=this;if(a){var d={lesson:a,physicalLesson:b[i].properties.templateLessonId,pcScore:0,pcHasPassed:!1,mobHasStarted:!1,mobHasPassed:!1};return b.query("student_lesson_progress!template_lesson;"+b[i].properties.templateLessonId+".detail").spread(function(a){return a.detail.items.forEach(function(a,b){switch(a.sourceTypeCode){case"PCLesson":d.pcScore=a.score,d.pcHasPassed=c.hasPassed(a.state);break;case"MOBLesson":d.mobHasStarted=c.hasStarted(a.state),d.mobHasPassed=c.hasPassed(a.state)}}),b.html(g,d)})}}var i="_studyplan_item";return b.extend(function(a,b,c){this[i]=c},{"hub:memory/load/lesson":function(a){var b=this;a&&b.query("pc_student_lesson_map!"+b[i].properties.templateLessonId+".lesson").spread(function(c){c.lesson.templateLessonId===a.templateLessonId&&h.call(b,b._lesson=a)})},"hub/lesson/renderer":function(){var a=this;h.call(a,a._lesson)},"hub/activity/update/progress":function(){this.publish("lesson/renderer")},"dom:.ets-mob-tip-started/click":function(){this.$element.find(".ets-mob-modal-started").modal("show")},"dom:.ets-mob-tip-passed/click":function(){this.$element.find(".ets-mob-modal-passed").modal("show")},"dom:.ets-btn-modal-close/click":function(){this.$element.find(".ets-mob-modal").modal("hide")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/step-list/step-list.html",[],function(){return function(a){var b="",c=a.steps;b+='\n<div class="ets-sp-steps">\n\t';for(var d=0;d<c.length;d++){var e=c[d];!function(c){b+='\n\t\x3c!-- Step Start --\x3e\n\t<div data-weave="school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/step/main" data-id="'+c.id+'" data-physical-lesson-id="'+a.physicalLesson+'" data-show-button="'+!!c._showButton+'" data-has-continue="'+!!c._hasContinue+'"></div>\n\t\x3c!-- Step End --\x3e\n'}(e)}return b+="\n</div>\n\n"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/step-list/main",["jquery","troopjs-ef/component/widget","school-ui-shared/utils/progress-state","school-ui-shared/utils/typeid-parser","template!./step-list.html","poly"],function(a,b,c,d,e){"use strict";function f(a){var b=this;if(a){var d=a.id;return b.query(d+".children.progress").spread(function(a){var d=a.children;return d.every(function(a,b){return!!c.hasPassed(a.progress.state)||(a[g]=!0,!1)}),d.forEach(function(a,b){c.hasStarted(a.progress.state)&&(a[g]=!0,a[h]=!0)}),b.html(e,{steps:d,physicalLesson:b.physicalLessonId})})}}var g="_showButton",h="_hasContinue";return b.extend(function(){var a=this;a.physicalLessonId=a.$element.data("physical-lesson-id")},{"hub:memory/load/lesson":function(a){var b=this;a&&f.call(b,b.lesson=a)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/step/step.html",[],function(){return function(a){var b="",c=a.step;return b+='\n<ul class="ets-sp-step '+(a._hasPassed?"ets-pass":"")+" "+(a._showButton?"ets-showButton":"")+"\" data-hash='"+c._hash+'\'>\n\t<li class="ets-sp-step-no">'+c.stepNo+'</li>\n\t<li class="ets-sp-step-type">'+c.stepTypeName+'</li>\n\t<li class="ets-sp-step-title ets-overflow" title="'+c.stepName+'">'+c.stepName+'</li>\n\t<li class="ets-sp-step-action">\n\t\t',a._hasPassed?(b+="\n\t\t\t",a._isPerfect?b+='\n\t\t\t\t<span class="badge pull-right" data-weave="troopjs-ef/blurb/widget" data-blurb-id="462935" data-text-en="Perfect"><i class="glyphicon glyphicon-ok"></i></span>\n\t\t\t':b+='\n\t\t\t\t<i class="ets-icon-badge-checkmark"></i>\n\t\t\t',b+="\n\t\t"):(b+='\n\t\t\t<button class="btn btn-primary btn-block btn-sm ets-sp-step-start">\n\t\t\t\t',a._hasContinue?b+='\n\t\t\t\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="450010" data-text-en="Continue"></span>\n\t\t\t\t':b+='\n\t\t\t\t\t<span data-weave="troopjs-ef/blurb/widget" data-blurb-id="450009" data-text-en="Start"></span>\n\t\t\t\t',b+="\n\t\t\t</button>\n\t\t"),b+="\n\t</li>\n</ul>"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/lesson/step/main",["jquery","poly","json2","troopjs-ef/component/widget","school-ui-shared/utils/progress-state","school-ui-shared/utils/typeid-parser","template!./step.html"],function(a,b,c,d,e,f,g){"use strict";function h(a){var b=this;if(a){var d=a+".progress",h="student_lesson!template_lessson;"+b.physicalLessonId+".parent.parent.parent";return b.query(d,h).spread(function(a,d){return a._hash=c.stringify({prefix:"school",enrollment:f.parseId(d.parent.parent.parent.studentCourseId),course:f.parseId(d.parent.parent.parent.id),level:f.parseId(d.parent.parent.id),unit:f.parseId(d.parent.id),lesson:f.parseId(a.parent.id),step:f.parseId(a.id)}),b.html(g,{step:a,_showButton:!(1!=b.showButton),_hasContinue:!(1!=b.hasContinue),_isPerfect:!(100!=a.progress.score),_hasPassed:e.hasPassed(a.progress.state)})})}}return d.extend(function(){var a=this;a.stepId=a.$element.data("id"),a.showButton=a.$element.data("show-button"),a.hasContinue=a.$element.data("has-continue"),a.physicalLessonId=a.$element.data("physical-lesson-id")},{"sig/start":function(){var a=this;h.call(a,a.stepId)},"dom:.ets-sp-step/click":function(b){var c=this,d=a(b.currentTarget);return c.publish("load",a.parseJSON(d.attr("data-hash"))),!1}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/lock/lock.html",[],function(){return function(a){var b='<div class="ets-sp-unit-locked">\n    <h1><i class="ets-icon-lock"></i></h1>\n    <h1 data-weave="troopjs-ef/blurb/widget" data-text-en="UNIT ^currentunit^ IS LOCKED" data-blurb-id="569834" data-values=\''+JSON.stringify(a.blurbValues)+"'></h1>\n    ";return a.blurbValues.previousunit&&(b+='\n        <h5 data-weave="troopjs-ef/blurb/widget" data-text-en="Complete Unit ^previousunit^ to unlock this unit" data-blurb-id="569835" data-values=\''+JSON.stringify(a.blurbValues)+"'></h5>\n    "),b+="\n</div>"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/lock/main",["when","poly","troopjs-ef/component/widget","template!./lock.html"],function(a,b,c,d){"use strict";return c.extend({"hub:memory/load/unit":function(a){var b,c=this,e=a&&a.unitNo
;a&&(a.parent.children.every(function(c,d){return a.id!==c.id||(b=0==d?void 0:a.parent.children[d-1].unitNo,!1)}),c.html(d,{blurbValues:{currentunit:e,previousunit:b}}))}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/main",["jquery","when","troopjs-ef/component/widget","troopjs-browser/loom/config","troopjs-browser/loom/weave","client-tracking","school-ui-studyplan/enum/studyplan-mode","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/enum/page-name","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/animation-helper","poly/array"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(c,e,f,g){var h=this,i="true"===h[C]&&"goal"===c?"cp-"+c:c,l=a("<div></div>").addClass(u).data("itemData",e).attr(d.weave,z+i+"/main(itemData)");e&&l.attr("data-at-page-id","sp-sequence-item-"+j.parseId(e.id));var m=h[q],n=m.find("."+t),o=n.find("."+u);g&&o.length?(m.addClass(v),n.addClass(v),g===B.L?(n.prepend(l),n.addClass(w)):n.append(l)):(n=a("<div></div>").addClass(t).html(l),m.html(n)),setTimeout(function(){l.weave().then(function(){g&&o.length&&k.request(f,function(){return b.promise(function(a){n.addClass(g===B.L?x:y),setTimeout(function(){n.removeClass([v,w,x,y].join(" ")),o.remove(),m.removeClass(v),a()},A)})})})},0)}function n(a,b,c,d,e){var f,h=this;if(b&&a.mode!==p){switch(a.mode){case g.Create:f="config",h[r]=-1;break;case g.Locked:f="lock";break;case g.Study:f=c&&c.typeCode,h[r]=c&&c.itemIndex}if(f){h[s]=f,h.query('member_site_setting!"school;studyplan.newui.enabled"').spread(function(a){h[C]=a.value,m.call(h,f,c,d,e)});var i;b.items.every(function(a,b){return!c||a.id!==c.id||(i=!0,!1)}),i&&o.call(h,f,c)}}}function o(a,b){var c=this;switch(a){case"lesson":c.query("pc_student_lesson_map!"+b.properties.templateLessonId).spread(function(a){f.pagename(i["lesson"+a.lesson.lessonNo])});break;case"gl":f.pagename(i.gl);break;case"pl":f.pagename(i.pl);break;case"goal":f.pagename(i.goal)}}var p,q="$element",r="_studyplan_item_index",s="_type_code",t="ets-sp-sequence-container",u="ets-sp-sequence-item",v="ets-sp-item-animation",w="ets-sp-prepend-item",x="ets-sp-lt-index",y="ets-sp-gt-index",z="school-ui-studyplan/widget/studyplan/body/sequence-container/",A=600,B={L:"<--",R:"--\x3e"},C="campus_enable";return c.extend({"hub/studyplan/sequence-container/reload":function(){var a=this;a._studyplan_item_id&&b.all([a.query(a._studyplan_item_id),a.query('member_site_setting!"school;studyplan.newui.enabled"'),a[q].find("["+d.woven+"]").unweave()]).spread(function(b,c){a[C]=c[0].value,a[q].find("."+u).remove(),m.call(a,a[s],b[0])})},"hub:memory/load/results":function(a){var b,c,d,e=this;if(a.unit)if(a.studyplan&&e._studyplan_id!==a.studyplan.id||!a.studyplan&&e._unit_template_id!==a.unit.templateUnitId){e._unit_template_id!==a.unit.templateUnitId&&(a.unit.parent.children.forEach(function(b,f){switch(b.templateUnitId){case a.unit.templateUnitId:c=f;break;case e._unit_template_id:d=f}}),c!==p&&d!==p&&(b=B[c<d?"L":"R"]));var f=a.unit_studyplan,g=a.studyplan||a.unit_studyplan.studyPlan;e._unit_id=a.unit&&a.unit.studentUnitId,e._unit_template_id=a.unit&&a.unit.templateUnitId,e._studyplan_id=g.id,e._studyplan_item_id=a.studyplan_item&&a.studyplan_item.id,n.call(e,f,g,a.studyplan_item,"unitNav_seqCon",b)}else a.studyplan&&a.studyplan_item&&a.unit_studyplan&&e._studyplan_id===a.studyplan.id&&e._studyplan_item_id!==(a.studyplan_item&&a.studyplan_item.id)&&(e[r]!==a.studyplan_item.itemIndex&&(b=B[e[r]>a.studyplan_item.itemIndex?"L":"R"]),e._unit_id=a.unit&&a.unit.studentUnitId,e._unit_template_id=a.unit&&a.unit.templateUnitId,e._studyplan_id=a.studyplan&&a.studyplan.id,e._studyplan_item_id=a.studyplan_item&&a.studyplan_item.id,n.call(e,a.unit_studyplan,a.studyplan,a.studyplan_item,"itemChange_seqCon",b));else e._unit_id=e._unit_template_id=e._studyplan_id=e._studyplan_item_id=p},"hub/load/launcher":function(a){var c=this;if("school"!==a.prefix)return a.studyplan&&a.studyplan!==j.parseId(c._studyplan_id)||!a.studyplan&&a.unit&&a.unit!=="template_unit;"+c._unit_template_id||a.studyplan&&a.studyplan_item&&a.studyplan_item!==j.parseId(c._studyplan_item_id)?b.promise(function(a){c[q].find("["+d.woven+"]").unweave().then(function(){a()})}):void 0}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/pl/main",["jquery","troopjs-ef/component/widget"],function(a,b){"use strict";return b.extend(function(a,b,c){this._item_data=c},{"sig/start":function(){var b=this;return b.publish("school/interface/studyplan/pl-container-widget","school-ui-studyplan/widget/gl-pl/privatelesson/main").spread(function(c){a("<div></div>",{"data-weave":c+"(itemData)",data:{itemData:b._item_data}}).appendTo(b.$element).weave()})}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/sppl20/main",["jquery","troopjs-ef/component/widget"],function(a,b){"use strict";return b.extend(function(a,b,c){this._item_data=c},{"sig/start":function(){var b=this;return b.publish("school/interface/studyplan/pl20-container-widget","school-ui-studyplan/widget/gl-pl/privatelesson/main").spread(function(c){a("<div></div>",{"data-weave":c+"(itemData)",data:{itemData:b._item_data}}).appendTo(b.$element).weave()})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-container/unavailable/unavailable.html",[],function(){return function(a){return'<div class="ets-sp-chrysalis-unit">\n    <h3><i class="glyphicon glyphicon-info-sign"></i></h3>\n    <h5 data-weave="troopjs-ef/blurb/widget" data-text-en="This unit was completed with an earlier version of the school." data-blurb-id="632524"></h5>\n    <p data-weave="troopjs-ef/blurb/widget" data-text-en="All your progress have been stored, but unfortunately the activities done cannot be reviewed." data-blurb-id="632525"></p>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-container/unavailable/main",["troopjs-ef/component/widget","template!./unavailable.html"],function(a,b){"use strict";return a.extend({"sig/start":function(){return this.html(b)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/item.html",[],function(){return function(a){return'<div class="ets-sp-sqn-item-badge">\n\t<i class="ets-sp-sqn-item-icon">\n\t\t<i class="ets-sp-sqn-icon-bg '+a.itemBackgroundClass+'"></i>\n\t\t<i class="ets-sp-sqn-icon-badge '+a.itemClass+'"></i>\n\t</i>\n</div>\n<div class="ets-sp-sqn-item-title">'+a.topic+'</div>\n<i class="ets-icon-arrow-up"></i>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/base",["jquery","jquery.gudstrap","when","troopjs-ef/component/widget","troopjs-browser/loom/config","troopjs-browser/loom/weave","school-ui-studyplan/enum/studyplan-mode","school-ui-studyplan/enum/studyplan-item-state","school-ui-shared/utils/typeid-parser","school-ui-studyplan/utils/state-parser","school-ui-studyplan/utils/client-storage","school-ui-shared/utils/update-helper","school-ui-shared/utils/console","template!./item.html"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,b){return b===g.Study?a+".progress":a}function p(a){var b=this,d="campus_student_studyplan_item!"+a;return c(b[u]&&[b[u]]||b.query(o(d,b[t]))).spread(function(a){return c.all([b[A].topic,b[A].popoverTitle,b[A].popoverContent]).spread(function(c,d,e){return b[A].topic=c,b[A].popoverTitle=d,b[A].popoverContent=e,(b[A].popoverTitle||b[A].popoverContent)&&"fulfilled"!==b[B].promise.inspect().state&&(b[r].popover({trigger:"manual",title:b[A].popoverTitle,content:b[A].popoverContent,placement:"bottom"}),b[B].resolve()),[a]})}).spread(function(a){var d=a.progress.state,e=b[A],f=e.customMark.slice(),g=!!b[r].find("."+w).length,i=j.parseFlag(h,d);return i.Completed&&f.push(C+"check"),i.Locked&&f.push(C+"locked"),(g?c.resolve():b.html(e.template||n,e)).then(function(){b[r].toggleClass(y,i.Completed),b[r].toggleClass(z,i.Locked),q.call(b,f,a)})})}function q(b,d){var f=this,g=f[r].find("."+w),h=f[r].find("."+x);b.length?b.reduce(function(b,f){return b.then(function(b){if(b)return!0;c.resolve(f).then(function(b){var c=a("<div></div>").addClass(x).attr(e.weave,b+"(itemData)").attr("data-item-data",JSON.stringify(d)).appendTo(g);return c.weave().then(function(){return!0},function(){return c.unweave().catch(function(a){m.info(a)}).then(function(){c.remove()}),!1})})})},c.resolve(!1)).then(function(){h.remove()}):h.remove()}var r="$element",s="_id",t="_unit_studyplan_mode",u="_data",v="_item_ui_status",w="ets-sp-sqn-item-badge",x="ets-badge-custommark",y="ets-pass",z="ets-locked",A="_render_data",B="_dfd_popover",C="school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/";return d.extend(function(){var a=this;a[s]=a[r].data("itemId"),a[t]=a[r].data("unitStudyplanMode"),a[v]={selected:void 0,suggest:void 0},a[A]=a[A]||{template:"",customMark:[],topic:"",itemClass:"",itemBackgroundClass:""}},{"sig/start":function(){var a=this;return a[B]=c.defer(),a._store_shown_popover_id=!0,p.call(a,a[s])},"hub/studyplan/sequence-item/update":function(a){var b=this;a&&i.parseId(a)!==b[s]||p.call(b,b[s])},"hub:memory/load/studyplan":function(a){a&&(this.studyplanId=i.parseId(a.id))},"dom/click":function(){this.clickHandler()},clickHandler:function(){var a=this;a[v].selected||a[v].unavailable||(a.publish("load",{studyplan_item:a[s]}),a.publish("studyplan/sequence-item/selected",a[s]))},"hub/studyplan/sequence-item/trigger/click":function(a){i.parseId(a)===this[s]&&this.clickHandler()},"hub:memory/studyplan/sequence-item/unavailable":function(a,b){var c=this;c[v].unavailable=a&&b!==c[s],c.resetStatusClass(),c.unavailable&&c.unavailable(c[v].unavailable)},"hub:memory/studyplan/sequence-item/selected":function(a){var b=this;a=i.parseId(a),b[v].selected=a===b[s],b.resetStatusClass(),b.selected&&b.selected(b[v].selected,a)},"hub:memory/studyplan/sequence-item/suggest":function(a){var b=this;a=i.parseId(a),b[v].suggest=a===b[s],b.resetStatusClass(),b.suggest&&b.suggest(b[v].suggest,a)},resetStatusClass:function(){var a=this;a[r].toggleClass("ets-suggest",a[v].suggest),a[r].toggleClass("ets-active",a[v].selected),a[r].toggleClass("ets-unavailable",a[v].unavailable)},showPopover:function(){var a=this;a[B].promise.then(function(){"show"!==a[r].data("popoverStatus")&&a[r].popover("show")&&a[r].data("popoverStatus","show")})},hidePopover:function(){var a=this;a[B].promise.then(function(){"hide"!==a[r].data("popoverStatus")&&a[r].popover("hide")&&a[r].data("popoverStatus","hide")})},delayHidePopover:function(){var a=this;a._delay_hide_popover_timer&&clearTimeout(a._delay_hide_popover_timer),a._delay_hide_popover_timer=setTimeout(function(){clearTimeout(a._delay_hide_popover_timer),a.hidePopover()},5e3)},canShowPopover:function(){var a=this;return a[v].suggest&&!1===a[v].selected&&!1===a[v].unavailable&&!a.isShownIdStored()},tryShowPopover:function(){var a=this;a.canShowPopover()&&(a.showPopover(),a.delayHidePopover(),a._store_shown_popover_id&&a.storeShownId())},isStoreShownId:function(){return this._store_shown_popover_id},setStoreShownId:function(a){return this._store_shown_popover_id=a},isShownIdStored:function(){var a=this;return(k.getLocalStorage("shown_popover_ids")||",").indexOf(","+a[s]+",")>-1},storeShownId:function(){var a=this;if(!a.isShownIdStored()){var b=k.getLocalStorage("shown_popover_ids")||",";b+=a[s]+",",k.setLocalStorage("shown_popover_ids",b)}}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/config",["./base"],function(a){return a.extend(function(a,b,c){var d=this;d._data={id:"config",typeCode:"config",progress:{state:0}},d._id=d._data.id},{"sig/start":function(){var a=this;a._render_data&&(a._render_data.itemClass="ets-icon-setup",a._render_data.itemBackgroundClass="glyphicon icon-circle",a._render_data.topic=a.query("blurb!656053").spread(function(a){return a&&a.translation}))}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/cp-goal",["./base"],function(a){return a.extend(function(a,b,c){this.$element.addClass("ets-sp-sqn-item-goal")},{"sig/start":function(){var a=this;a._render_data&&(a._render_data.itemClass="ets-icon-badge-goal-poly",a._render_data.itemBackgroundClass="ets-icon-goal-bg",a._render_data.customMark.push("school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/cp-goal"),a._render_data.topic=a.query("blurb!568667").spread(function(a){return a&&a.translation}),a._render_data.popoverTitle=a.query("blurb!571166").spread(function(a){return a&&a.translation}),a._render_data.popoverContent=a.query("blurb!571167").spread(function(a){return a&&a.translation}))},"hub/studyplan/sequence/update":function(){this.tryShowPopover()},suggest:function(){this.tryShowPopover()},unavailable:function(){this.tryShowPopover()},selected:function(a,b){var c=this;b!==c._previous_selected_id&&(c.canShowPopover()?c.tryShowPopover():c.hidePopover(),c._previous_selected_id=b)},"hub/activity/opened":function(){this.setStoreShownId(!1)},"hub/activity/closed":function(){var a=this;a.setStoreShownId(!0),a.tryShowPopover()}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/cp20",["./base"],function(a){return a.extend({"sig/start":function(){var a=this;a._render_data&&(a._render_data.itemClass="ets-icon-badge-check-point",a._render_data.itemBackgroundClass="glyphicon icon-circle",a._render_data.customMark.push(a.publish("school/interface/studyplan/cp20-mark-widget","school-ui-studyplan/widget/gl-pl/mark/cp20").spread(function(a){return a})),a._render_data.topic=a.query("blurb!639494").spread(function(a){return a&&a.translation}),a._render_data.popoverTitle=a.query("blurb!639496").spread(function(a){return a&&a.translation}),a._render_data.popoverContent=a.query("blurb!639497").spread(function(a){return a&&a.translation}))},"hub/studyplan/sequence/update":function(){this.tryShowPopover()},suggest:function(){this.tryShowPopover()},unavailable:function(){this.tryShowPopover()},selected:function(a,b){var c=this;b!==c._previous_selected_id&&(c.canShowPopover()?c.tryShowPopover():c.hidePopover(),c._previous_selected_id=b)},"hub/activity/opened":function(){this.setStoreShownId(!1)},"hub/activity/closed":function(){var a=this;a.setStoreShownId(!0),a.tryShowPopover()}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/gl",["./base"],function(a){return a.extend({"sig/start":function(){var a=this;a._render_data&&(a._render_data.itemClass="ets-icon-badge-group-lesson",a._render_data.itemBackgroundClass="glyphicon icon-circle",a._render_data.topic=a.query("blurb!638118").spread(function(a){return a&&a.translation}))}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/goal",["./base"],function(a){return a.extend(function(a,b,c){this.$element.addClass("ets-sp-sqn-item-goal")},{"sig/start":function(){var a=this;a._render_data&&(a._render_data.itemClass="ets-icon-badge-goal-poly",a._render_data.itemBackgroundClass="ets-icon-goal-bg",a._render_data.customMark.push("school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/goal"),a._render_data.topic=a.query("blurb!568667").spread(function(a){return a&&a.translation}),a._render_data.popoverTitle=a.query("blurb!571166").spread(function(a){return a&&a.translation}),a._render_data.popoverContent=a.query("blurb!571167").spread(function(a){return a&&a.translation}))},"hub/studyplan/sequence/update":function(){this.tryShowPopover()},suggest:function(){this.tryShowPopover()},unavailable:function(){this.tryShowPopover()},selected:function(a,b){var c=this;b!==c._previous_selected_id&&(c.canShowPopover()?c.tryShowPopover():c.hidePopover(),c._previous_selected_id=b)},"hub/activity/opened":function(){this.setStoreShownId(!1)},"hub/activity/closed":function(){var a=this;a.setStoreShownId(!0),a.tryShowPopover()}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/lesson",["./base"],function(a){return a.extend({"sig/start":function(){var a=this;a._id&&a._render_data&&(a._render_data.itemClass="ets-icon-badge-lesson",a._render_data.itemBackgroundClass="glyphicon icon-circle",a._render_data.topic=a.query("campus_student_studyplan_item!"+a._id+".properties").spread(function(b){return a.query("student_lesson!template_lesson;"+b.properties.templateLessonId)}).spread(function(a){return a.lessonName}))}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/pl",["./base"],function(a){return a.extend({"sig/start":function(){var a=this;a._render_data&&(a._render_data.itemClass="ets-icon-badge-private-lesson",a._render_data.itemBackgroundClass="glyphicon icon-circle",a._render_data.customMark.push(a.publish("school/interface/studyplan/pl-mark-widget","school-ui-studyplan/widget/gl-pl/mark/pl").spread(function(a){return a})),a._render_data.topic=a.query("blurb!569833").spread(function(a){return a&&a.translation}))}})}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/sppl20",["./base"],function(a){return a.extend({"sig/start":function(){var a=this;a._render_data&&(a._render_data.itemClass="ets-icon-badge-private-lesson",a._render_data.itemBackgroundClass="glyphicon icon-circle",a._render_data.customMark.push(a.publish("school/interface/studyplan/pl20-mark-widget","school-ui-studyplan/widget/gl-pl/mark/pl").spread(function(a){return a})),a._render_data.topic=a.query("blurb!569833").spread(function(a){return a&&a.translation}))}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-navigation/sequence-nav.html",[],function(){return function(a){return'<div class="ets-sp-sqn ets-sp-sequence-item">\n\t\x3c!-- Sequence Navigation Start --\x3e\n\t<div class="ets-sp-sqn-main">\n\t\t<ul class="ets-sp-sqn-container">\n            <div class="ets-sp-sqn-line"></div>\n        </ul>\n\t</div>\n\t\x3c!-- Sequence Navigation End --\x3e\n</div>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/main",["when","jquery","troopjs-ef/component/widget","template!./sequence-nav.html","school-ui-shared/utils/typeid-parser","school-ui-studyplan/enum/studyplan-mode","school-ui-studyplan/enum/studyplan-state","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/enum/studyplan-velocity","school-ui-studyplan/utils/state-parser","troopjs-browser/loom/config","school-ui-studyplan/utils/animation-helper","jquery.gudstrap","lodash"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,b){return b===f.Study?a+".progress":a}function p(c,e,f){var g,h=this,i=h[E],j=i.find("."+t),k=j.find("."+y);return h.query(o(e.id,c.mode),'member_site_setting!"school;studyplan.newui.enabled"').spread(function(e,m){if(h[r]=c,h[s]=e,h[J]=m.value,f&&k.length){var n=f===I.L,o=b(d());return i.addClass(z),j.addClass(z),n?(j.prepend(o),j.addClass(A)):j.append(o),g=o.find("."+u),a.all(q.call(h,g)).then(function(){var b=a.defer();return l.request(G,function(){return a.promise(function(a){j.addClass(n?B:C),setTimeout(function(){j.removeClass([z,A,B,C].join(" ")),k.remove(),i.removeClass(z),a()},H)}).then(b.resolve,b.reject)}),b.promise})}return g=i.find("."+u),g.length||(j=b("<div></div>").addClass(t).html(d()).appendTo(i),g=j.find("."+u)),a.all(q.call(h,g))})}function q(a){var c,d,h,j=this,l=j[r].mode,m=[],o=j[s];a.find("."+w).addClass(x),l===f.Create?(j.publish("studyplan/sequence-item/selected",D),d=[{typeCode:"config"}].concat(o.items),h=D):d=o.items,d.forEach(function(d){var f=d.id&&a.find("[data-item-id='"+e.parseId(d.id)+"']");if(f&&f.data("woven"))f.appendTo(a),f.removeClass(x),j.publish("studyplan/sequence-item/update",e.parseId(d.id));else{var g="true"===j[J]&&"goal"===d.typeCode?"cp-"+d.typeCode:d.typeCode,l="";o.progress&&(l=n.findKey(i,function(a){return a===o.progress.properties.velocity}).toLowerCase()),f=b("<li class='ets-sp-sqn-item'></li>").attr("data-item-id",e.parseId(d.id)||"").attr("data-type-code",d.typeCode).attr("data-unit-studyplan-mode",j[r].mode).attr(k.weave,F+g+"(itemID)").attr("data-velocity",l).appendTo(a),m.push(f.weave())}"goal"===d.typeCode&&(c=o.progress&&o.progress.properties.velocity===i.Crashed)&&(h=e.parseId(d.id))}),a.toggleClass(v,!(!o.progress||o.progress.state!==g.Completed)),a.find("."+x).each(function(a,c){b(c).popover("destroy")}).remove(),j.publish("studyplan/sequence-item/unavailable",l===f.Create||l===f.Locked||c,h);var p=o.items.filter(function(a){return o.progress&&a.itemIndex===o.progress.properties.suggestedItemIndex}),q=p.length?p[0]:o.items[0];return j.publish("studyplan/sequence-item/suggest",e.parseId(q.id)),m}var r="_data_unit_studyplan",s="_data_studyplan",t="ets-sp-sequence-navigation-container",u="ets-sp-sqn-container",v="ets-complete",w="ets-sp-sqn-item",x="ets-sp-sqn-removeable",y="ets-sp-sequence-item",z="ets-sp-item-animation",A="ets-sp-prepend-item",B="ets-sp-lt-index",C="ets-sp-gt-index",D="config",E="$element",F="school-ui-studyplan/widget/studyplan/body/sequence-navigation/item/",G="unitNav_seqNav",H=600,I={L:"<--",R:"--\x3e"},J="campus_enable";return c.extend({"hub/load/launcher":function(b){var c=this;if("school"!==b.prefix)return b.studyplan&&b.studyplan!==e.parseId(c._studyplan_id)||!b.studyplan&&b.unit!=="template_unit;"+c._unit_template_id?a.promise(function(a){c[E].find("["+k.woven+"]").unweave().then(function(){a()})}):void 0},"hub:memory/load/results":function(a){var b,c,d,e=this;if(a.unit){if(a.studyplan&&e._studyplan_id!==a.studyplan.id||!a.studyplan&&e._unit_template_id!==a.unit.templateUnitId){e._unit_template_id!==a.unit.templateUnitId&&(a.unit.parent.children.forEach(function(b,f){switch(b.templateUnitId){case a.unit.templateUnitId:c=f;break;case e._unit_template_id:d=f}}),void 0!==c&&void 0!==d&&(b=I[c<d?"L":"R"]));var f=a.unit_studyplan,g=a.studyplan||a.unit_studyplan.studyPlan;e._unit_studyplan_id=f.id,e._studyplan_id=g.id,e._unit_template_id=a.unit&&a.unit.templateUnitId,e._unit_id=a.unit&&a.unit.studentUnitId,e._promise_render=p.call(e,f,g,b)}}else e._unit_studyplan_id=e._studyplan_id=e._unit_template_id=e._unit_id=void 0},"hub:memory/load/studyplan_item":function(a){var b=this,c=a?e.parseId(a.id):null;b.publish("studyplan/sequence-item/selected",c)},"hub/studyplan/sequence/navigate/suggest-item":function(){var a=this,b=a[s].items.filter(function(b){return a[s].progress&&b.itemIndex===a[s].progress.properties.suggestedItemIndex}),c=b.length?b[0]:void 0;c&&a.publish("load",{prefix:"study",studyplan:e.parseId(a[s].id),studyplan_item:e.parseId(c.id)})},"hub/studyplan/sequence/navigate/goal":function(){var a,b=this;b[s]&&b[s].items.length>0&&(b[s].items.forEach(function(b){"goal"==b.typeCode&&(a=b.itemIndex)}),b.publish("load",{prefix:"study",studyplan:e.parseId(b[s].id),studyplan_item:e.parseId(b[s].items[a].id)}))},"hub/studyplan/sequence/update":function(){var a=this;a._studyplan_id&&a._promise_render&&"fulfilled"===a._promise_render.inspect().state&&(a._promise_render=p.call(a,a[r],a[r].studyPlan))},"hub/activity/update/progress":function(){this.publish("studyplan/sequence/update")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/check.html",[],function(){return function(a){return'<i class="ets-icon-badge-checkmark"></i>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/check",["when","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","template!./check.html"],function(a,b,c,d){return b.extend(function(a,b,d){this._id=c.parseId(d.id),this._item=d},{"sig/start":function(){return"goal"===this._item.typeCode?a.reject("skip check mark, goal item has no check mark"):this.html(d)},"hub:memory/studyplan/sequence-item/selected":function(a){var b=this,c=b._id;b.$element.toggleClass("ets-none",a==c)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/cp-goal.html",[],function(){return function(a){var b="",c=a.isComplete?695098:694536;return b+='\n<span class="badge ets-sp-badge-normal campus-badge-normal '+(a.isComplete?"cp-badge-complete":"")+'" data-weave="troopjs-ef/blurb/widget" data-blurb-id="'+c+'" data-values=\'{"leftdays": "'+a.leftDays+"\"}'></span>\n",a.isRead||(b+='\n<div class="ets-cp-goal-tooltip" data-weave="school-ui-studyplan/shared/tooltip/main(option)" data-option=\'{"content": 694537, "customClass": "goal", "expand" : "true"}\'></div>\n'),b}}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/cp-goal",["jquery","when","moment","troopjs-ef/component/widget","school-ui-shared/enum/moment-language","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/utils/state-parser","school-ui-studyplan/utils/client-storage","template!./cp-goal.html"],function(a,b,c,d,e,f,g,h,i){return d.extend(function(a,c,d){this._data=d,this._context_defer=b.defer(),this._result_defer=b.defer()},{displayName:"school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/goal","sig/start":function(){var a=this,d=a._data;if(!(d&&d.progress&&d.progress.properties&&d.progress.properties.endDate))return b.reject("skip target date mark, no endDate in goal");b.all([a._context_defer.promise,a._result_defer.promise]).spread(function(b,g){a.result=g;var h=c(d.progress.properties.endDate);b&&(h.lang(e[b.cultureCode.toLowerCase()]),a.html(i,{leftDays:d.progress.properties.leftDays,isRead:a.isRead(),isComplete:d.progress.state===f.Completed}))})},"hub:memory/load/results":function(a){a.level&&this._result_defer.resolve(a)},"hub:memory/context":function(a){a&&this._context_defer.resolve(a)},"dom:.ets-cp-goal-tooltip/tooltip/close":function(){var a=this;h.setLocalStorage("shown_level_first",a.result.level.levelNo)},isRead:function(){var a=this;return 1!==a.result.unit.unitNo||h.getLocalStorage("shown_level_first")===a.result.level.levelNo}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/goal.html",[],function(){return function(a){return'<span class="badge ets-sp-badge-normal">'+a+"</span>"}}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/goal",["jquery","when","moment","troopjs-ef/component/widget","school-ui-shared/enum/moment-language","school-ui-studyplan/enum/studyplan-item-state","school-ui-studyplan/utils/state-parser","template!./goal.html"],function(a,b,c,d,e,f,g,h){return d.extend(function(a,c,d){this._data=d,this._context_defer=b.defer()},{displayName:"school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/goal","sig/start":function(){var a=this,d=a._data;return g.parseFlag(f,d.progress.state).Completed?b.reject("skip target date mark, studyplan is completed"):d&&d.progress&&d.progress.properties&&d.progress.properties.endDate?void a._context_defer.promise.spread(function(b){var f=c(d.progress.properties.endDate);b&&(f.lang(e[b.cultureCode.toLowerCase()]),a.html(h,f.format("ll")))}):b.reject("skip target date mark, no endDate in goal")},"hub:memory/context":function(a){a&&this._context_defer.resolve([a])}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/locked.html",[],function(){return function(a){return'<i class="ets-icon-badge-locked">\n\t<i class="ets-sp-locked-mark-bg glyphicon icon-circle"></i>\n\t<i class="ets-sp-locked-mark-icon ets-icon-lock"></i>\n</i>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/locked",["troopjs-ef/component/widget","template!./locked.html"],function(a,b){return a.extend({"sig/start":function(){return this.html(b)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/skipped.html",[],function(){return function(a){return'<span class="badge ets-sp-badge-skipped" data-weave="troopjs-ef/blurb/widget" data-text-en="Skipped" data-blurb-id="568736"></span>'}}),define("school-ui-studyplan/widget/studyplan/body/sequence-navigation/mark/skipped",["troopjs-ef/component/widget","template!./skipped.html"],function(a,b){return a.extend({"sig/start":function(){return this.html(b)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/header/change-course/course.html",[],function(){return function(a){var b="";return a.enableShowCourseName&&(b+='\n<div class="ets-sp-chc-hd">\n    ',a.changeCourseLink&&a.enableChangeCourse?b+='\n    <div class="ets-sp-chc-widget ets-sp-chc-link">\n        <h3>'+a.courseName+"</h3>\n        <h4>"+a.levelName+'</h4>\n        <a class="ets-sp-chc-link-url" data-weave="troopjs-ef/blurb/widget" data-blurb-id="668938" data-text-en="Change course" href="'+a.changeCourseLink+'"></a>\n    </div>\n    ':(b+='\n    <div class="ets-sp-chc-widget ets-sp-chc-switch '+(a.enableChangeCourse?"ets-sp-chc-hand":"")+'" ',a.enableChangeCourse&&(b+="data-action='switch' "),b+=" >\n        ",a.enableChangeCourse&&(b+='\n            <div class="ets-sp-chc-switch-arrow">\n                <i class="glyphicon icon-caret-down"></i>\n            </div>\n        '),b+='\n        <div class="ets-sp-chc-switch-main">\n            <h3>'+a.courseName+"</h3>\n            <h4>"+a.levelName+"</h4>\n        </div>\n    </div>\n    "),b+="\n</div>\n"),b}}),define("school-ui-studyplan/widget/studyplan/header/change-course/main",["jquery","when","school-ui-shared/utils/ccl","troopjs-browser/loom/config","troopjs-ef/component/widget","template!./course.html"],function(a,b,c,d,e,f){"use strict";function g(a,b,d){var e=this;if(a&&b&&d)return e.query(h,i,j,k).spread(function(d,g,h,i){return e.html(f,{courseName:a.courseName,levelName:b.levelName,enableChangeCourse:c.indicateCCLStringValue(i)||c.indicateCCLStringValue(d),enableShowCourseName:c.indicateCCLStringValue(g),changeCourseLink:h.value}).then(function(){var a=e[l].find(m),b=a[0].scrollWidth;a.width(b),e[l].closest(n).find(o).css("padding-left",b)})})}var h='ccl!"school.menu.changecourse.display"',i='ccl!"school.courseware.showCourseName.enable"',j='ccl!"school.studyplan.changeCourse.link"',k='member_site_setting!"CampusCore;Campus.ChangeCourse.Enable"',l="$element",m=".ets-sp-chc-widget",n=".ets-sp-unit-hd",o=".ets-sp-unn";return e.extend({"hub:memory/load/results":function(a){var b=this;b.course===a.course&&b.level===a.level&&b.unit===a.unit||g.call(b,b.course=a.course,b.level=a.level,b.unit=a.unit)},"dom:[data-action='switch']/click":function(){this.publish("toggle/course/list")}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/header/course-list/course-list.html",[],function(){return function(a){function b(){return"<div class='ets-sp-chc-courses-row'>"}function c(a,b){return e(a,a.unit_children||a.children,b)}function d(){return"</div>"}function e(a,b,c){return"<div class='ets-sp-chc-course ets-"+c+"-col clearfix' data-course-type='"+a.courseTypeCode+"'><h3>"+a.courseName+"</h3>"+f(b)+"</div>"}function f(b){for(var c,d,e=b.length,f=0,g="",h="",i=" data-template-id='{templateId}'";f<e;)f%8==0&&(g+="<ul>"),d=b[f],c=a.hasPassed(d.progress.state),h=c?"class='ets-pass' ":"",g+="<li data-action='select-level' "+h+i.replace("{templateId}",d.templateUnitId||d.templateLevelId)+">",g+=d.unitName||d.levelName,g+=c?'<i class="ets-icon-badge-checkmark"></i></li>':"</li>",++f%8==0&&(g+="</ul>");return g}function g(a){for(var e,f,g,h=a.length,i=0,j="",k=0;i<h;)(g=a[i])&&(this[g.courseTypeCode]=this[g.courseTypeCode]||g,e=g.unit_children||g.children,f=Math.ceil(e.length/8),Math.ceil(f/4),k<f?(j+=0!==i?d():"",j+=b(),j+=c(g,f),k=(4-f%4)%4):(j+=c(g,f),k-=f),++i===h&&(j+=d()));return j}var h=""
;return h+='\n\n<div class="ets-sp-chc-bd ets-none">\n    <div class="ets-sp-chc-courses clearfix">\n        <button class="btn btn-default btn-sm ets-sp-chc-close" data-action="close">\n        <i class="glyphicon glyphicon-remove"></i> <span data-weave="troopjs-ef/blurb/widget" data-blurb-id="450020" data-text-en="close"></span></button>\n        <div data-action=\'change-level\'>'+g.call(this,a.groups)+'</div>\n    </div>\n</div>\n\n\n\x3c!--\n <div class="ets-sp-chc-courses-row">\n    <div class="ets-sp-chc-course ets-2-col clearfix">\n        <h3>Level Name</h3>\n        <ul>\n            <li class="ets-pass"> Level Item<i class="ets-icon-badge-checkmark"></i></li>\n            <li class="ets-active">Actived Item</li>\n            <li>Normal Item</li>\n        </ul>\n        ...\n    </div>\n</div>\n--\x3e'}}),define("school-ui-studyplan/widget/studyplan/header/course-list/main",["jquery","when","client-tracking","troopjs-ef/component/widget","school-ui-shared/utils/console","school-ui-shared/utils/update-helper","school-ui-shared/utils/progress-state","school-ui-shared/utils/typeid-parser","school-ui-shared/enum/course-type","school-ui-studyplan/enum/studyplan-state","school-ui-studyplan/enum/studyplan-mode","template!./course-list.html","poly"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(){var a=this,b=[],c=[];return N.forEach(function(a,d){b.push(a._name),c.push("blurb!"+a._id)}),a.query(c).then(function(a){a.forEach(function(a,c){O[b[c]]=a?a.translation:N[c].en})})}function o(a,b){return"GE"===a.courseTypeCode?-1:"GE"===b.courseTypeCode?1:a.children.length>b.children.length?1:-1}function p(){var a=this;return b.all([a.query(D),n.call(a)]).spread(function(b){if(a.courseInfo=b[0],a.courseInfo)return w.call(a,a.courseInfo).then(function(){return a.html(l,{groups:a.courseInfo.items?a.courseInfo.items.sort(o):[],hasPassed:g.hasPassed}).then(function(){a.$allCourses=a.$element.find(y),a.$courseBody=a.$element.find(x),a.$arraw=a.$element.find(z),v.call(a,a[I]),q.call(a,a[G]&&a[G].templateLevelId,a[H]&&a[H].templateUnitId)})})})}function q(){var a=this,b=Array.prototype.slice.call(arguments);b.length&&(a.$allCourses&&a.$allCourses.removeClass(A),b.forEach(function(b){a.$element.find("[data-template-id='"+b+"']").addClass(A)}))}function r(a){a.type=a.type||F;var c=this;return this.publish("enable/show/"+a.type+"-box",!0).spread(function(d){return d?c.publish("show/"+a.type+"-modal-box",a):b.reject("disable show modal box")})}function s(a,c){var d=this,e=b.resolve(),g=i.isGECourse(c),h=i.isBECourse(c);return"demo"===d.common_context.partnercode.value.toLowerCase()&&(e=b.all(b.map(d.courseInfo.items,function(b){return g&&"GE"===b.courseTypeCode?d.query(b.children[6].children[2].id).spread(function(b){a.templateId=b.templateUnitId}):h&&"BE"===b.courseTypeCode?d.query(b.children[4].children[1].id).spread(function(b){a.templateId=b.templateUnitId}):void 0}))),e.then(function(){return f.updateEnrollment(a)}).then(function(a){return d.publish("enrollment/update").then(function(){return d.publish("context/update/context")})})}function t(){var a=this;if(a[G]){var b,c,d=a[G].templateLevelId;if(a.courseInfo&&!a.isSPIN)return b=a.courseInfo.items,b.every(function(a){return a.children.every(function(b,e){return!a.children[e+1]||b.templateLevelId!==d||(c={templateId:a.children[e+1].templateLevelId},!1)})}),c}}function u(a,b,c){var d=this,e=i.isGECourse(a),f=d.isGE&&e,g=f?O[J]:O[L],h=f?O[K]:O[M];return r.call(d,{type:E,title:g,body:h})}function v(a){var b=this;a?(b.$courseBody&&b.$courseBody.removeClass(B),b.$arraw&&b.$arraw.addClass(C)):(b.$courseBody&&b.$courseBody.addClass(B),b.$arraw&&b.$arraw.removeClass(C))}function w(a){var c,d=this;if(a.items)for(var e=0;e<a.items.length;e++)if("INDB2B"===a.items[e].courseTypeCode)return c=!0,d.query(a.items[e].id+".children.children.progress").spread(function(a){var b=[];a.children.forEach(function(a,c){a.children.forEach(function(a,c){b.push(a)})}),a.unit_children=b});if(!c)return b.resolve()}var x=".ets-sp-chc-bd",y=".ets-sp-chc-course li",z=".ets-sp-chc-switch-arrow i",A="ets-active",B="ets-none",C="icon-caret-up",D="student_enrollable_courses!*.items.children.progress",E="confirm",F="alert",G="_level",H="_unit",I="_show",J="_GE2GE_Title",K="_GE2GE_Body",L="_Title",M="_Body",N=[{_name:"ok",_id:"150652",en:"OK"},{_name:J,_id:"450016",en:"Are you sure you want to change the level?"},{_name:K,_id:"450311",en:"Your progress in this level will be saved, but we recommend that you complete the levels in order."},{_name:"_GE2GE_Below_Title",_id:"458008",en:"This course is for Level 6 or higher."},{_name:"_GE2GE_Below_Body",_id:"458009",en:"You need to be studying at General English Level 6 or above to take advantage of this course."},{_name:L,_id:"461321",en:"Do you want to change courses?"},{_name:M,_id:"461322",en:"Don't worry. Your progress in this course will be saved."},{_name:"_sp_Title",_id:"569826",en:"Are you sure you want to change the level?"},{_name:"_sp_Body",_id:"569827",en:"If you change your level your current study plan will be discarded."},{_name:"_topic_unable_to_change",_id:"634432",en:"Unable to change level"},{_name:"_text_unable_to_change",_id:"634433",en:"You can not change to this level as you have completed it in an older version of the online school. Please select another one."},{_name:"_topic_want_change",_id:"634434",en:"Are you sure you want to change level?"},{_name:"_text_want_change",_id:"634435",en:"Your progress in this level will be saved, but we recommend that you complete the levels in order."},{_name:"_option_want_change",_id:"634436",en:"I want to make a fresh start! Please enrol me at the beginnng of the course and remove my old study progress."},{_name:"_topic_unable_to_change_course",_id:"634437",en:"Unable to change course"},{_name:"_text_unable_to_change_course",_id:"634438",en:"You can not change to this course as you have completed it in an older version of the online school."},{_name:"_topic_sure_want_to_change",_id:"634439",en:"Are you sure you want to change course?"},{_name:"_text_sure_want_to_change",_id:"634440",en:"Your progress in this course will be saved."}],O={};return d.extend({"hub:memory/common_context":function(a){var b=this;a&&(b.common_context=a.values,p.call(b))},"hub:memory/load/results":function(a){var b=this;a.course&&(b.isGE=i.isGECourse(b._course_type_code=(a.course||{}).courseTypeCode),b.isSPIN=i.isSpinCourse(b._course_type_code),q.call(b,(b[G]=a.level).templateLevelId,(b[H]=a.unit).templateUnitId))},"hub/enroll/next/level":function(){var a=this;return s.call(a,t.call(a),a._course_type_code)},"hub/ef/update/progress":function(a){var b=this;p.call(b)},"hub/show/course/list":function(){this.publish("load",{command:["changecourse"]})},"hub/toggle/course/list":function(){var a=this;a.$courseBody.hasClass(B)?a.publish("load",{command:["changecourse"]}):a.publish("load",{command:void 0})},"dom:[data-action='close']/click":function(){this.publish("load",{command:void 0})},"hub:memory/load/command":function(a){var b=this;a&&a.indexOf("changecourse")>=0?(v.call(this,b[I]=!0),c.useraction({"action.changeCourseInitiated":1})):v.call(this,b[I]=!1)},"dom:[data-action='select-level']/click":function(c){var d=this,f=a(c.target),g=f.data("templateId"),h=(f.hasClass("ets-pass"),f.parents(".ets-sp-chc-course").data("courseType")),l={templateId:g};if(!f.hasClass(A))return d.query("campus_student_unit_studyplan!current.studyPlan.items,.studyPlan.progress",'ccl!"school.changecourse.minimum.levelno"').spread(function(a,c){var e=i.isGECourse(h),f=(i.isBECourse(h),d[G].levelNo<c.value);return d.isGE&&!e&&f?(r.call(d,{type:F,title:O._GE2GE_Below_Title,body:O._GE2GE_Below_Body}),b.reject("change level when below minimum level control, forbidden")):a.mode===k.Study&&a.studyPlan.progress.state===j.Started?r.call(d,{type:E,title:O._sp_Title,body:O._sp_Body}):u.call(d,h,c)}).then(function(){return s.call(d,l,h).then(function(){})}).catch(function(a){e.info(a)})}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/header/unit-navigation/main.html",[],function(){return function(a){function b(){return'<div class="ets-sp-unn-title"> '+(a.isGE?'<strong data-weave="troopjs-ef/blurb/widget" data-blurb-id="105267" data-text-en="Unit"></strong><strong>'+a.unit.unitNo+"</strong> ":"")+'<span title="'+a.unit.unitName+'">'+a.unit.unitName+"</span> </div>"}var c="";return c+='\n\n<div class="ets-sp-unn-main">\n\t',a.enableNavUnit&&a.enableShowCourseName?c+='\n\t    <div class="ets-sp-unn-prev ets-disabled" data-action="navigate/prev/unit"><i class="glyphicon icon-angle-left"></i></div>\n\t    '+b()+'\n\t    <div class="ets-sp-unn-next ets-disabled" data-action="navigate/next/unit"><i class="glyphicon icon-angle-right"></i></div>\n    ':c+="\n\t\t"+b()+"\n    ",c+="\n</div>"}}),define("school-ui-studyplan/widget/studyplan/header/unit-navigation/main",["jquery","when","client-tracking","school-ui-shared/utils/ccl","troopjs-ef/component/widget","school-ui-shared/utils/typeid-parser","school-ui-shared/enum/course-type","template!./main.html"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,b){return"demo"===a.partnercode.value.toLowerCase()&&(g.isGECourse(b)||g.isBECourse(b)||"INDB2B"===b)}function j(a,b){var c=this;c.$prev.toggleClass(o,a===b[0].templateUnitId),c.$next.toggleClass(o,a===b[b.length-1].templateUnitId)}function k(a,b){var c=this,d=c.unit.templateUnitId,e=c.units,f=0,g=e.length,h=0;for(j.call(c,d,e);f<g;f++)if(d===e[f].templateUnitId){if(0===f&&a||f===g-1&&b)return;h=f+(a?-1:b?1:0);break}e[h].templateUnitId&&c.publish("load/config",e[h].templateUnitId)}function l(a,b,c,e,f){var g=this;if(b&&a&&c&&e&&f)return g.query([p,q]).spread(function(b,k){return g.html(h,{isGE:g.isGE,unit:c,enableNavUnit:d.indicateCCLStringValue(b),enableShowCourseName:d.indicateCCLStringValue(k)}).then(function(){var b=g.$element;g.$prev=b.find(m),g.$next=b.find(n),i(f,a.courseTypeCode)||j.call(g,c.templateUnitId,e)})})}var m=".ets-sp-unn-prev",n=".ets-sp-unn-next",o="ets-disabled",p='ccl!"school.courseware.enable.navigateUnit"',q='ccl!"school.courseware.showCourseName.enable"';return e.extend(function(){},{"hub:memory/common_context":function(a){var b=this;a&&l.call(b,b.course,b.level,b.unit,b.units,b.common_context=a.values)},"hub:memory/load/results":function(a){var b=this;b.course===a.course&&b.level===a.level&&b.unit===a.unit||(b.isGE=g.isGECourse(b.courseTypeCode=(a.course||{}).courseTypeCode),b.course=a.course,b.level=a.level,b.unit=a.unit,b.units=a.level&&a.level.children,l.call(b,b.course,b.level,b.unit,b.units,b.common_context))},"hub/ef/update/progress":function(a){var b=this;a&&b.unit&&b.query(b.level.id+".children").spread(function(a){a&&(b.units=a.children),l.call(b,b.course,b.level,b.unit,b.units)})},"dom:[data-action='navigate/prev/unit']/click":function(b){a(b.currentTarget).hasClass(o)||(k.call(this,!0,!1),c.useraction({"action.unitNavigation":"Previous"}))},"dom:[data-action='navigate/next/unit']/click":function(b){a(b.currentTarget).hasClass(o)||(k.call(this,!1,!0),c.useraction({"action.unitNavigation":"Next"}))}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/header/unit-overview/main.html",[],function(){return function(a){return'<div class="ets-sp-uno-main">\n    <button class="btn btn-default btn-sm ets-sp-uno-btn" data-weave="troopjs-ef/blurb/widget" data-blurb-id="450055" data-text-en="Unit Overview"></button>\n</div>'}}),define("school-ui-studyplan/widget/studyplan/header/unit-overview/main",["when","jquery","client-tracking","troopjs-ef/component/widget","template!./main.html"],function(a,b,c,d,e){"use strict";function f(){var a=this;b("."+h).remove();var c=b("<div></div>",{class:h,"data-weave":"school-ui-shared/widget/unit-overview/modal-container/main(templateUnitid)"});return a._dfdUnit.promise.then(function(a){return c.data("templateUnitid",a.templateUnitId).insertAfter(b(g)).weave()})}var g=".ets-sp-study",h="ets-uo-widget";return d.extend({"sig/start":function(){var b=this;b._dfdUnit=a.defer(),b.html(e)},"hub:memory/load/unit":function(b){var c=this;"pending"!==c._dfdUnit.promise.inspect().state&&(c._dfdUnit=a.defer()),c._dfdUnit.resolve(b)},"dom:button/click":function(){c.useraction({"action.unitOverviewClick":"1"});var a=this;f.call(a)}})}),define("troopjs-requirejs/template!school-ui-studyplan/widget/studyplan/main.html",[],function(){return function(a){return'<div class="ets-theme-daylight ets-studyplan" data-at-page-id="sp-course-page">\n    <div class="ets-sp-main">\n        \x3c!-- Unit Start --\x3e\n        <div class="ets-sp-unit">\n            \x3c!-- Unit Header Start --\x3e\n            <div class="ets-sp-unit-hd">\n                \x3c!-- Change Course Start --\x3e\n                <div class="ets-sp-chc" data-weave="school-ui-studyplan/widget/studyplan/header/change-course/main"></div>\n                <div data-weave="school-ui-studyplan/widget/studyplan/header/course-list/main"></div>\n                \x3c!-- Change Course End --\x3e\n\n                \x3c!-- Unit Navigation Start --\x3e\n                <div class="ets-sp-unn" data-weave="school-ui-studyplan/widget/studyplan/header/unit-navigation/main"></div>\n                \x3c!-- Unit Navigation End --\x3e\n\n                \x3c!-- Unit Overview Start --\x3e\n                <div class="ets-sp-uno"  data-weave="troopjs-ef/ccl/placeholder(\'school-ui-studyplan/widget/studyplan/header/unit-overview/main\')" data-ccl="school.e12.showUnitOverview"></div>\n                \x3c!-- Unit Overview End --\x3e\n            </div>\n            \x3c!-- Unit Header End --\x3e\n\n            \x3c!-- Unit Body Start --\x3e\n            <div class="ets-sp-unit-bd">\n                \x3c!-- Sequence Navigation Start --\x3e\n                <div class="ets-sp-sequence-wrapper" data-weave="school-ui-studyplan/widget/studyplan/body/sequence-navigation/main" data-at-page-id="sp-sequence-navigation-container"></div>\n                <div class="ets-sp-sequence-wrapper" data-weave="school-ui-studyplan/widget/studyplan/body/sequence-container/main"></div>\n            </div>\n            \x3c!-- Unit Body End --\x3e\n        </div>\n        \x3c!-- Unit End --\x3e\n\n    </div>\n</div>\n<div data-weave="school-ui-shared/plugins/confirm-box/main"></div>\n<div data-weave="school-ui-shared/plugins/alert-box/main"></div>'}}),define("school-ui-studyplan/widget/studyplan/main",["troopjs-ef/component/widget","template!./main.html"],function(a,b){"use strict";return a.extend({"sig/start":function(){return this.html(b)}})});
//# sourceMappingURL=app-built.min.js.map